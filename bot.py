# -*- coding: utf-8 -*- #

import discord
from discord.ext import commands,tasks
import json
from collections import OrderedDict
import random
import requests
import urllib.request
from apiclient.discovery import build
from apiclient.errors import HttpError
from oauth2client.tools import argparser
import wikipedia
import wikidata.client
from PIL import Image, ImageDraw, ImageFont
import time
import asyncio
import dropbox
import datetime
import pickle
import sys
import platform
import re
from twitter import *
from dateutil.relativedelta import relativedelta as rdelta
import traceback
import threading
import os
import shutil
import pytz
import sqlite3

from operator import itemgetter

#tokens
import config
#cog
import music

"""import logging

logging.basicConfig(level=logging.DEBUG)"""


#ãƒˆãƒ¼ã‚¯ãƒ³ãŸã¡
DROP_TOKEN = config.DROP_TOKEN
BOT_TEST_TOKEN = config.BOT_TEST_TOKEN
BOT_TOKEN = config.BOT_TOKEN
NAPI_TOKEN = config.NAPI_TOKEN
GAPI_TOKEN = config.GAPI_TOKEN
T_API_key = config.T_API_key
T_API_SKey = config.T_API_SKey
T_Acs_Token = config.T_Acs_Token
T_Acs_SToken = config.T_Acs_SToken

sqlite3.register_converter('pickle', pickle.loads)
sqlite3.register_converter('json', json.loads)
sqlite3.register_adapter(dict, json.dumps)
sqlite3.register_adapter(list, pickle.dumps)
db = sqlite3.connect("sina_datas.db",detect_types=sqlite3.PARSE_DECLTYPES, isolation_level=None)
db.row_factory = sqlite3.Row
cursor = db.cursor()
cursor.execute("CREATE TABLE IF NOT EXISTS users(id integer PRIMARY KEY NOT NULL,prefix pickle,gpoint integer,memo json,levcard text,onnotif pickle,lang text,accounts pickle,sinapartner integer,gban integer,gnick text,gcolor integer,gmod integer,gstar integer,galpha integer,gbanhist text)")
cursor.execute("CREATE TABLE IF NOT EXISTS guilds(id integer PRIMARY KEY NOT NULL,levels json,commands json,hash pickle,levelupsendto integer,reward json,jltasks json,lockcom pickle,sendlog integer,prefix pickle,lang text)")
cursor.execute("CREATE TABLE IF NOT EXISTS globalchs(name text PRIMARY KEY NOT NULL,ids pickle)")
cursor.execute("CREATE TABLE IF NOT EXISTS globaldates(id integer PRIMARY KEY NOT NULL,content text,allid pickle,aid integer,gid integer,timestamp text)")

DoServercmd = False
gprofilever = "v1.0.1"
bot = commands.Bot(command_prefix="s-",status=discord.Status.invisible)
bot.owner_id = 404243934210949120
wikipedia.set_lang('ja')
mwc = wikidata.client.Client()
rpcct = 0
rpcs =[
    "ãƒ˜ãƒ«ãƒ—:s-help",
    "ã‚¢ã‚¤ã‚³ãƒ³:ãŠã‚ãšã•ã‚“",
    "ã‚µãƒ¼ãƒãƒ¼æ•°:{0}",
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°:{1}",
    "ä½œæˆ:mii-10#3110",
    "help:s-help",
    "icon:oaz_n",
    "{0}guilds",
    "{1}users",
    "created by mii-10#3110"
]
"""db = dropbox.Dropbox(DROP_TOKEN)
db.users_get_current_account()"""
twi = Twitter(auth=OAuth(T_Acs_Token,T_Acs_SToken,T_API_key,T_API_SKey))
ec = 0x42bcf4
Donotif = False
StartTime = datetime.datetime.now() - rdelta(hours=9)
cmdqest = [
    "å¥½ããªé£Ÿã¹ç‰©ã¯ä½•ã§ã™ã‹ï¼Ÿ",
    "å¥½ããªæ›²ã¯ä½•ã§ã™ã‹ï¼Ÿ",
    "æ˜æ—¥ä¸–ç•ŒãŒçµ‚ã‚ã‚‹ã¨ã—ãŸã‚‰ä½•ã‚’ã—ã¾ã™ã‹ï¼Ÿ",
    "å¥½ããªäººãŒã„ãŸã¨ã—ãŸã‚‰ã©ã‚“ãªä¸€è¨€ã‚’ã‹ã‘ãŸã„ã§ã™ã‹ï¼Ÿ",
    "ãŠå‹§ã‚ã®æœ¬ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ",
    "è¡Œã£ã¦ã¿ãŸã„å ´æ‰€ã¯ã©ã“ã§ã™ã‹ï¼Ÿ",
    "ç‰¹æŠ€ã¯ä½•ã§ã™ã‹ï¼Ÿ",
    "äººã‹ã‚‰ä¾é ¼ã•ã‚ŒãŸã¨ãã€äº‹æƒ…ã‚’è€ƒãˆã¦æ–­ã‚Œã‚‹ï¼Ÿæ–­ã‚Œãªã„ï¼Ÿ",
    "å¥½ããªäººã¯?(å…¬é–‹å‡¦åˆ‘ã€ã‚‚ã¡ã‚ã‚“ã€ç­”ãˆãªãã¦ã‚‚ã„ã„ã‘ã©",
    "ä¸€ç•ªæ¬²ã—ã„ã‚‚ã®ã¯ï¼Ÿ",
]

aglch=None

# gid , oid , invite , PR-text
partnerg=[
    (574170788165582849,404243934210949120,"https://discord.gg/xFHW9tE","""ã“ã®botä½œæˆè€…ã€ã¿ãƒã¦ã‚“â˜†ã®å…¬é–‹ã‚µãƒ¼ãƒãƒ¼ã§ã™ï¼
ç‰¹å¾´:
ãƒ»Boost Level 1
  128Kbpsã®ãƒœã‚¤ã‚¹ãƒãƒ£ãƒƒãƒˆã€720P,60fpsã®GoLiveã‚¹ãƒˆãƒªãƒ¼ãƒ ãªã©ã‚’è¡Œãˆã¾ã™ã€‚
ãƒ»ãƒ¡ãƒ³ãƒãƒ¼ã¨æ–°è¦å‚åŠ è€…ã®å¾¹åº•çš„ãªåˆ†é›¢
  ãƒ¡ãƒ³ãƒãƒ¼å½¹è·ãŒä»˜ä¸ã•ã‚Œã‚‹ã¾ã§ã®é–“ã€æ–°è¦å‚åŠ è€…ã¯ç®¡ç†è€…ç­‰ã®ã¿ãŒè¦‹ã‚Œã‚‹å ´ã§ã®ã¿ç™ºè¨€ã§ãã¾ã™ã€‚è’ã‚‰ã—ãŒæ¥ã¦ã‚‚ãã“ã§å ±å‘ŠãŒã‚ã‚Œã°è¢«å®³ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ãƒ»æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã«ã‚ˆã‚‹è‡ªå‹•èªè¨¼
  æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ã«ã„ã‚‹ãƒ¡ãƒ³ãƒãƒ¼ã§ã€ã„ãã¤ã‹ã®æ¡ä»¶ã‚’æº€ãŸã›ã°è‡ªå‹•èªè¨¼ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã„ã¤ã‚µãƒ¼ãƒãƒ¼ã«æ¥ã¦ã‚‚ãƒ¡ãƒ³ãƒãƒ¼å½¹è·ãŒã‚‚ã‚‰ãˆã¾ã™ã€‚
ãƒ»ç›¸äº’ãƒªãƒ³ã‚¯ã‚µãƒ¼ãƒãƒ¼
  ã‚ãªãŸã®ã‚µãƒ¼ãƒãƒ¼ã‚’PR!ã„ãã¤ã‹ã®æ¡ä»¶ã‚’æº€ãŸã™ã“ã¨ã§ç›¸äº’ãƒªãƒ³ã‚¯ã‚µãƒ¼ãƒãƒ¼ã«ãªã‚Œã¾ã™ã€‚æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚‚å…¼ã­ã¦ã„ã¦ã€æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã«ã‚‚PRæ–‡ãŒæµã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼
    """),
    (560434525277126656,404243934210949120,"éå…¬é–‹",""),
    (606583146112352258,452586320053927942,"https://discord.gg/NTU3mar","""ã‚†ã£ãŸã‚Šã€€ã¾ã£ãŸã‚Šã—ãŸã‚µãƒ¼ãƒãƒ¼ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™!!
ã¿ãªã•ã‚“ã®ãŠã“ã—ã‚’ã€€ãŠã¾ã¡ã—ã¦ãŠã‚Šã¾ã™!!
ã‚«ãƒ©ã‚ªã‚±ã®ã‚¢ãƒ—ãƒªã‚’ä½¿ã£ãŸãƒãƒ£ãƒ³ãƒãƒ«ã‚‚ã‚ã‚Šã¾ã™ã‚ˆ!!
ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™!!"""),
    (461153681971216384,415526420115095554,"https://discord.gg/hA8bamt","""> **rspnet.jp official**

**rspnet.jp(RisuPu)å…¬å¼Discordã‚µãƒ¼ãƒ**
ã“ã®ã‚µãƒ¼ãƒã§ã¯ä¸»ã« ãƒã‚¤ãƒ³ã‚¯ãƒ©ãƒ•ãƒˆã‚µãƒ¼ãƒã¸å‚åŠ ã™ã‚‹ã“ã¨ãŒã§ããŸã‚Šã€è‡ªç”±ã«é›‘è«‡ãƒ»ãƒãƒ£ãƒƒãƒˆã‚„éŸ³æ¥½ã‚’è‡ªç®¡ç†botã‚’å«ã‚ã¦è¤‡æ•°äººã§åˆ¥ã€…ã®éŸ³æ¥½ãŒèãã“ã¨ãŒã§ãã¾ã™ï¼

è©³ã—ã„å†…å®¹ã¯é‹å–¶ã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€åˆã¯ä»¥ä¸‹URLã‚’å‚ç…§ã—ã¦ã¿ã¦ã­ï¼
https://www.rspnet.jp/page_id=618
    """),
    (648103908170006529,539787492711464960,"https://discord.gg/7P2yVv9","""ã“ã¡ã‚‰ã¯YouTubeãƒãƒ£ãƒ³ãƒãƒ«
ãã‚ƒã‚‰ã¡ã‚ƒã‚“ã®éƒ¨å±‹ã®å…¬å¼ã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚
ãƒªã‚¹ãƒŠãƒ¼ãŸã¡ãŒæ°—è»½ã«è©±ã›ã‚‹ã‚ˆã†ãªå ´æ‰€ã‚’æä¾›ã—ã¦ãŠã‚Šã¾ã™ã€‚
æ˜¯éã“ã®ã‚µãƒ¼ãƒãƒ¼ã«å…¥ã£ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ
ãŸãã•ã‚“ã®äººãŸã¡ã‚„Botã«ã‚ˆã‚Šå®‰å…¨ãªã‚µãƒ¼ãƒãƒ¼ã¨ãªã£ã¦ã„ã¾ã™ã€‚
ã¾ãŸã„ã¡æ—©ãå‹•ç”»ã®é€šçŸ¥ã‚’ã‚²ãƒƒãƒ‰ã§ãã‚‹ãƒãƒ£ãƒ³ã‚¹ã§ã™ã€‚
æ˜¯éå…¥ã£ã¦ãã ã•ã„ã­
ã¾ãŸã€æ˜¯éãƒãƒ£ãƒ³ãƒãƒ«ç™»éŒ²ãŠé¡˜ã„ã—ã¾ã™ï¼
YouTubeãƒãƒ£ãƒ³ãƒãƒ«URL:
https://www.youtube.com/channel/UCPZDqfGwTfWiWhssUArk4ow
    """),
    (641577651022069771,561723377094754304,"https://discord.gg/4JZQAA8","æ§˜ã€…ãªBotã‚‚ã„ãŸã‚Šã€ãƒãƒ©ã‚¨ãƒ†ã‚£ã«å¯Œã‚“ã ã‚³ãƒ¼ãƒŠãƒ¼ã‚‚ã‚ã‚Šã¾ã™ï¼")
]

#åˆå›ãƒ­ãƒ¼ãƒ‰
"""db.files_download_to_file( "guildsetting.json" , "/guildsetting.json" )
db.files_download_to_file( "profiles.json" , "/profiles.json" )
db.files_download_to_file( "gp.json" , "/gp.json" )
db.files_download_to_file( "globaldatas.json" , "/globaldatas.json" )
db.files_download_to_file( "gchatchs.json" , "/gchatchs.json" )"""

tl="ã€€ã‚” ã€ã€‚ï¼Œï¼ãƒ»ï¼šï¼›ï¼Ÿï¼ã‚›ã‚œÂ´ï½€Â¨ï¼¾ï¿£ï¼¿ãƒ½ãƒ¾ã‚ã‚ã€ƒä»ã€…ã€†ã€‡ãƒ¼â€•â€ï¼ï¼¼ï½âˆ¥ï½œâ€¦â€¥â€˜â€™â€œâ€ï¼ˆï¼‰ã€”ã€•ï¼»ï¼½ï½›ï½ã€ˆã€‰ã€Šã€‹ã€Œã€ã€ã€ã€ã€‘ï¼‹ï¼Â±Ã—Ã·ï¼â‰ ï¼œï¼â‰¦â‰§âˆâˆ´â™‚â™€Â°â€²â€³â„ƒï¿¥ï¼„ï¿ ï¿¡ï¼…ï¼ƒï¼†ï¼Šï¼ Â§â˜†â˜…â—‹â—â—â—‡â—†â–¡â– â–³â–²â–½â–¼â€»ã€’â†’â†â†‘â†“ã€“âˆˆâˆ‹âŠ†âŠ‡âŠ‚âŠƒâˆªâˆ©âˆ§âˆ¨ï¿¢â‡’â‡”âˆ€âˆƒâˆ âŠ¥âŒ’âˆ‚âˆ‡â‰¡â‰’â‰ªâ‰«âˆšâˆ½âˆâˆµâˆ«âˆ¬â„«â€°â™¯â™­â™ªâ€ â€¡Â¶â—¯ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™1234567890ï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½ï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½šabcdefghijklmnopqrstuvwxyz-^\=~|@[]:;\/.,<>?_+*}{`!\"#$%&'()ãã‚ãƒã„ã…ã†ã‡ãˆã‰ãŠã‹ãŒããããã‘ã’ã“ã”ã•ã–ã—ã˜ã™ãšã›ãœãããŸã ã¡ã¢ã£ã¤ã¥ã¦ã§ã¨ã©ãªã«ã¬ã­ã®ã¯ã°ã±ã²ã³ã´ãµã¶ã·ã¸ã¹ãºã»ã¼ã½ã¾ã¿ã‚€ã‚ã‚‚ã‚ƒã‚„ã‚…ã‚†ã‚‡ã‚ˆã‚‰ã‚Šã‚‹ã‚Œã‚ã‚ã‚ã‚ã‚‘ã‚’ã‚“ã‚¡ã‚¢ã‚£ã‚¤ã‚¥ã‚¦ã‚§ã‚¨ã‚©ã‚ªã‚«ã‚¬ã‚­ã‚®ã‚¯ã‚°ã‚±ã‚²ã‚³ã‚´ã‚µã‚¶ã‚·ã‚¸ã‚¹ã‚ºã‚»ã‚¼ã‚½ã‚¾ã‚¿ãƒ€ãƒãƒ‚ãƒƒãƒ„ãƒ…ãƒ†ãƒ‡ãƒˆãƒ‰ãƒŠãƒ‹ãƒŒãƒãƒãƒãƒãƒ‘ãƒ’ãƒ“ãƒ”ãƒ•ãƒ–ãƒ—ãƒ˜ãƒ™ãƒšãƒ›ãƒœãƒãƒãƒŸãƒ ãƒ¡ãƒ¢ãƒ£ãƒ¤ãƒ¥ãƒ¦ãƒ§ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ®ãƒ¯ãƒ°ãƒ±ãƒ²ãƒ³ãƒ´ãƒµãƒ¶Î‘Î’Î“Î”Î•Î–Î—Î˜Î™ÎšÎ›ÎœÎÎÎŸÎ Î¡Î£Î¤Î¥Î¦Î§Î¨Î©Î±Î²Î³Î´ÎµÎ¶Î·Î¸Î¹ÎºÎ»Î¼Î½Î¾Î¿Ï€ÏÏƒÏ„Ï…Ï†Ï‡ÏˆÏ‰ĞĞ‘Ğ’Ğ“Ğ”Ğ•ĞĞ–Ğ—Ğ˜Ğ™ĞšĞ›ĞœĞĞĞŸĞ Ğ¡Ğ¢Ğ£Ğ¤Ğ¥Ğ¦Ğ§Ğ¨Ğ©ĞªĞ«Ğ¬Ğ­Ğ®Ğ¯Ğ°Ğ±Ğ²Ğ³Ğ´ĞµÑ‘Ğ¶Ğ·Ğ¸Ğ¹ĞºĞ»Ğ¼Ğ½Ğ¾Ğ¿Ñ€ÑÑ‚ÑƒÑ„Ñ…Ñ†Ñ‡ÑˆÑ‰ÑŠÑ‹ÑŒÑÑÑâ”€â”‚â”Œâ”â”˜â””â”œâ”¬â”¤â”´â”¼â”â”ƒâ”â”“â”›â”—â”£â”³â”«â”»â•‹â” â”¯â”¨â”·â”¿â”â”°â”¥â”¸â•‚äºœå”–å¨ƒé˜¿å“€æ„›æŒ¨å§¶é€¢è‘µèŒœç©æ‚ªæ¡æ¸¥æ—­è‘¦èŠ¦é¯µæ¢“åœ§æ–¡æ‰±å®›å§è™»é£´çµ¢ç¶¾é®æˆ–ç²Ÿè¢·å®‰åºµæŒ‰æš—æ¡ˆé—‡éæä»¥ä¼Šä½ä¾å‰å›²å¤·å§”å¨å°‰æƒŸæ„æ…°æ˜“æ¤…ç‚ºç•ç•°ç§»ç¶­ç·¯èƒƒèè¡£è¬‚é•éºåŒ»äº•äº¥åŸŸè‚²éƒç£¯ä¸€å£±æº¢é€¸ç¨²èŒ¨èŠ‹é°¯å…å°å’½å“¡å› å§»å¼•é£²æ·«èƒ¤è”­é™¢é™°éš éŸ»å‹å³å®‡çƒç¾½è¿‚é›¨å¯éµœçªºä¸‘ç¢“è‡¼æ¸¦å˜˜å”„æ¬è”šé°»å§¥å©æµ¦ç“œé–å™‚äº‘é‹é›²èé¤Œå¡å–¶å¬°å½±æ˜ æ›³æ „æ°¸æ³³æ´©ç‘›ç›ˆç©é ´è‹±è¡›è© é‹­æ¶²ç–«ç›Šé§…æ‚¦è¬è¶Šé–²æ¦å­å††åœ’å °å¥„å®´å»¶æ€¨æ©æ´æ²¿æ¼”ç‚ç„”ç…™ç‡•çŒ¿ç¸è‰¶è‹‘è–—é é‰›é´›å¡©æ–¼æ±šç”¥å‡¹å¤®å¥¥å¾€å¿œæŠ¼æ—ºæ¨ªæ¬§æ®´ç‹ç¿è¥–é´¬é´é»„å²¡æ²–è»å„„å±‹æ†¶è‡†æ¡¶ç‰¡ä¹™ä¿ºå¸æ©æ¸©ç©éŸ³ä¸‹åŒ–ä»®ä½•ä¼½ä¾¡ä½³åŠ å¯å˜‰å¤å«å®¶å¯¡ç§‘æš‡æœæ¶æ­Œæ²³ç«ç‚ç¦ç¦¾ç¨¼ç®‡èŠ±è‹›èŒ„è·è¯è“è¦èª²å˜©è²¨è¿¦ééœèšŠä¿„å³¨æˆ‘ç‰™ç”»è‡¥èŠ½è›¾è³€é›…é¤“é§•ä»‹ä¼šè§£å›å¡Šå£Šå»»å¿«æ€ªæ‚”æ¢æ‡æˆ’æ‹æ”¹é­æ™¦æ¢°æµ·ç°ç•Œçš†çµµèŠ¥èŸ¹é–‹éšè²å‡±åŠ¾å¤–å’³å®³å´–æ…¨æ¦‚æ¶¯ç¢è“‹è¡—è©²é§éª¸æµ¬é¦¨è›™å£æŸ¿è›éˆåŠƒåš‡å„å»“æ‹¡æ’¹æ ¼æ ¸æ®»ç²ç¢ºç©«è¦šè§’èµ«è¼ƒéƒ­é–£éš”é©å­¦å²³æ¥½é¡é¡æ›ç¬ æ¨«æ©¿æ¢¶é°æ½Ÿå‰²å–æ°æ‹¬æ´»æ¸‡æ»‘è‘›è¤è½„ä¸”é°¹å¶æ¤›æ¨ºé„æ ªå…œç«ƒè’²é‡œéŒå™›é´¨æ ¢èŒ…è±ç²¥åˆˆè‹…ç“¦ä¹¾ä¾ƒå† å¯’åˆŠå‹˜å‹§å·»å–šå ªå§¦å®Œå®˜å¯›å¹²å¹¹æ‚£æ„Ÿæ…£æ†¾æ›æ•¢æŸ‘æ¡“æ£ºæ¬¾æ­“æ±—æ¼¢æ¾—æ½…ç’°ç”˜ç›£çœ‹ç«¿ç®¡ç°¡ç·©ç¼¶ç¿°è‚è‰¦èè¦³è«Œè²«é‚„é‘‘é–“é–‘é–¢é™¥éŸ“é¤¨èˆ˜ä¸¸å«å²¸å·Œç©ç™Œçœ¼å²©ç¿«è´‹é›é ‘é¡”é¡˜ä¼ä¼å±å–œå™¨åŸºå¥‡å¬‰å¯„å²å¸Œå¹¾å¿Œæ®æœºæ——æ—¢æœŸæ£‹æ£„æ©Ÿå¸°æ¯…æ°—æ±½ç•¿ç¥ˆå­£ç¨€ç´€å¾½è¦è¨˜è²´èµ·è»Œè¼é£¢é¨é¬¼äº€å½å„€å¦“å®œæˆ¯æŠ€æ“¬æ¬ºçŠ ç–‘ç¥‡ç¾©èŸ»èª¼è­°æ¬èŠé å‰åƒå–«æ¡”æ©˜è©°ç §æµé»å´å®¢è„šè™é€†ä¸˜ä¹…ä»‡ä¼‘åŠå¸å®®å¼“æ€¥æ•‘æœ½æ±‚æ±²æ³£ç¸çƒç©¶çª®ç¬ˆç´šç³¾çµ¦æ—§ç‰›å»å±…å·¨æ‹’æ‹ æŒ™æ¸ è™šè¨±è·é‹¸æ¼ç¦¦é­šäº¨äº«äº¬ä¾›ä¾ åƒ‘å…‡ç«¶å…±å‡¶å”åŒ¡å¿å«å–¬å¢ƒå³¡å¼·å½Šæ€¯ææ­æŒŸæ•™æ©‹æ³ç‹‚ç‹­çŸ¯èƒ¸è„…èˆˆè•éƒ·é¡éŸ¿é¥—é©šä»°å‡å°­æšæ¥­å±€æ›²æ¥µç‰æ¡ç²åƒ…å‹¤å‡å·¾éŒ¦æ–¤æ¬£æ¬½ç´ç¦ç¦½ç­‹ç·ŠèŠ¹èŒè¡¿è¥Ÿè¬¹è¿‘é‡‘åŸéŠ€ä¹å€¶å¥åŒºç‹—ç–çŸ©è‹¦èº¯é§†é§ˆé§’å…·æ„šè™å–°ç©ºå¶å¯“é‡éš…ä¸²æ«›é‡§å±‘å±ˆæ˜çªŸæ²“é´è½¡çªªç†Šéšˆç²‚æ —ç¹°æ¡‘é¬å‹²å›è–«è¨“ç¾¤è»éƒ¡å¦è¢ˆç¥ä¿‚å‚¾åˆ‘å…„å•“åœ­çªå‹å¥‘å½¢å¾„æµæ…¶æ…§æ†©æ²æºæ•¬æ™¯æ¡‚æ¸“ç•¦ç¨½ç³»çµŒç¶™ç¹‹ç½«èŒèŠè›è¨ˆè©£è­¦è»½é šé¶èŠ¸è¿é¯¨åŠ‡æˆŸæ’ƒæ¿€éš™æ¡å‚‘æ¬ æ±ºæ½”ç©´çµè¡€è¨£æœˆä»¶å€¹å€¦å¥å…¼åˆ¸å‰£å–§åœå …å«Œå»ºæ†²æ‡¸æ‹³æ²æ¤œæ¨©ç‰½çŠ¬çŒ®ç ”ç¡¯çµ¹çœŒè‚©è¦‹è¬™è³¢è»’é£éµé™ºé¡•é¨“é¹¸å…ƒåŸå³å¹»å¼¦æ¸›æºç„ç¾çµƒèˆ·è¨€è«ºé™ä¹å€‹å¤å‘¼å›ºå§‘å­¤å·±åº«å¼§æˆ¸æ•…æ¯æ¹–ç‹ç³Šè¢´è‚¡èƒ¡è°è™èª‡è·¨éˆ·é›‡é¡§é¼“äº”äº’ä¼åˆå‘‰å¾å¨¯å¾Œå¾¡æ‚Ÿæ¢§æªç‘šç¢èªèª¤è­·é†ä¹é¯‰äº¤ä½¼ä¾¯å€™å€–å…‰å…¬åŠŸåŠ¹å‹¾åšå£å‘åå–‰å‘å¢å¥½å­”å­å®å·¥å·§å··å¹¸åºƒåºšåº·å¼˜æ’æ…ŒæŠ—æ‹˜æ§æ”»æ˜‚æ™ƒæ›´æ­æ ¡æ¢—æ§‹æ±Ÿæ´ªæµ©æ¸¯æºç”²çš‡ç¡¬ç¨¿ç³ ç´…ç´˜çµç¶±è€•è€ƒè‚¯è‚±è…”è†èˆªè’è¡Œè¡¡è¬›è²¢è³¼éƒŠé…µé‰±ç ¿é‹¼é–¤é™é …é¦™é«˜é´»å‰›åŠ«å·åˆå£•æ‹·æ¿ è±ªè½Ÿéº¹å…‹åˆ»å‘Šå›½ç©€é…·éµ é»’ç„æ¼‰è…°ç”‘å¿½æƒšéª¨ç‹›è¾¼æ­¤é ƒä»Šå›°å¤å¢¾å©šæ¨æ‡‡æ˜æ˜†æ ¹æ¢±æ··ç—•ç´ºè‰®é­‚äº›ä½å‰å”†åµ¯å·¦å·®æŸ»æ²™ç‘³ç ‚è©é–è£Ÿååº§æŒ«å‚µå‚¬å†æœ€å“‰å¡å¦»å®°å½©æ‰æ¡æ ½æ­³æ¸ˆç½é‡‡çŠ€ç •ç ¦ç¥­æ–ç´°èœè£è¼‰éš›å‰¤åœ¨æç½ªè²¡å†´å‚é˜ªå ºæ¦Šè‚´å’²å´åŸ¼ç¢•é·ºä½œå‰Šå’‹æ¾æ˜¨æœ”æŸµçª„ç­–ç´¢éŒ¯æ¡œé®­ç¬¹åŒ™å†Šåˆ·å¯Ÿæ‹¶æ’®æ“¦æœ­æ®ºè–©é›‘çšé¯–æŒéŒ†é®«çš¿æ™’ä¸‰å‚˜å‚å±±æƒ¨æ’’æ•£æ¡Ÿç‡¦çŠç”£ç®—çº‚èš•è®ƒè³›é…¸é¤æ–¬æš«æ®‹ä»•ä»”ä¼ºä½¿åˆºå¸å²å—£å››å£«å§‹å§‰å§¿å­å±å¸‚å¸«å¿—æ€æŒ‡æ”¯å­œæ–¯æ–½æ—¨ææ­¢æ­»æ°ç…ç¥‰ç§ç³¸ç´™ç´«è‚¢è„‚è‡³è¦–è©è©©è©¦èªŒè«®è³‡è³œé›Œé£¼æ­¯äº‹ä¼¼ä¾å…å­—å¯ºæ…ˆæŒæ™‚æ¬¡æ»‹æ²»çˆ¾ç’½ç—”ç£ç¤ºè€Œè€³è‡ªè’”è¾æ±é¹¿å¼è­˜é´«ç«ºè»¸å®é›«ä¸ƒå±åŸ·å¤±å«‰å®¤æ‚‰æ¹¿æ¼†ç–¾è³ªå®Ÿè”€ç¯ å²æŸ´èŠå±¡è•Šç¸èˆå†™å°„æ¨èµ¦æ–œç…®ç¤¾ç´—è€…è¬è»Šé®è›‡é‚ªå€Ÿå‹ºå°ºæ“ç¼çˆµé…Œé‡ˆéŒ«è‹¥å¯‚å¼±æƒ¹ä¸»å–å®ˆæ‰‹æœ±æ®Šç‹©ç ç¨®è…«è¶£é…’é¦–å„’å—å‘ªå¯¿æˆæ¨¹ç¶¬éœ€å›šåå‘¨å®—å°±å·ä¿®æ„æ‹¾æ´²ç§€ç§‹çµ‚ç¹ç¿’è‡­èˆŸè’è¡†è¥²è®è¹´è¼¯é€±é…‹é…¬é›†é†œä»€ä½å……åå¾“æˆæŸ”æ±æ¸‹ç£ç¸¦é‡éŠƒå”å¤™å®¿æ·‘ç¥ç¸®ç²›å¡¾ç†Ÿå‡ºè¡“è¿°ä¿Šå³»æ˜¥ç¬ç«£èˆœé§¿å‡†å¾ªæ—¬æ¥¯æ®‰æ·³æº–æ½¤ç›¾ç´”å·¡éµé†‡é †å‡¦åˆæ‰€æš‘æ›™æ¸šåº¶ç·’ç½²æ›¸è–¯è—·è«¸åŠ©å™å¥³åºå¾æ•é‹¤é™¤å‚·å„Ÿå‹åŒ å‡å¬å“¨å•†å”±å˜—å¥¨å¦¾å¨¼å®µå°†å°å°‘å°šåº„åºŠå» å½°æ‰¿æŠ„æ‹›æŒæ·æ˜‡æ˜Œæ˜­æ™¶æ¾æ¢¢æ¨Ÿæ¨µæ²¼æ¶ˆæ¸‰æ¹˜ç„¼ç„¦ç…§ç—‡çœç¡ç¤ç¥¥ç§°ç« ç¬‘ç²§ç´¹è‚–è–è’‹è•‰è¡è£³è¨Ÿè¨¼è©”è©³è±¡è³é†¤é‰¦é¾é˜éšœé˜ä¸Šä¸ˆä¸ä¹—å†—å‰°åŸå ´å£Œå¬¢å¸¸æƒ…æ“¾æ¡æ–æµ„çŠ¶ç•³ç©£è’¸è­²é†¸éŒ å˜±åŸ´é£¾æ‹­æ¤æ®–ç‡­ç¹”è·è‰²è§¦é£Ÿè•è¾±å°»ä¼¸ä¿¡ä¾µå”‡å¨ å¯å¯©å¿ƒæ…æŒ¯æ–°æ™‹æ£®æ¦›æµ¸æ·±ç”³ç–¹çœŸç¥ç§¦ç´³è‡£èŠ¯è–ªè¦ªè¨ºèº«è¾›é€²é‡éœ‡äººä»åˆƒå¡µå£¬å°‹ç”šå°½è…è¨Šè¿…é™£é­ç¬¥è«é ˆé…¢å›³å¨é€—å¹å‚å¸¥æ¨æ°´ç‚Šç¡ç²‹ç¿ è¡°é‚é…”éŒéŒ˜éšç‘é«„å´‡åµ©æ•°æ¢è¶¨é››æ®æ‰æ¤™è…é —é›€è£¾æ¾„æ‘ºå¯¸ä¸–ç€¬ç•æ˜¯å‡„åˆ¶å‹¢å§“å¾æ€§æˆæ”¿æ•´æ˜Ÿæ™´æ£²æ –æ­£æ¸…ç‰²ç”Ÿç››ç²¾è–å£°è£½è¥¿èª èª“è«‹é€é†’é’é™æ–‰ç¨è„†éš»å¸­æƒœæˆšæ–¥æ˜”æçŸ³ç©ç±ç¸¾è„Šè²¬èµ¤è·¡è¹Ÿç¢©åˆ‡æ‹™æ¥æ‘‚æŠ˜è¨­çªƒç¯€èª¬é›ªçµ¶èˆŒè‰ä»™å…ˆåƒå å®£å°‚å°–å·æˆ¦æ‰‡æ’°æ “æ ´æ³‰æµ…æ´—æŸ“æ½œç…ç…½æ—‹ç©¿ç®­ç·šç¹Šç¾¨è…ºèˆ›èˆ¹è–¦è©®è³è·µé¸é·éŠ­éŠ‘é–ƒé®®å‰å–„æ¼¸ç„¶å…¨ç¦…ç¹•è†³ç³å™Œå¡‘å²¨æªæ›¾æ›½æ¥šç‹™ç–ç–ç¤ç¥–ç§Ÿç²—ç´ çµ„è˜‡è¨´é˜»é¡é¼ åƒ§å‰µåŒå¢å€‰å–ªå£®å¥çˆ½å®‹å±¤åŒæƒ£æƒ³æœæƒæŒ¿æ»æ“æ—©æ›¹å·£æ§æ§½æ¼•ç‡¥äº‰ç—©ç›¸çª“ç³Ÿç·ç¶œè¡è‰è˜è‘¬è’¼è—»è£…èµ°é€é­é—éœœé¨’åƒå¢—æ†è‡“è”µè´ˆé€ ä¿ƒå´å‰‡å³æ¯æ‰æŸæ¸¬è¶³é€Ÿä¿—å±è³Šæ—ç¶šå’è¢–å…¶æƒå­˜å­«å°Šææ‘éœä»–å¤šå¤ªæ±°è©‘å”¾å •å¦¥æƒ°æ‰“æŸèˆµæ¥•é™€é§„é¨¨ä½“å †å¯¾è€å²±å¸¯å¾…æ€ æ…‹æˆ´æ›¿æ³°æ»èƒè…¿è‹”è¢‹è²¸é€€é€®éšŠé»›é¯›ä»£å°å¤§ç¬¬é†é¡Œé·¹æ»ç€§å“å•„å®…æ‰˜æŠæ‹“æ²¢æ¿¯ç¢è¨—é¸æ¿è«¾èŒ¸å‡§è›¸åªå©ä½†é”è¾°å¥ªè„±å·½ç«ªè¾¿æ£šè°·ç‹¸é±ˆæ¨½èª°ä¸¹å˜å˜†å¦æ‹…æ¢æ—¦æ­æ·¡æ¹›ç‚­çŸ­ç«¯ç®ªç¶»è€½èƒ†è›‹èª•é›å›£å£‡å¼¾æ–­æš–æª€æ®µç”·è«‡å€¤çŸ¥åœ°å¼›æ¥æ™ºæ± ç—´ç¨šç½®è‡´èœ˜é…é¦³ç¯‰ç•œç«¹ç­‘è“„é€ç§©çª’èŒ¶å«¡ç€ä¸­ä»²å®™å¿ æŠ½æ˜¼æŸ±æ³¨è™«è¡·è¨»é…é‹³é§æ¨—ç€¦çŒªè‹§è‘—è²¯ä¸å…†å‡‹å–‹å¯µå¸–å¸³åºå¼”å¼µå½«å¾´æ‡²æŒ‘æš¢æœæ½®ç‰’ç”ºçœºè´è„¹è…¸è¶èª¿è«œè¶…è·³éŠšé•·é ‚é³¥å‹…æ—ç›´æœ•æ²ˆçè³ƒé®é™³æ´¥å¢œæ¤æ§Œè¿½éšç—›é€šå¡šæ ‚æ´æ§»ä½ƒæ¼¬æŸ˜è¾»è”¦ç¶´é”æ¤¿æ½°åªå£·å¬¬ç´¬çˆªåŠé‡£é¶´äº­ä½åœåµå‰ƒè²å‘ˆå ¤å®šå¸åº•åº­å»·å¼Ÿæ‚ŒæŠµæŒºææ¢¯æ±€ç¢‡ç¦ç¨‹ç· è‰‡è¨‚è«¦è¹„é€“é‚¸é„­é‡˜é¼æ³¥æ‘˜æ“¢æ•µæ»´çš„ç¬›é©é‘æººå“²å¾¹æ’¤è½è¿­é‰„å…¸å¡«å¤©å±•åº—æ·»çºç”œè²¼è»¢é¡›ç‚¹ä¼æ®¿æ¾±ç”°é›»å…åå µå¡—å¦¬å± å¾’æ–—æœæ¸¡ç™»èŸè³­é€”éƒ½éç ¥ç ºåŠªåº¦åœŸå¥´æ€’å€’å…šå†¬å‡åˆ€å”å¡”å¡˜å¥—å®•å³¶å¶‹æ‚¼æŠ•æ­æ±æ¡ƒæ¢¼æ£Ÿç›—æ·˜æ¹¯æ¶›ç¯ç‡ˆå½“ç—˜ç¥·ç­‰ç­”ç­’ç³–çµ±åˆ°è‘£è•©è—¤è¨è¬„è±†è¸é€ƒé€é™é™¶é ­é¨°é—˜åƒå‹•åŒå ‚å°æ†§æ’æ´ç³ç«¥èƒ´è„é“éŠ…å³ é´‡åŒ¿å¾—å¾³æ¶œç‰¹ç£ç¦¿ç¯¤æ¯’ç‹¬èª­æ ƒæ©¡å‡¸çªæ¤´å±Šé³¶è‹«å¯…é…‰ç€å™¸å±¯æƒ‡æ•¦æ²Œè±šéé “å‘‘æ›‡éˆå¥ˆé‚£å†…ä¹å‡ªè–™è¬ç˜æºé‹æ¥¢é¦´ç¸„ç•·å—æ¥ è»Ÿé›£æ±äºŒå°¼å¼è¿©åŒ‚è³‘è‚‰è™¹å»¿æ—¥ä¹³å…¥å¦‚å°¿éŸ®ä»»å¦Šå¿èªæ¿¡ç¦°ç¥¢å¯§è‘±çŒ«ç†±å¹´å¿µæ»æ’šç‡ƒç²˜ä¹ƒå»¼ä¹‹åŸœåš¢æ‚©æ¿ƒç´èƒ½è„³è†¿è¾²è¦—èš¤å·´æŠŠæ’­è¦‡æ·æ³¢æ´¾ç¶ç ´å©†ç½µèŠ­é¦¬ä¿³å»ƒæ‹æ’æ•—æ¯ç›ƒç‰ŒèƒŒè‚ºè¼©é…å€åŸ¹åª’æ¢…æ¥³ç…¤ç‹½è²·å£²è³ é™ªé€™è¿ç§¤çŸ§è©ä¼¯å‰¥åšæ‹æŸæ³Šç™½ç®”ç²•èˆ¶è–„è¿«æ›æ¼ çˆ†ç¸›è«é§éº¦å‡½ç®±ç¡²ç®¸è‚‡ç­ˆæ«¨å¹¡è‚Œç•‘ç• å…«é‰¢æºŒç™ºé†—é«ªä¼ç½°æŠœç­é–¥é³©å™ºå¡™è›¤éš¼ä¼´åˆ¤åŠåå›å¸†æ¬æ–‘æ¿æ°¾æ±ç‰ˆçŠ¯ç­ç•”ç¹èˆ¬è—©è²©ç¯„é‡†ç…©é ’é£¯æŒ½æ™©ç•ªç›¤ç£è•ƒè›®åŒªå‘å¦å¦ƒåº‡å½¼æ‚²æ‰‰æ‰¹æŠ«æ–æ¯”æ³Œç–²çš®ç¢‘ç§˜ç·‹ç½·è‚¥è¢«èª¹è²»é¿éé£›æ¨‹ç°¸å‚™å°¾å¾®æ‡æ¯˜çµçœ‰ç¾é¼»æŸŠç¨—åŒ¹ç–‹é«­å½¦è†è±è‚˜å¼¼å¿…ç•¢ç­†é€¼æ¡§å§«åª›ç´ç™¾è¬¬ä¿µå½ªæ¨™æ°·æ¼‚ç“¢ç¥¨è¡¨è©•è±¹å»Ÿæç—…ç§’è‹—éŒ¨é‹²è’œè›­é°­å“å½¬æ–Œæµœç€•è²§è³“é »æ•ç“¶ä¸ä»˜åŸ å¤«å©¦å¯Œå†¨å¸ƒåºœæ€–æ‰¶æ•·æ–§æ™®æµ®çˆ¶ç¬¦è…è†šèŠ™è­œè² è³¦èµ´é˜œé™„ä¾®æ’«æ­¦èˆè‘¡è•ªéƒ¨å°æ¥“é¢¨è‘ºè•—ä¼å‰¯å¾©å¹…æœç¦è…¹è¤‡è¦†æ·µå¼—æ‰•æ²¸ä»ç‰©é®’åˆ†å»å™´å¢³æ†¤æ‰®ç„šå¥®ç²‰ç³ç´›é›°æ–‡èä¸™ä½µå…µå¡€å¹£å¹³å¼ŠæŸ„ä¸¦è”½é–‰é™›ç±³é åƒ»å£ç™–ç¢§åˆ¥ç¥è”‘ç®†åå¤‰ç‰‡ç¯‡ç·¨è¾ºè¿”éä¾¿å‹‰å¨©å¼é­ä¿èˆ—é‹ªåœƒæ•æ­©ç”«è£œè¼”ç©‚å‹Ÿå¢“æ…•æˆŠæš®æ¯ç°¿è©å€£ä¿¸åŒ…å‘†å ±å¥‰å®å³°å³¯å´©åº–æŠ±æ§æ”¾æ–¹æœ‹æ³•æ³¡çƒ¹ç ²ç¸«èƒèŠ³èŒè“¬èœ‚è¤’è¨ªè±Šé‚¦é‹’é£½é³³éµ¬ä¹äº¡å‚å‰–åŠå¦¨å¸½å¿˜å¿™æˆ¿æš´æœ›æŸæ£’å†’ç´¡è‚ªè†¨è¬€è²Œè²¿é‰¾é˜²å é ¬åŒ—åƒ•åœå¢¨æ’²æœ´ç‰§ç¦ç©†é‡¦å‹ƒæ²¡æ®†å €å¹Œå¥”æœ¬ç¿»å‡¡ç›†æ‘©ç£¨é­”éº»åŸ‹å¦¹æ˜§æšæ¯å“©æ§™å¹•è†œæ•é®ªæŸ¾é±’æ¡äº¦ä¿£åˆæŠ¹æœ«æ²«è¿„ä¾­ç¹­éº¿ä¸‡æ…¢æº€æ¼«è”“å‘³æœªé­…å·³ç®•å²¬å¯†èœœæ¹Šè“‘ç¨”è„ˆå¦™ç²æ°‘çœ å‹™å¤¢ç„¡ç‰ŸçŸ›éœ§éµ¡æ¤‹å©¿å¨˜å†¥åå‘½æ˜ç›Ÿè¿·éŠ˜é³´å§ªç‰æ»…å…æ£‰ç¶¿ç·¬é¢éººæ‘¸æ¨¡èŒ‚å¦„å­Ÿæ¯›çŒ›ç›²ç¶²è€—è’™å„²æœ¨é»™ç›®æ¢å‹¿é¤…å°¤æˆ»ç±¾è²°å•æ‚¶ç´‹é–€åŒä¹Ÿå†¶å¤œçˆºè€¶é‡å¼¥çŸ¢å„å½¹ç´„è–¬è¨³èºé–æŸ³è–®é‘“æ„‰æ„ˆæ²¹ç™’è«­è¼¸å”¯ä½‘å„ªå‹‡å‹å®¥å¹½æ‚ æ†‚æ–æœ‰æŸšæ¹§æ¶ŒçŒ¶çŒ·ç”±ç¥è£•èª˜éŠé‚‘éƒµé›„èå¤•äºˆä½™ä¸èª‰è¼¿é å‚­å¹¼å¦–å®¹åº¸æšæºæ“æ›œæ¥Šæ§˜æ´‹æº¶ç†”ç”¨çª¯ç¾Šè€€è‘‰è“‰è¦è¬¡è¸Šé¥é™½é¤Šæ…¾æŠ‘æ¬²æ²ƒæµ´ç¿Œç¿¼æ·€ç¾…èºè£¸æ¥è±é ¼é›·æ´›çµ¡è½é…ªä¹±åµåµæ¬„æ¿«è—è˜­è¦§åˆ©åå±¥ææ¢¨ç†ç’ƒç—¢è£è£¡é‡Œé›¢é™¸å¾‹ç‡ç«‹è‘æ ç•¥åŠ‰æµæºœç‰ç•™ç¡«ç²’éš†ç«œé¾ä¾¶æ…®æ—…è™œäº†äº®åƒšä¸¡å‡Œå¯®æ–™æ¢æ¶¼çŒŸç™‚ç­ç¨œç³§è‰¯è«’é¼é‡é™µé ˜åŠ›ç·‘å€«å˜æ—æ·‹ç‡ç³è‡¨è¼ªéš£é±—éºŸç‘ å¡æ¶™ç´¯é¡ä»¤ä¼¶ä¾‹å†·åŠ±å¶ºæ€œç²ç¤¼è‹“éˆ´éš·é›¶éœŠéº—é½¢æš¦æ­´åˆ—åŠ£çƒˆè£‚å»‰æ‹æ†æ¼£ç…‰ç°¾ç·´è¯è“®é€£éŒ¬å‘‚é­¯æ«“ç‚‰è³‚è·¯éœ²åŠ´å©å»Šå¼„æœ—æ¥¼æ¦”æµªæ¼ç‰¢ç‹¼ç¯­è€è¾è‹éƒå…­éº“ç¦„è‚‹éŒ²è«–å€­å’Œè©±æ­ªè³„è„‡æƒ‘æ é·²äº™äº˜é°è©«è—è•¨æ¤€æ¹¾ç¢—è…•å¼Œä¸ä¸•ä¸ªä¸±ä¸¶ä¸¼ä¸¿ä¹‚ä¹–ä¹˜äº‚äº…è±«äºŠèˆ’å¼äºäºäºŸäº äº¢äº°äº³äº¶ä»ä»ä»„ä»†ä»‚ä»—ä»ä»­ä»Ÿä»·ä¼‰ä½šä¼°ä½›ä½ä½—ä½‡ä½¶ä¾ˆä¾ä¾˜ä½»ä½©ä½°ä¾‘ä½¯ä¾†ä¾–å„˜ä¿”ä¿Ÿä¿ä¿˜ä¿›ä¿‘ä¿šä¿ä¿¤ä¿¥å€šå€¨å€”å€ªå€¥å€…ä¼œä¿¶å€¡å€©å€¬ä¿¾ä¿¯å€‘å€†åƒå‡æœƒå•ååˆåšå–å¬å¸å‚€å‚šå‚…å‚´å‚²åƒ‰åƒŠå‚³åƒ‚åƒ–åƒåƒ¥åƒ­åƒ£åƒ®åƒ¹åƒµå„‰å„å„‚å„–å„•å„”å„šå„¡å„ºå„·å„¼å„»å„¿å…€å…’å…Œå…”å…¢ç«¸å…©å…ªå…®å†€å†‚å›˜å†Œå†‰å†å†‘å†“å†•å†–å†¤å†¦å†¢å†©å†ªå†«å†³å†±å†²å†°å†µå†½å‡…å‡‰å‡›å‡ è™•å‡©å‡­å‡°å‡µå‡¾åˆ„åˆ‹åˆ”åˆåˆ§åˆªåˆ®åˆ³åˆ¹å‰å‰„å‰‹å‰Œå‰å‰”å‰ªå‰´å‰©å‰³å‰¿å‰½åŠåŠ”åŠ’å‰±åŠˆåŠ‘è¾¨è¾§åŠ¬åŠ­åŠ¼åŠµå‹å‹å‹—å‹å‹£å‹¦é£­å‹ å‹³å‹µå‹¸å‹¹åŒ†åŒˆç”¸åŒåŒåŒåŒ•åŒšåŒ£åŒ¯åŒ±åŒ³åŒ¸å€å†å…ä¸—å‰åå‡–åå©å®å¤˜å»å·å‚å–å å¦å¥å®å°å¶åƒç°’é›™åŸæ›¼ç‡®å®å¨å­åºåå½å‘€å¬å­å¼å®å¶å©åå‘å’å‘µå’å‘Ÿå‘±å‘·å‘°å’’å‘»å’€å‘¶å’„å’å’†å“‡å’¢å’¸å’¥å’¬å“„å“ˆå’¨å’«å“‚å’¤å’¾å’¼å“˜å“¥å“¦å”å””å“½å“®å“­å“ºå“¢å”¹å•€å•£å•Œå”®å•œå•…å•–å•—å”¸å”³å•å–™å–€å’¯å–Šå–Ÿå•»å•¾å–˜å–å–®å•¼å–ƒå–©å–‡å–¨å—šå—…å—Ÿå—„å—œå—¤å—”å˜”å—·å˜–å—¾å—½å˜›å—¹å™å™ç‡Ÿå˜´å˜¶å˜²å˜¸å™«å™¤å˜¯å™¬å™ªåš†åš€åšŠåš åš”åšåš¥åš®åš¶åš´å›‚åš¼å›å›ƒå›€å›ˆå›å›‘å›“å›—å›®å›¹åœ€å›¿åœ„åœ‰åœˆåœ‹åœåœ“åœ˜åœ–å—‡åœœåœ¦åœ·åœ¸ååœ»å€åå©åŸ€åˆå¡å¿å‰å“å å³å¤åªå°åŸƒåŸ†åŸ”åŸ’åŸ“å ŠåŸ–åŸ£å ‹å ™å å¡²å ¡å¡¢å¡‹å¡°æ¯€å¡’å ½å¡¹å¢…å¢¹å¢Ÿå¢«å¢ºå£å¢»å¢¸å¢®å£…å£“å£‘å£—å£™å£˜å£¥å£œå£¤å£Ÿå£¯å£ºå£¹å£»å£¼å£½å¤‚å¤Šå¤å¤›æ¢¦å¤¥å¤¬å¤­å¤²å¤¸å¤¾ç«’å¥•å¥å¥å¥šå¥˜å¥¢å¥ å¥§å¥¬å¥©å¥¸å¦å¦ä½ä¾«å¦£å¦²å§†å§¨å§œå¦å§™å§šå¨¥å¨Ÿå¨‘å¨œå¨‰å¨šå©€å©¬å©‰å¨µå¨¶å©¢å©ªåªšåª¼åª¾å«‹å«‚åª½å«£å«—å«¦å«©å«–å«ºå«»å¬Œå¬‹å¬–å¬²å«å¬ªå¬¶å¬¾å­ƒå­…å­€å­‘å­•å­šå­›å­¥å­©å­°å­³å­µå­¸æ–ˆå­ºå®€å®ƒå®¦å®¸å¯ƒå¯‡å¯‰å¯”å¯å¯¤å¯¦å¯¢å¯å¯¥å¯«å¯°å¯¶å¯³å°…å°‡å°ˆå°å°“å° å°¢å°¨å°¸å°¹å±å±†å±å±“å±å±å­±å±¬å±®ä¹¢å±¶å±¹å²Œå²‘å²”å¦›å²«å²»å²¶å²¼å²·å³…å²¾å³‡å³™å³©å³½å³ºå³­å¶Œå³ªå´‹å´•å´—åµœå´Ÿå´›å´‘å´”å´¢å´šå´™å´˜åµŒåµ’åµåµ‹åµ¬åµ³åµ¶å¶‡å¶„å¶‚å¶¢å¶å¶¬å¶®å¶½å¶å¶·å¶¼å·‰å·å·“å·’å·–å·›å·«å·²å·µå¸‹å¸šå¸™å¸‘å¸›å¸¶å¸·å¹„å¹ƒå¹€å¹å¹—å¹”å¹Ÿå¹¢å¹¤å¹‡å¹µå¹¶å¹ºéº¼å¹¿åº å»å»‚å»ˆå»å»å»–å»£å»å»šå»›å»¢å»¡å»¨å»©å»¬å»±å»³å»°å»´å»¸å»¾å¼ƒå¼‰å½å½œå¼‹å¼‘å¼–å¼©å¼­å¼¸å½å½ˆå½Œå½å¼¯å½‘å½–å½—å½™å½¡å½­å½³å½·å¾ƒå¾‚å½¿å¾Šå¾ˆå¾‘å¾‡å¾å¾™å¾˜å¾ å¾¨å¾­å¾¼å¿–å¿»å¿¤å¿¸å¿±å¿æ‚³å¿¿æ€¡æ æ€™æ€æ€©æ€æ€±æ€›æ€•æ€«æ€¦æ€æ€ºæšææªæ·æŸæŠæ†ææ£æƒæ¤æ‚æ¬æ«æ™æ‚æ‚æƒ§æ‚ƒæ‚šæ‚„æ‚›æ‚–æ‚—æ‚’æ‚§æ‚‹æƒ¡æ‚¸æƒ æƒ“æ‚´å¿°æ‚½æƒ†æ‚µæƒ˜æ…æ„•æ„†æƒ¶æƒ·æ„€æƒ´æƒºæ„ƒæ„¡æƒ»æƒ±æ„æ„æ…‡æ„¾æ„¨æ„§æ…Šæ„¿æ„¼æ„¬æ„´æ„½æ…‚æ…„æ…³æ…·æ…˜æ…™æ…šæ…«æ…´æ…¯æ…¥æ…±æ…Ÿæ…æ…“æ…µæ†™æ†–æ†‡æ†¬æ†”æ†šæ†Šæ†‘æ†«æ†®æ‡Œæ‡Šæ‡‰æ‡·æ‡ˆæ‡ƒæ‡†æ†ºæ‡‹ç½¹æ‡æ‡¦æ‡£æ‡¶æ‡ºæ‡´æ‡¿æ‡½æ‡¼æ‡¾æˆ€æˆˆæˆ‰æˆæˆŒæˆ”æˆ›æˆæˆ¡æˆªæˆ®æˆ°æˆ²æˆ³æ‰æ‰æ‰æ‰£æ‰›æ‰ æ‰¨æ‰¼æŠ‚æŠ‰æ‰¾æŠ’æŠ“æŠ–æ‹”æŠƒæŠ”æ‹—æ‹‘æŠ»æ‹æ‹¿æ‹†æ“”æ‹ˆæ‹œæ‹Œæ‹Šæ‹‚æ‹‡æŠ›æ‹‰æŒŒæ‹®æ‹±æŒ§æŒ‚æŒˆæ‹¯æ‹µææŒ¾ææœææ–ææ€æ«æ¶æ£ææ‰æŸæµæ«æ©æ¾æ©æ€æ†æ£æ‰æ’æ¶æ„æ–æ´æ†æ“æ¦æ¶æ”æ—æ¨ææ‘§æ‘¯æ‘¶æ‘æ”ªæ’•æ’“æ’¥æ’©æ’ˆæ’¼æ“šæ“’æ“…æ“‡æ’»æ“˜æ“‚æ“±æ“§èˆ‰æ“ æ“¡æŠ¬æ“£æ“¯æ”¬æ“¶æ“´æ“²æ“ºæ”€æ“½æ”˜æ”œæ”…æ”¤æ”£æ”«æ”´æ”µæ”·æ”¶æ”¸ç•‹æ•ˆæ•–æ••æ•æ•˜æ•æ•æ•²æ•¸æ–‚æ–ƒè®Šæ–›æ–Ÿæ–«æ–·æ—ƒæ—†æ—æ—„æ—Œæ—’æ—›æ—™æ— æ—¡æ—±æ²æ˜Šæ˜ƒæ—»æ³æ˜µæ˜¶æ˜´æ˜œæ™æ™„æ™‰æ™æ™æ™æ™¤æ™§æ™¨æ™Ÿæ™¢æ™°æšƒæšˆæšæš‰æš„æš˜æšæ›æš¹æ›‰æš¾æš¼æ›„æš¸æ›–æ›šæ› æ˜¿æ›¦æ›©æ›°æ›µæ›·æœæœ–æœæœ¦æœ§éœ¸æœ®æœ¿æœ¶ææœ¸æœ·æ†ææ æ™æ£æ¤æ‰æ°æ©æ¼æªæŒæ‹æ¦æ¡æ…æ·æŸ¯æ´æŸ¬æ³æŸ©æ¸æŸ¤æŸæŸæŸ¢æŸ®æ¹æŸæŸ†æŸ§æªœæ æ¡†æ ©æ¡€æ¡æ ²æ¡æ¢³æ «æ¡™æ¡£æ¡·æ¡¿æ¢Ÿæ¢æ¢­æ¢”æ¢æ¢›æ¢ƒæª®æ¢¹æ¡´æ¢µæ¢ æ¢ºæ¤æ¢æ¡¾æ¤æ£Šæ¤ˆæ£˜æ¤¢æ¤¦æ£¡æ¤Œæ£æ£”æ£§æ£•æ¤¶æ¤’æ¤„æ£—æ££æ¤¥æ£¹æ£ æ£¯æ¤¨æ¤ªæ¤šæ¤£æ¤¡æ£†æ¥¹æ¥·æ¥œæ¥¸æ¥«æ¥”æ¥¾æ¥®æ¤¹æ¥´æ¤½æ¥™æ¤°æ¥¡æ¥æ¥æ¦æ¥ªæ¦²æ¦®æ§æ¦¿æ§æ§“æ¦¾æ§å¯¨æ§Šæ§æ¦»æ§ƒæ¦§æ¨®æ¦‘æ¦ æ¦œæ¦•æ¦´æ§æ§¨æ¨‚æ¨›æ§¿æ¬Šæ§¹æ§²æ§§æ¨…æ¦±æ¨æ§­æ¨”æ§«æ¨Šæ¨’æ«æ¨£æ¨“æ©„æ¨Œæ©²æ¨¶æ©¸æ©‡æ©¢æ©™æ©¦æ©ˆæ¨¸æ¨¢æªæªæª æª„æª¢æª£æª—è˜—æª»æ«ƒæ«‚æª¸æª³æª¬æ«æ«‘æ«Ÿæªªæ«šæ«ªæ«»æ¬…è˜–æ«ºæ¬’æ¬–é¬±æ¬Ÿæ¬¸æ¬·ç›œæ¬¹é£®æ­‡æ­ƒæ­‰æ­æ­™æ­”æ­›æ­Ÿæ­¡æ­¸æ­¹æ­¿æ®€æ®„æ®ƒæ®æ®˜æ®•æ®æ®¤æ®ªæ®«æ®¯æ®²æ®±æ®³æ®·æ®¼æ¯†æ¯‹æ¯“æ¯Ÿæ¯¬æ¯«æ¯³æ¯¯éº¾æ°ˆæ°“æ°”æ°›æ°¤æ°£æ±æ±•æ±¢æ±ªæ²‚æ²æ²šæ²æ²›æ±¾æ±¨æ±³æ²’æ²æ³„æ³±æ³“æ²½æ³—æ³…æ³æ²®æ²±æ²¾æ²ºæ³›æ³¯æ³™æ³ªæ´Ÿè¡æ´¶æ´«æ´½æ´¸æ´™æ´µæ´³æ´’æ´Œæµ£æ¶“æµ¤æµšæµ¹æµ™æ¶æ¶•æ¿¤æ¶…æ·¹æ¸•æ¸Šæ¶µæ·‡æ·¦æ¶¸æ·†æ·¬æ·æ·Œæ·¨æ·’æ·…æ·ºæ·™æ·¤æ·•æ·ªæ·®æ¸­æ¹®æ¸®æ¸™æ¹²æ¹Ÿæ¸¾æ¸£æ¹«æ¸«æ¹¶æ¹æ¸Ÿæ¹ƒæ¸ºæ¹æ¸¤æ»¿æ¸æ¸¸æº‚æºªæº˜æ»‰æº·æ»“æº½æº¯æ»„æº²æ»”æ»•æºæº¥æ»‚æºŸæ½æ¼‘çŒæ»¬æ»¸æ»¾æ¼¿æ»²æ¼±æ»¯æ¼²æ»Œæ¼¾æ¼“æ»·æ¾†æ½ºæ½¸æ¾æ¾€æ½¯æ½›æ¿³æ½­æ¾‚æ½¼æ½˜æ¾æ¾‘æ¿‚æ½¦æ¾³æ¾£æ¾¡æ¾¤æ¾¹æ¿†æ¾ªæ¿Ÿæ¿•æ¿¬æ¿”æ¿˜æ¿±æ¿®æ¿›ç€‰ç€‹æ¿ºç€‘ç€ç€æ¿¾ç€›ç€šæ½´ç€ç€˜ç€Ÿç€°ç€¾ç€²ç‘ç£ç‚™ç‚’ç‚¯çƒ±ç‚¬ç‚¸ç‚³ç‚®çƒŸçƒ‹çƒçƒ™ç„‰çƒ½ç„œç„™ç…¥ç…•ç†ˆç…¦ç…¢ç…Œç…–ç…¬ç†ç‡»ç†„ç†•ç†¨ç†¬ç‡—ç†¹ç†¾ç‡’ç‡‰ç‡”ç‡ç‡ ç‡¬ç‡§ç‡µç‡¼ç‡¹ç‡¿çˆçˆçˆ›çˆ¨çˆ­çˆ¬çˆ°çˆ²çˆ»çˆ¼çˆ¿ç‰€ç‰†ç‰‹ç‰˜ç‰´ç‰¾çŠ‚çŠçŠ‡çŠ’çŠ–çŠ¢çŠ§çŠ¹çŠ²ç‹ƒç‹†ç‹„ç‹ç‹’ç‹¢ç‹ ç‹¡ç‹¹ç‹·å€çŒ—çŒŠçŒœçŒ–çŒçŒ´çŒ¯çŒ©çŒ¥çŒ¾ççé»˜ç—çªç¨ç°ç¸çµç»çºçˆç³çç»ç€ç¥ç®çç’¢ç…ç‘¯ç¥ç¸ç²çºç‘•ç¿ç‘Ÿç‘™ç‘ç‘œç‘©ç‘°ç‘£ç‘ªç‘¶ç‘¾ç’‹ç’ç’§ç“Šç“ç“”ç±ç“ ç“£ç“§ç“©ç“®ç“²ç“°ç“±ç“¸ç“·ç”„ç”ƒç”…ç”Œç”ç”ç”•ç”“ç”ç”¦ç”¬ç”¼ç•„ç•ç•Šç•‰ç•›ç•†ç•šç•©ç•¤ç•§ç•«ç•­ç•¸ç•¶ç–†ç–‡ç•´ç–Šç–‰ç–‚ç–”ç–šç–ç–¥ç–£ç—‚ç–³ç—ƒç–µç–½ç–¸ç–¼ç–±ç—ç—Šç—’ç—™ç—£ç—ç—¾ç—¿ç—¼ç˜ç—°ç—ºç—²ç—³ç˜‹ç˜ç˜‰ç˜Ÿç˜§ç˜ ç˜¡ç˜¢ç˜¤ç˜´ç˜°ç˜»ç™‡ç™ˆç™†ç™œç™˜ç™¡ç™¢ç™¨ç™©ç™ªç™§ç™¬ç™°ç™²ç™¶ç™¸ç™¼çš€çšƒçšˆçš‹çšçš–çš“çš™çššçš°çš´çš¸çš¹çšºç›‚ç›ç›–ç›’ç›ç›¡ç›¥ç›§ç›ªè˜¯ç›»çœˆçœ‡çœ„çœ©çœ¤çœçœ¥çœ¦çœ›çœ·çœ¸ç‡çšç¨ç«ç›ç¥ç¿ç¾ç¹çç‹ç‘ç çç°ç¶ç¹ç¿ç¼ç½ç»çŸ‡çŸçŸ—çŸšçŸœçŸ£çŸ®çŸ¼ç Œç ’ç¤¦ç  ç¤ªç¡…ç¢ç¡´ç¢†ç¡¼ç¢šç¢Œç¢£ç¢µç¢ªç¢¯ç£‘ç£†ç£‹ç£”ç¢¾ç¢¼ç£…ç£Šç£¬ç£§ç£šç£½ç£´ç¤‡ç¤’ç¤‘ç¤™ç¤¬ç¤«ç¥€ç¥ ç¥—ç¥Ÿç¥šç¥•ç¥“ç¥ºç¥¿ç¦Šç¦ç¦§é½‹ç¦ªç¦®ç¦³ç¦¹ç¦ºç§‰ç§•ç§§ç§¬ç§¡ç§£ç¨ˆç¨ç¨˜ç¨™ç¨ ç¨Ÿç¦€ç¨±ç¨»ç¨¾ç¨·ç©ƒç©—ç©‰ç©¡ç©¢ç©©é¾ç©°ç©¹ç©½çªˆçª—çª•çª˜çª–çª©ç«ˆçª°çª¶ç«…ç«„çª¿é‚ƒç«‡ç«Šç«ç«ç«•ç«“ç«™ç«šç«ç«¡ç«¢ç«¦ç«­ç«°ç¬‚ç¬ç¬Šç¬†ç¬³ç¬˜ç¬™ç¬ç¬µç¬¨ç¬¶ç­ç­ºç¬„ç­ç¬‹ç­Œç­…ç­µç­¥ç­´ç­§ç­°ç­±ç­¬ç­®ç®ç®˜ç®Ÿç®ç®œç®šç®‹ç®’ç®ç­ç®™ç¯‹ç¯ç¯Œç¯ç®´ç¯†ç¯ç¯©ç°‘ç°”ç¯¦ç¯¥ç± ç°€ç°‡ç°“ç¯³ç¯·ç°—ç°ç¯¶ç°£ç°§ç°ªç°Ÿç°·ç°«ç°½ç±Œç±ƒç±”ç±ç±€ç±ç±˜ç±Ÿç±¤ç±–ç±¥ç±¬ç±µç²ƒç²ç²¤ç²­ç²¢ç²«ç²¡ç²¨ç²³ç²²ç²±ç²®ç²¹ç²½ç³€ç³…ç³‚ç³˜ç³’ç³œç³¢é¬»ç³¯ç³²ç³´ç³¶ç³ºç´†ç´‚ç´œç´•ç´Šçµ…çµ‹ç´®ç´²ç´¿ç´µçµ†çµ³çµ–çµçµ²çµ¨çµ®çµçµ£ç¶“ç¶‰çµ›ç¶çµ½ç¶›ç¶ºç¶®ç¶£ç¶µç·‡ç¶½ç¶«ç¸½ç¶¢ç¶¯ç·œç¶¸ç¶Ÿç¶°ç·˜ç·ç·¤ç·ç·»ç·²ç·¡ç¸…ç¸Šç¸£ç¸¡ç¸’ç¸±ç¸Ÿç¸‰ç¸‹ç¸¢ç¹†ç¹¦ç¸»ç¸µç¸¹ç¹ƒç¸·ç¸²ç¸ºç¹§ç¹ç¹–ç¹ç¹™ç¹šç¹¹ç¹ªç¹©ç¹¼ç¹»çºƒç·•ç¹½è¾®ç¹¿çºˆçº‰çºŒçº’çºçº“çº”çº–çºçº›çºœç¼¸ç¼ºç½…ç½Œç½ç½ç½ç½‘ç½•ç½”ç½˜ç½Ÿç½ ç½¨ç½©ç½§ç½¸ç¾‚ç¾†ç¾ƒç¾ˆç¾‡ç¾Œç¾”ç¾ç¾ç¾šç¾£ç¾¯ç¾²ç¾¹ç¾®ç¾¶ç¾¸è­±ç¿…ç¿†ç¿Šç¿•ç¿”ç¿¡ç¿¦ç¿©ç¿³ç¿¹é£œè€†è€„è€‹è€’è€˜è€™è€œè€¡è€¨è€¿è€»èŠè†è’è˜èšèŸè¢è¨è³è²è°è¶è¹è½è¿è‚„è‚†è‚…è‚›è‚“è‚šè‚­å†è‚¬èƒ›èƒ¥èƒ™èƒèƒ„èƒšèƒ–è„‰èƒ¯èƒ±è„›è„©è„£è„¯è…‹éš‹è…†è„¾è…“è…‘èƒ¼è…±è…®è…¥è…¦è…´è†ƒè†ˆè†Šè†€è†‚è† è†•è†¤è†£è…Ÿè†“è†©è†°è†µè†¾è†¸è†½è‡€è‡‚è†ºè‡‰è‡è‡‘è‡™è‡˜è‡ˆè‡šè‡Ÿè‡ è‡§è‡ºè‡»è‡¾èˆèˆ‚èˆ…èˆ‡èˆŠèˆèˆèˆ–èˆ©èˆ«èˆ¸èˆ³è‰€è‰™è‰˜è‰è‰šè‰Ÿè‰¤è‰¢è‰¨è‰ªè‰«èˆ®è‰±è‰·è‰¸è‰¾èŠèŠ’èŠ«èŠŸèŠ»èŠ¬è‹¡è‹£è‹Ÿè‹’è‹´è‹³è‹ºè“èŒƒè‹»è‹¹è‹èŒ†è‹œèŒ‰è‹™èŒµèŒ´èŒ–èŒ²èŒ±è€èŒ¹èè…èŒ¯èŒ«èŒ—èŒ˜è…èšèªèŸè¢è–èŒ£èè‡èŠè¼èµè³èµè è‰è¨è´è“è«èè½èƒè˜è‹èè·è‡è è²èè¢è è½è¸è”†è»è‘­èªè¼è•šè’„è‘·è‘«è’­è‘®è’‚è‘©è‘†è¬è‘¯è‘¹èµè“Šè‘¢è’¹è’¿è’Ÿè“™è“è’»è“šè“è“è“†è“–è’¡è”¡è“¿è“´è”—è”˜è”¬è”Ÿè”•è””è“¼è•€è•£è•˜è•ˆè•è˜‚è•‹è••è–€è–¤è–ˆè–‘è–Šè–¨è•­è–”è–›è—ªè–‡è–œè•·è•¾è–è—‰è–ºè—è–¹è—è—•è—è—¥è—œè—¹è˜Šè˜“è˜‹è—¾è—ºè˜†è˜¢è˜šè˜°è˜¿è™ä¹•è™”è™Ÿè™§è™±èš“èš£èš©èšªèš‹èšŒèš¶èš¯è›„è›†èš°è›‰è £èš«è›”è›è›©è›¬è›Ÿè››è›¯èœ’èœ†èœˆèœ€èœƒè›»èœ‘èœ‰èœè›¹èœŠèœ´èœ¿èœ·èœ»èœ¥èœ©èœšè èŸè¸èŒèè´è—è¨è®è™è“è£èªè …è¢èŸè‚è¯èŸ‹è½èŸ€èŸé›–è«èŸ„è³èŸ‡èŸ†è»èŸ¯èŸ²èŸ è è èŸ¾èŸ¶èŸ·è èŸ’è ‘è –è •è ¢è ¡è ±è ¶è ¹è §è »è¡„è¡‚è¡’è¡™è¡è¡¢è¡«è¢è¡¾è¢è¡µè¡½è¢µè¡²è¢‚è¢—è¢’è¢®è¢™è¢¢è¢è¢¤è¢°è¢¿è¢±è£ƒè£„è£”è£˜è£™è£è£¹è¤‚è£¼è£´è£¨è£²è¤„è¤Œè¤Šè¤“è¥ƒè¤è¤¥è¤ªè¤«è¥è¥„è¤»è¤¶è¤¸è¥Œè¤è¥ è¥è¥¦è¥¤è¥­è¥ªè¥¯è¥´è¥·è¥¾è¦ƒè¦ˆè¦Šè¦“è¦˜è¦¡è¦©è¦¦è¦¬è¦¯è¦²è¦ºè¦½è¦¿è§€è§šè§œè§è§§è§´è§¸è¨ƒè¨–è¨è¨Œè¨›è¨è¨¥è¨¶è©è©›è©’è©†è©ˆè©¼è©­è©¬è©¢èª…èª‚èª„èª¨èª¡èª‘èª¥èª¦èªšèª£è«„è«è«‚è«šè««è«³è«§è«¤è«±è¬”è« è«¢è«·è«è«›è¬Œè¬‡è¬šè«¡è¬–è¬è¬—è¬ è¬³é«è¬¦è¬«è¬¾è¬¨è­è­Œè­è­è­‰è­–è­›è­šè­«è­Ÿè­¬è­¯è­´è­½è®€è®Œè®è®’è®“è®–è®™è®šè°ºè±è°¿è±ˆè±Œè±è±è±•è±¢è±¬è±¸è±ºè²‚è²‰è²…è²Šè²è²è²”è±¼è²˜æˆè²­è²ªè²½è²²è²³è²®è²¶è³ˆè³è³¤è³£è³šè³½è³ºè³»è´„è´…è´Šè´‡è´è´è´é½è´“è³è´”è´–èµ§èµ­èµ±èµ³è¶è¶™è·‚è¶¾è¶ºè·è·šè·–è·Œè·›è·‹è·ªè·«è·Ÿè·£è·¼è¸ˆè¸‰è·¿è¸è¸è¸è¸Ÿè¹‚è¸µè¸°è¸´è¹Šè¹‡è¹‰è¹Œè¹è¹ˆè¹™è¹¤è¹ è¸ªè¹£è¹•è¹¶è¹²è¹¼èºèº‡èº…èº„èº‹èºŠèº“èº‘èº”èº™èºªèº¡èº¬èº°è»†èº±èº¾è»…è»ˆè»‹è»›è»£è»¼è»»è»«è»¾è¼Šè¼…è¼•è¼’è¼™è¼“è¼œè¼Ÿè¼›è¼Œè¼¦è¼³è¼»è¼¹è½…è½‚è¼¾è½Œè½‰è½†è½è½—è½œè½¢è½£è½¤è¾œè¾Ÿè¾£è¾­è¾¯è¾·è¿šè¿¥è¿¢è¿ªè¿¯é‚‡è¿´é€…è¿¹è¿ºé€‘é€•é€¡é€é€é€–é€‹é€§é€¶é€µé€¹è¿¸ééé‘é’é€é‰é€¾é–é˜éé¨é¯é¶éš¨é²é‚‚é½é‚é‚€é‚Šé‚‰é‚é‚¨é‚¯é‚±é‚µéƒ¢éƒ¤æ‰ˆéƒ›é„‚é„’é„™é„²é„°é…Šé…–é…˜é…£é…¥é…©é…³é…²é†‹é†‰é†‚é†¢é†«é†¯é†ªé†µé†´é†ºé‡€é‡é‡‰é‡‹é‡é‡–é‡Ÿé‡¡é‡›é‡¼é‡µé‡¶éˆé‡¿éˆ”éˆ¬éˆ•éˆ‘é‰é‰—é‰…é‰‰é‰¤é‰ˆéŠ•éˆ¿é‰‹é‰éŠœéŠ–éŠ“éŠ›é‰šé‹éŠ¹éŠ·é‹©éŒé‹ºé„éŒ®éŒ™éŒ¢éŒšéŒ£éŒºéŒµéŒ»éœé é¼é®é–é°é¬é­é”é¹é–é—é¨é¥é˜éƒéééˆé¤éšé”é“éƒé‡éé¶é«éµé¡éºé‘é‘’é‘„é‘›é‘ é‘¢é‘é‘ªéˆ©é‘°é‘µé‘·é‘½é‘šé‘¼é‘¾é’é‘¿é–‚é–‡é–Šé–”é––é–˜é–™é– é–¨é–§é–­é–¼é–»é–¹é–¾é—Šæ¿¶é—ƒé—é—Œé—•é—”é—–é—œé—¡é—¥é—¢é˜¡é˜¨é˜®é˜¯é™‚é™Œé™é™‹é™·é™œé™é™é™Ÿé™¦é™²é™¬éšéš˜éš•éš—éšªéš§éš±éš²éš°éš´éš¶éš¸éš¹é›é›‹é›‰é›è¥é›œéœé›•é›¹éœ„éœ†éœˆéœ“éœéœ‘éœéœ–éœ™éœ¤éœªéœ°éœ¹éœ½éœ¾é„é†éˆé‚é‰éœé é¤é¦é¨å‹’é«é±é¹é…é¼ééºé†é‹éééœé¨é¦é£é³é´éŸƒéŸ†éŸˆéŸ‹éŸœéŸ­é½éŸ²ç«ŸéŸ¶éŸµé é Œé ¸é ¤é ¡é ·é ½é¡†é¡é¡‹é¡«é¡¯é¡°é¡±é¡´é¡³é¢ªé¢¯é¢±é¢¶é£„é£ƒé£†é£©é£«é¤ƒé¤‰é¤’é¤”é¤˜é¤¡é¤é¤é¤¤é¤ é¤¬é¤®é¤½é¤¾é¥‚é¥‰é¥…é¥é¥‹é¥‘é¥’é¥Œé¥•é¦—é¦˜é¦¥é¦­é¦®é¦¼é§Ÿé§›é§é§˜é§‘é§­é§®é§±é§²é§»é§¸é¨é¨é¨…é§¢é¨™é¨«é¨·é©…é©‚é©€é©ƒé¨¾é©•é©é©›é©—é©Ÿé©¢é©¥é©¤é©©é©«é©ªéª­éª°éª¼é«€é«é«‘é«“é«”é«é«Ÿé«¢é«£é«¦é«¯é««é«®é«´é«±é«·é«»é¬†é¬˜é¬šé¬Ÿé¬¢é¬£é¬¥é¬§é¬¨é¬©é¬ªé¬®é¬¯é¬²é­„é­ƒé­é­é­é­‘é­˜é­´é®“é®ƒé®‘é®–é®—é®Ÿé® é®¨é®´é¯€é¯Šé®¹é¯†é¯é¯‘é¯’é¯£é¯¢é¯¤é¯”é¯¡é°ºé¯²é¯±é¯°é°•é°”é°‰é°“é°Œé°†é°ˆé°’é°Šé°„é°®é°›é°¥é°¤é°¡é°°é±‡é°²é±†é°¾é±šé± é±§é±¶é±¸é³§é³¬é³°é´‰é´ˆé³«é´ƒé´†é´ªé´¦é¶¯é´£é´Ÿéµ„é´•é´’éµé´¿é´¾éµ†éµˆéµéµéµ¤éµ‘éµéµ™éµ²é¶‰é¶‡é¶«éµ¯éµºé¶šé¶¤é¶©é¶²é·„é·é¶»é¶¸é¶ºé·†é·é·‚é·™é·“é·¸é·¦é·­é·¯é·½é¸šé¸›é¸é¹µé¹¹é¹½éºéºˆéº‹éºŒéº’éº•éº‘éºéº¥éº©éº¸éºªéº­é¡é»Œé»é»é»é»”é»œé»é»é» é»¥é»¨é»¯é»´é»¶é»·é»¹é»»é»¼é»½é¼‡é¼ˆçš·é¼•é¼¡é¼¬é¼¾é½Šé½’é½”é½£é½Ÿé½ é½¡é½¦é½§é½¬é½ªé½·é½²é½¶é¾•é¾œé¾ å ¯æ§‡é™ç‘¤å‡œç†™"

gguide = """æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆåˆ©ç”¨è¦ç´„ æœ€çµ‚æ›´æ–° 2019/05/27

1.æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆ(ä»¥ä¸‹ã€Œã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã€ã¨ã™ã‚‹)ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸæ™‚ç‚¹ã§ã€ã“ã®è¦ç´„ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã™ã‚‹ã€‚
2.è¦ç´„é•åè€…ã¯
  ä¸€å›ç›®:è­¦å‘Š
  äºŒå›ç›®:ä¸€é€±é–“ä½¿ç”¨ç¦æ­¢
  ä¸‰å›ç›®:æ°¸ä¹…ä½¿ç”¨ç¦æ­¢
  ã‚’åŸå‰‡ã¨ã™ã‚‹ã€‚ä½¿ç”¨ç¦æ­¢ä¸­ã«ã€ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãªã©ã§ã®ç¦æ­¢å›é¿ã¯åˆ¤æ˜ã—æ¬¡ç¬¬ã€ãƒ¡ã‚¤ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã‚‚ã«æ°¸ä¹…ä½¿ç”¨ç¦æ­¢ã¨ã™ã‚‹ã€‚
3.ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ†ã‚­ã‚¹ãƒˆã€ç”»åƒã€ãã®ã‚ˆã†ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã¤ãªãŒã‚‹URLã‚’æŠ•ç¨¿ã™ã‚‹ã“ã¨ã‚’ç¦æ­¢ã™ã‚‹ã€‚ãŸã ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆä½œæˆè€…ã€ãŠã‚ˆã³ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€ç®¡ç†é‹å–¶ã«å¿…è¦ãªå ´åˆã¯ã€æŠ•ç¨¿ã—ã¦ã‚‚ã‚ˆã„ã¨ã™ã‚‹ã€‚
  ãƒ»å¹´é½¢åˆ¶é™ã®å¿…è¦ãªã‚‚ã®
  ãƒ»é–²è¦§ã«é‡‘éŠ­ã‚„å€‹äººæƒ…å ±ãŒå¿…è¦ãªã‚‚ã®(ãŸã ã—ã€ã“ã‚Œã«ã‚ˆã£ã¦æŠ•ç¨¿ãªã©ã«ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ãªã‚µã‚¤ãƒˆã®ãƒªãƒ³ã‚¯æŠ•ç¨¿ã‚’åˆ¶é™ã™ã‚‹ã‚‚ã®ã§ã¯ãªã„)
  ãƒ»Discordã®ã‚µãƒ¼ãƒãƒ¼æ‹›å¾…ã€‚ãŸã ã—æ–°æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã®ãŸã‚ã«ã€ã€Œæ€æƒŸå¥ˆã¡ã‚ƒã‚“æ›´æ–°é–¢ä¿‚ã‚µãƒ¼ãƒãƒ¼ã€ã«èª˜å°ã™ã‚‹å ´åˆãªã©ã€ä¸€éƒ¨ã®ä¾‹å¤–ã‚’é™¤ãã€‚ã“ã‚Œã«ã‚ˆã£ã¦ä»–ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒ³ãƒãƒ«åã®é€ä¿¡ã‚’ç¦æ­¢ã™ã‚‹ã‚‚ã®ã§ã¯ãªã„ã€‚
  ãƒ»æ„å‘³ã®ãªã„æ–‡å­—åˆ—ã®ç¾…åˆ—ã€‚ãŸã ã—ã€æ¥ç¶šãƒ†ã‚¹ãƒˆã®å ´åˆã‚’é™¤ãã€‚
  ãƒ»ãã®ä»–æ³•å¾‹ã€Discordåˆ©ç”¨è¦ç´„ã«é•åã™ã‚‹ã‚‚ã®
4.ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆè£½ä½œè€…ãŠã‚ˆã³ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€åˆ©ç”¨è€…ã®ã§ãã‚‹ã“ã¨ã«åŠ ãˆã¦ã€æ¬¡ã®è¡Œç‚ºã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã€‚
  ãƒ»role(è‚©æ›¸)ã®å¤‰æ›´
  (æœ¬äººã‹ã‚‰ã®ä¾é ¼ãªã©ã®å ´åˆã€‚ãŸã ã—ã€ä¸€éƒ¨æ–‡å­—åˆ—ã¯ãªã‚Šã™ã¾ã—é˜²æ­¢ã®ãŸã‚ã«å´ä¸‹ã•ã‚Œã‚‹ã€‚)
  ãƒ»åˆ©ç”¨è€…ã®ä½¿ç”¨ç¦æ­¢çŠ¶æ…‹ã®åˆ‡ã‚Šæ›¿ãˆ
  ãƒ»æŠ•ç¨¿ã®å‰Šé™¤
  ä¸ŠäºŒã¤ã®è¡Œç‚ºã‚’è¡Œã†ã®ã¯ã€å‰é …ã®é …ç›®ã«ã‚ã‚‹æŠ•ç¨¿ãŒè¡Œã‚ã‚ŒãŸå ´åˆã‚„ã€è£½ä½œè€…ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®è©±ã—åˆã„ã®çµæœã€ä¸é©åˆ‡ã ã¨åˆ¤æ–­ã•ã‚ŒãŸã‚‚ã®ã®å ´åˆã«é™ã‚‹
5.ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã«ã¦ã€ã»ã‹ã®ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹é …ç›®ã¯ã€ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã‚ã‚‹ã€‚
  ãƒ»(ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å ´åˆ)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã€ä»˜å±ã™ã‚‹embedã€æ·»ä»˜ã•ã‚ŒãŸç”»åƒ(ãŸã ã—ä¸€æšã®ã¿)
  ãƒ»(ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å ´åˆ)ã¤ã‘ãŸ/å¤–ã—ãŸãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®idã€æŠ•ç¨¿æ™‚ã«ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ãªã„ãƒ‡ãƒã‚¤ã‚¹(PC,moblie,webã®ä¸‰é€šã‚Š)
  ãƒ»é€ä¿¡ã—ãŸã‚µãƒ¼ãƒãƒ¼ã®åå‰ã€ã‚¢ã‚¤ã‚³ãƒ³ã€id
  ãƒ»é€ä¿¡å…ˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸idä¸€è¦§
  ãƒ»æŠ•ç¨¿æ™‚é–“
6.ã“ã®è¦ç´„ã¯`s-globalguide`ã§ã„ã¤ã§ã‚‚è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
7.æ”¹å®š
  ãƒ»åˆ¶ä½œè€…ãŒäºˆå‘Šãªã—ã«æ”¹å®šã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚æ”¹å®šå¾Œã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã«ã¦å ±å‘Šã•ã‚Œã‚‹ã€‚
  ãƒ»äºˆå‘Šã—ã¦æ”¹å®šã—ãŸå ´åˆã‚‚ã€åŒã˜ã‚ˆã†ã«æ”¹å®šå¾Œã«å ±å‘Šã™ã‚‹ã€‚
"""

@tasks.loop(minutes=1.0)
async def cRPC():
    global rpcct
    if rpcct==7:
        rpcct=0
    else:
        rpcct=rpcct+1
    await bot.change_presence(status=discord.Status.online,activity=discord.Game(name=rpcs[rpcct].format(len(bot.guilds),len(bot.users))))

def textto(k:str,user):
    if type(user) == str:
        lang = user
        try:
            with open(f"lang/{lang}.json","r",encoding="utf-8") as j:
                f = json.load(j)
        except:
            return f"Not found language:`{lang}`(key:`{k}`)"
        try:
            return f[k]
        except:
            return f"Not found key:`{k}`"
    else:
        cursor.execute("select * from users where id=?",(user.id,))
        upf = cursor.fetchone()
        try:
            cursor.execute("select * from guilds where id=?",(user.guild.id,))
            gpf = cursor.fetchone()
        except:
            gpf={"lang":None}
        lang = upf["lang"]
        if lang is None:
            lang = gpf["lang"]
        if lang is None:
            lang = "ja"
        try:
            with open(f"lang/{lang}.json","r",encoding="utf-8") as j:
                f = json.load(j)
        except:
            return f"Not found language:`{lang}`(key:`{k}`)"
        try:
            return f[k]
        except:
            return f"Not found key:`{k}`"


def getEmbed(ti,desc,color=ec,*optiontext):
    e = discord.Embed(title=ti,description=desc,color=color)
    nmb = -2
    while len(optiontext) >= nmb:
        try:
            nmb = nmb + 2
            e.add_field(name=optiontext[nmb],value=optiontext[nmb+1])
        except IndexError:
            pass
    return e

async def opendm(u):
    dc = u.dm_channel
    if dc == None:
        await u.create_dm()
        dc = u.dm_channel
    return dc

async def repomsg(msg,rs):
    ch = bot.get_channel(628929788421210144)
    e =  discord.Embed(title="ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ–ãƒ­ãƒƒã‚¯å±¥æ­´",description=f"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹:{msg.clean_content}",color=ec)
    e.set_author(name=f"{msg.author}(id:{msg.author.id})",icon_url=msg.author.avatar_url_as(static_format="png"))
    e.set_footer(text=f"ã‚µãƒ¼ãƒãƒ¼:{msg.guild.name}(id:{msg.guild.id})",icon_url=msg.guild.icon_url_as(static_format="png"))
    e.timestamp=msg.created_at
    e.add_field(name="ãƒ–ãƒ­ãƒƒã‚¯ç†ç”±",value=rs or "ãªã—")
    await ch.send(embed=e)

def jfup(j,fpass:str):
    with open(fpass, 'w') as wgp:
        json.dump(j,wgp)
    """with open(fpass,"rb")as spf:
        db.files_upload(spf.read(), f"/{fpass}" ,mode=dropbox.files.WriteMode('overwrite', None))"""

async def gsended(message,ch,embed):
    try:
        tmp = await ch.send(embed=embed)
        
        if not message.embeds[0] == None:
            await ch.send(embed=message.embeds[0])
        return tmp.id
    except:
        pass

async def gsendwh(message,wch,spicon,pf,ed,fls):
    try:
        for wh in await wch.webhooks():
            if wh.name == "sina_global":
                if not fls==[]:
                    sdfl = []
                    for at in fls:
                        sdfl.append(discord.File(f"globalsends/{at.filename}",filename=at.filename,spoiler=at.is_spoiler()))
                    tmp = await wh.send(content=message.clean_content,wait=True,username=f"[{spicon}]{pf['gnick']}", avatar_url=message.author.avatar_url_as(static_format='png'),embeds=ed,files=sdfl)
                else:
                    tmp = await wh.send(content=message.clean_content,wait=True,username=f"[{spicon}]{pf['gnick']}", avatar_url=message.author.avatar_url_as(static_format='png'),embeds=ed)
                return tmp.id
    except:
        pass

async def globalSend(message):
    try:
        cursor.execute("select * from globalchs")
        gchs = cursor.fetchall()
        gchn = None
        for sgch in gchs:
            if message.channel.id in sgch["ids"]:
                gchn = sgch["name"]
                gchs = sgch["ids"]
                break
        if gchn is None:
            return
        if message.content.startswith("//"):
            return
        if message.mention_everyone:
            await repomsg(message,"å…¨å“¡å½“ã¦ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³")
            return
        if len(message.mentions) >= 5:
            await repomsg(message,"5ä»¥ä¸Šã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³")
            return
        if message.webhook_id:
            return
        if message.author.id == bot.user.id: 
            return
        cursor.execute("select * from users where id=?",(message.author.id,))
        upf = cursor.fetchone()
        if (datetime.datetime.now() - rdelta(hours=9) - rdelta(days=7) >= message.author.created_at) or upf["gmod"] or upf["gstar"]:
            if upf["gban"] == 1:
                dc=await opendm(message.author)
                await dc.send(textto("global-banned",message.author).format(message.author.mention))
                await repomsg(message,"æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã®ä½¿ç”¨ç¦æ­¢")
                await message.add_reaction("âŒ")
                await asyncio.sleep(5)
                await message.remove_reaction("âŒ",bot.user)
            else:
                try:
                    ne = discord.Embed(title="", description="", color=upf["gcolor"])
                    ne.set_author(name=f"{ondevicon(message.author)},ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ID:{str(message.author.id)}")
                    if message.guild.id in [i[0] for i in partnerg]:
                        ne.set_footer(text=f"ğŸ”—(ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼):{message.guild.name}(id:{message.guild.id})",icon_url=message.guild.icon_url_as(static_format="png"))
                    else:
                        ne.set_footer(text=f"{message.guild.name}(id:{message.guild.id})",icon_url=message.guild.icon_url_as(static_format="png"))
                    ne.timestamp = datetime.datetime.now() - rdelta(hours=9)
                    embed = discord.Embed(title="æœ¬æ–‡", description=message.content, color=upf["gcolor"])
                    embed.set_footer(text=f"{message.guild.name}(id:{message.guild.id})",icon_url=message.guild.icon_url_as(static_format="png"))
                    if not message.application == None:
                        embed.add_field(name=message.application["name"]+"ã¸ã®RPCæ‹›å¾…", value="RPCæ‹›å¾…ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«é€ä¿¡ã§ãã¾ã›ã‚“ã€‚")
                    spicon = ""
                    if message.author.id == 404243934210949120:
                        spicon = spicon + "ğŸŒˆ"
                    if message.author.bot:
                        spicon = spicon + "âš™"
                    if upf["sinapartner"]:
                        spicon = spicon + "ğŸ’ "
                    if message.author.id in [i[1] for i in partnerg]:
                        spicon = spicon + "ğŸ”—"
                    if upf["gmod"]:
                        spicon = spicon + "ğŸ”§"
                    if upf["galpha"]:
                        spicon = spicon + "ğŸ””"
                    if upf["gstar"]:
                        spicon = spicon + "ğŸŒŸ"
                    if spicon == "":
                        spicon = "ğŸ‘¤"
                    embed.set_author(name=f"{upf['gnick']}({spicon}):{str(message.author.id)}", icon_url=message.author.avatar_url_as(static_format="png"))
                    if not message.attachments == []:
                        embed.set_image(url=message.attachments[0].url)
                        for atc in message.attachments:
                            temp = f"{atc.url}\n"
                        embed.add_field(name="æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã®URLä¸€è¦§", value=temp)
                except:
                    traceback.print_exc(0)
                    await message.add_reaction("âŒ")
                    await asyncio.sleep(5)
                    await message.remove_reaction("âŒ",bot.user)
                    return
                try:
                    await message.add_reaction(bot.get_emoji(653161518346534912))
                except:
                    pass
            if gchn.startswith("ed-"):
                tasks=[]
                for cid in gchs:
                    ch = bot.get_channel(cid)
                    tasks.append(asyncio.ensure_future(gsended(message,ch,embed)))
                cursor.execute("select * from globalchs where name=?",(gchn.replace("ed-",""),))
                nch = cursor.fetchone()
                try:
                    if nch["ids"]:
                        for cid in nch["ids"]:
                            try:
                                if not cid == message.channel.id:
                                    wch = bot.get_channel(cid)
                                    tasks.append(asyncio.ensure_future(gsendwh(message,wch,spicon,upf,ne,[])))
                            except:
                                pass
                    mids = await asyncio.gather(*tasks)
                    if message.attachments == []:
                        await message.delete()
                except:
                    pass
                try:
                    await message.remove_reaction(bot.get_emoji(653161518346534912),bot.user)
                except:
                    pass
            else:
                try:
                    sfs = False
                    fls = []
                    ed = []
                    if not message.attachments == []:
                        os.makedirs('globalsends/', exist_ok=True)
                        for at in message.attachments:
                            await at.save(f"globalsends/{at.filename}")
                            fls.append(at)
                        ed = ed + message.embeds + [ne]
                    else:
                        ed = ed + message.embeds + [ne]
                except:
                    traceback.print_exc(0)
                    await message.add_reaction("âŒ")
                    await asyncio.sleep(5)
                    await message.remove_reaction("âŒ",bot.user)
                    return
                try:
                    await message.add_reaction(bot.get_emoji(653161518346534912))
                except:
                    pass
                tasks = []
                for cid in gchs:
                    try:
                        if not cid == message.channel.id:
                            wch = bot.get_channel(cid)
                            tasks.append(asyncio.ensure_future(gsendwh(message,wch,spicon,upf,ed,fls)))
                    except:
                        pass
                cursor.execute("select * from globalchs where name=?",(f"ed-{gchn}",))
                och = cursor.fetchone()
                try:
                    if nch["ids"]:
                        for cid in och["ids"]:
                            ch = bot.get_channel(cid)
                            tasks.append(asyncio.ensure_future(gsended(message,ch,embed)))
                except:
                    pass
                    mids = await asyncio.gather(*tasks)

                if not fls == []:
                    shutil.rmtree("globalsends/")
                try:
                    await message.remove_reaction(bot.get_emoji(653161518346534912),bot.user)
                except:
                    pass
            cursor.execute("INSERT INTO globaldates(id,content,allid,aid,gid,timestamp) VALUES(?,?,?,?,?,?)", (int(time.time())+random.randint(1,30),message.clean_content,mids+[message.id],message.author.id,message.guild.id,str(message.created_at)))        
            await message.add_reaction(bot.get_emoji(653161518195539975))
            await asyncio.sleep(5)
            await message.remove_reaction(bot.get_emoji(653161518195539975),bot.user)
        else:
            await repomsg(message,"ä½œæˆå¾Œ7æ—¥ã«æº€ãŸãªã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ")
    except Exception as e:
        traceback.print_exc()

@bot.event
async def on_voice_state_update(member, before, after):
    try:
        if [i for i in member.guild.me.voice.channel.members if not i.bot]==[]:
            await member.guild.voice_client.disconnect()
    except:
        pass
    try:
        if bot.voice_clients == []:
            shutil.rmtree("musicfile/")
            os.makedirs('musicfile/', exist_ok=True)
    except:
        pass

@bot.event
async def on_member_update(b,a):
    global Donotif
    #serverlog
    try:
        e=discord.Embed(title="ãƒ¡ãƒ³ãƒãƒ¼ã®æ›´æ–°",description=f"å¤‰æ›´ãƒ¡ãƒ³ãƒãƒ¼:{str(a)}",color=ec)
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        if not b.nick == a.nick:
            e.add_field(name="å¤‰æ›´å†…å®¹",value="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ")
            if b.nick:
                bnick = b.nick
            else:
                bnick = b.name
            if a.nick:
                anick = a.nick
            else:
                anick = a.name
            e.add_field(name="å¤‰æ›´å‰",value=bnick.replace("\\","\\\\").replace("*","\*").replace("_","\_").replace("|","\|").replace("~","\~").replace("`","\`").replace(">","\>"))
            e.add_field(name="å¤‰æ›´å¾Œ",value=anick.replace("\\","\\\\").replace("*","\*").replace("_","\_").replace("|","\|").replace("~","\~").replace("`","\`").replace(">","\>"))
            cursor.execute("select * from guilds where id=?",(a.guild.id,))
            gpf = cursor.fetchone()
            if gpf["sendlog"]:
                ch = bot.get_channel(gpf["sendlog"])
                if ch.guild.id == a.guild.id:
                    await ch.send(embed=e)
        elif not b.roles == a.roles:
            if len(b.roles) > len(a.roles):
                e.add_field(name="å¤‰æ›´å†…å®¹",value="å½¹è·é™¤å»")
                e.add_field(name="å½¹è·",value=list(set(b.roles)-set(a.roles))[0])
            else:
                e.add_field(name="å¤‰æ›´å†…å®¹",value="å½¹è·ä»˜ä¸")
                e.add_field(name="å½¹è·",value=list(set(a.roles)-set(b.roles))[0])
            cursor.execute("select * from guilds where id=?",(a.guild.id,))
            gpf = cursor.fetchone()
            if gpf["sendlog"]:
                ch = bot.get_channel(gpf["sendlog"])
                if ch.guild.id == a.guild.id:
                    await ch.send(embed=e)
            e.set_footer(text=a.guild.name,icon_url=a.guild.icon_url_as(static_format="png"))
            e.timestamp = datetime.datetime.now() - rdelta(hours=9)
            await aglch.send(embed=e)
    except:
        pass
    while Donotif:
        await asyncio.sleep(0.5)
    Donotif = True
    cursor.execute("select * from users")
    upf = cursor.fetchall()
    try:
        if str(b.status)=="offline" and not str(a.status)=="offline":
            for pf in upf:
                if a.id in pf["onnotif"] :
                    sdu = bot.get_user(pf["id"])
                    dc = await opendm(sdu)
                    lm = await dc.history(limit=1).flatten()
                    nf=str(bot.get_emoji(653161518531215390))+textto("onlinenotif",sdu).format(str(a)).replace(str(bot.get_user(455284639108431873))+"ã•ã‚“","ãŠã‚ãšã¡ã‚ƒã‚“").replace(str(bot.get_user(404243934210949120)),"ã¿ãƒã¦ã‚“â˜†")
                    if not lm[0].content==nf:
                        ts = discord.Embed(title="", description="", color=ec)
                        ts.set_footer(text=ondevicon(a)+","+textto("sendedat",sdu))
                        ts.timestamp = datetime.datetime.now() - rdelta(hours=9)
                        await dc.send(nf,embed=ts)
        elif not str(b.status)=="offline" and str(a.status)=="offline":
            for pf in upf:
                if a.id in pf["onnotif"]:
                    sdu = bot.get_user(pf["id"])
                    dc = await opendm(sdu)
                    lm = await dc.history(limit=1).flatten()
                    nf=str(bot.get_emoji(653161518392803348))+textto("offlinenotif",sdu).format(str(a)).replace(str(bot.get_user(455284639108431873))+"ã•ã‚“","ãŠã‚ãšã¡ã‚ƒã‚“").replace(str(bot.get_user(404243934210949120)),"ã¿ãƒã¦ã‚“â˜†")
                    if not lm[0].content==nf:
                        ts = discord.Embed(title="", description="", color=ec)
                        ts.set_footer(text=textto("sendedat",sdu))
                        ts.timestamp = datetime.datetime.now() - rdelta(hours=9)
                        await dc.send(nf,embed=ts)
    except:
        print(traceback.format_exc(2))
    Donotif = False

async def nga(m,r):
    ch=m.guild.get_channel(631875590307446814)
    
    admins = m.guild.get_role(574494236951707668)
    tmpadmins = m.guild.get_role(583952666317684756)
    subadmins = m.guild.get_role(579283058394660864)
    giverole = m.guild.get_role(620911942889897984)
    tch = await ch.create_text_channel(f"èªè¨¼å¾…ã¡-{m.name}",overwrites={
        m:discord.PermissionOverwrite(read_messages=True,send_messages=True),
        m.guild.default_role:discord.PermissionOverwrite(read_messages=False),
        admins:discord.PermissionOverwrite(read_messages=True,send_messages=True),
        tmpadmins:discord.PermissionOverwrite(read_messages=True,send_messages=True),
        subadmins:discord.PermissionOverwrite(read_messages=True,send_messages=True),
        giverole:discord.PermissionOverwrite(read_messages=True,send_messages=True)
    },topic=str(m.id))
    await tch.send(f"""{m.mention}ã•ã‚“ï¼ã¿ãƒã¦ã‚“â˜†ã®å…¬é–‹ã‚µãƒ¼ãƒãƒ¼(ä»¥ä¸‹ã€Œã“ã®ã‚µãƒ¼ãƒãƒ¼ã€)ã«ã‚ˆã†ã“ãï¼
ã‚ãªãŸã¯{r}ãŒç†ç”±ã§ã€è©¦é¨“é‹ç”¨ä¸­ã®è‡ªå‹•èªè¨¼ãŒè¡Œã‚ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
ã¾ãšã¯ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„!
https://gist.github.com/apple502j/1a81b1a95253609f0c67ecb74f38754b
ãã®å¾Œã€ãã®ã“ã¨ã‚’å ±å‘Šã—ã¦ãã ã•ã„ã€‚ãã®å¾Œã«æ±ºå®šã•ã‚Œã‚‹ã¾ã§ã«ã€ã„ãã¤ã‹è³ªå•ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚ãªãŸã®æ–¹ã®è³ªå•ã‚‚ã€ã“ã®å ´ã‚’ä½¿ã£ã¦è¡Œã£ã¦ãã ã•ã„ã€‚
    """)

@bot.event
async def on_member_join(member):
    if member.guild.id == 574170788165582849:
        if member.bot:
            await member.add_roles(member.guild.get_role(574494559946539009))
        else:
            uich = bot.get_channel(633651383353999370)
            
            e= discord.Embed(title=f"å‚åŠ ãƒ¡ãƒ³ãƒãƒ¼{member}ã«ã¤ã„ã¦",color=ec)
            e.add_field(name="å…±é€šã‚µãƒ¼ãƒãƒ¼æ•°",value=len([g for g in bot.guilds if g.get_member(member.id)]))
            e.add_field(name="ID",value=member.id)
            e.set_footer(text="ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—")
            e.timestamp=member.created_at
            await uich.send(embed=e)
            mrole = member.guild.get_role(574494088837988352)
            
            bunotif = 0
            if len([g for g in bot.guilds if g.get_member(member.id)]) == 1:
                await nga(member,"æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã¨ã®å…±é€šã®ã‚µãƒ¼ãƒãƒ¼ãŒã»ã‹ã«ãªã„ã“ã¨")
            else:
                for g in bot.guilds:
                    
                    try:
                        tmp = await g.bans()
                    except:
                        continue
                    banulist = [i.user.id for i in tmp]
                    if member.id in banulist:
                        bunotif = bunotif + 1
                if bunotif != 0:
                    await nga(member,"æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã¨ã®å…±é€šã®ã»ã‹ã‚µãƒ¼ãƒãƒ¼ã§ã®ban")
                    pass
                else:
                    if datetime.datetime.now() - rdelta(hours=9) - rdelta(days=7) < member.created_at:
                        await nga(member,"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆã‹ã‚‰7æ—¥çµŒéã—ã¦ã„ãªã„ã“ã¨")
                        pass
                    else:
                        await member.add_roles(mrole)
                        ch = await opendm(member)
                        try:
                            await ch.send(f"""{member.mention}ã•ã‚“ï¼ã¿ãƒã¦ã‚“â˜†ã®å…¬é–‹ã‚µãƒ¼ãƒãƒ¼(ä»¥ä¸‹ã€Œã“ã®ã‚µãƒ¼ãƒãƒ¼ã€)ã«ã‚ˆã†ã“ãï¼
    ã‚ãªãŸã¯ã€ã„ãã¤ã‹ã®æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ãŸã‚ã€è‡ªå‹•çš„ã«å½¹è·ãŒä»˜ä¸ã•ã‚Œã¾ã—ãŸã®ã§ã€ã‚µãƒ¼ãƒãƒ¼ã§ã€ã‚†ã£ãã‚Šéã”ã•ã‚Œã¦è¡Œã£ã¦ãã ã•ã„ã€‚
    ã§ã™ãŒã€ä½¿ç”¨å‰ã«ã¾ãšã¯ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„!
    https://gist.github.com/apple502j/1a81b1a95253609f0c67ecb74f38754b
    ã¾ãŸã€å¿…è¦ã«å¿œã˜ã¦é€šçŸ¥è¨­å®šã‚’ã€Œã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãªã©ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ã€Œ@ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã®ã¿ã€ã§ã™ã€‚)
                            """)
                        except:
                            ch = member.guild.get_channel(574494906287128577)
                            await ch.send(f"""{member.mention}ã•ã‚“ï¼ã¿ãƒã¦ã‚“â˜†ã®å…¬é–‹ã‚µãƒ¼ãƒãƒ¼(ä»¥ä¸‹ã€Œã“ã®ã‚µãƒ¼ãƒãƒ¼ã€)ã«ã‚ˆã†ã“ãï¼
    ã‚ãªãŸã¯ã€ã„ãã¤ã‹ã®æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ãŸã‚ã€è‡ªå‹•çš„ã«å½¹è·ãŒä»˜ä¸ã•ã‚Œã¾ã—ãŸã®ã§ã€ã‚µãƒ¼ãƒãƒ¼ã§ã€ã‚†ã£ãã‚Šéã”ã•ã‚Œã¦è¡Œã£ã¦ãã ã•ã„ã€‚
    ã§ã™ãŒã€ä½¿ç”¨å‰ã«ã¾ãšã¯ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„!
    https://gist.github.com/apple502j/1a81b1a95253609f0c67ecb74f38754b
    ã¾ãŸã€å¿…è¦ã«å¿œã˜ã¦é€šçŸ¥è¨­å®šã‚’ã€Œã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãªã©ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ã€Œ@ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã®ã¿ã€ã§ã™ã€‚)
                            """)
                        schs=[631815290044284938,574494906287128577]
                        for c in schs:
                            
                            sch = bot.get_channel(c)
                            await sch.send(embed=getEmbed("è‡ªå‹•èªè¨¼(è©¦é¨“é‹ç”¨ä¸­)å®Œäº†ã®ãŠçŸ¥ã‚‰ã›",f"{member.mention}ã•ã‚“ãŒè‡ªå‹•èªè¨¼ã‚’æ¸ˆã¾ã›ã¾ã—ãŸã€‚"))
    else:
        try:
            cursor.execute("select * from guilds where id=?",(member.guild.id,))
            gpf = cursor.fetchone()
            ctt = gpf["jltasks"]
            if not ctt.get("welcome") == None:
                if ctt["welcome"]["sendto"] == "sysch":
                    await member.guild.system_channel.send(ctt["welcome"]["content"].format(member.mention))
                else:
                    dc = await opendm(member)
                    await dc.send(ctt["welcome"]["content"].format(member.mention))
        except:
            pass
    e=discord.Embed(title="ãƒ¡ãƒ³ãƒãƒ¼ã®å‚åŠ ",description=f"{len(member.guild.members)}äººç›®ã®ãƒ¡ãƒ³ãƒãƒ¼",color=ec)
    e.add_field(name="å‚åŠ ãƒ¡ãƒ³ãƒãƒ¼",value=member.mention)
    e.add_field(name="ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®id",value=member.id)
    e.set_footer(text=f"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ—¥æ™‚(ãã®ã¾ã¾ã®å€¤:{member.created_at},ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—åŒ–:")
    e.timestamp = member.created_at
    cursor.execute("select * from guilds where id=?",(member.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == member.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=member.guild.name,icon_url=member.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)
    #ä»–ã‚µãƒ¼ãƒãƒ¼ã§ã®bané€šçŸ¥
    bunotif = 0
    for g in bot.guilds:
        
        try:
            tmp = await g.bans()
        except:
            continue
        banulist = [i.user.id for i in tmp]
        if member.id in banulist:
            bunotif = bunotif + 1
    if bunotif == 0:
        for ch in member.guild.channels:
            if ch.name == "sina-user-check":
                await ch.send(embed=discord.Embed(title=f"{member}ã®å®‰å…¨æ€§è©•ä¾¡",description=f"ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ã§ã¯ã€banã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"))
    else:
        for ch in member.guild.channels:
            if ch.name == "sina-user-check":
                await ch.send(embed=discord.Embed(title=f"{member}ã®å®‰å…¨æ€§è©•ä¾¡",description=f"ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã„ã‚‹{bunotif}ã®ã‚µãƒ¼ãƒãƒ¼ã§banã•ã‚Œã¦ã„ã¾ã™ã€‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚"))


@bot.event
async def on_member_remove(member):
    if member.guild.id == 574170788165582849:
        await member.guild.system_channel.send(f"{str(member)}ã•ã‚“ãŒã“ã®ã‚µãƒ¼ãƒãƒ¼ã‚’é€€å‡ºã—ã¾ã—ãŸã€‚")
    else:
        try:
            cursor.execute("select * from guilds where id=?",(member.guild.id,))
            gpf = cursor.fetchone()
            ctt = gpf["jltasks"]
            if not ctt.get("cu") == None:
                if ctt["cu"]["sendto"] == "sysch":
                    await member.guild.system_channel.send(ctt["cu"]["content"].format(str(member)))
                else:
                    dc = await opendm(member)
                    await dc.send(ctt["cu"]["content"].format(str(member)))
        except:
            pass
    e=discord.Embed(title="ãƒ¡ãƒ³ãƒãƒ¼ã®é€€å‡º",color=ec)
    e.add_field(name="é€€å‡ºãƒ¡ãƒ³ãƒãƒ¼",value=str(member))
    e.add_field(name="å½¹è·",value=[i.name for i in member.roles])
    #e.set_footer(text=f"{member.guild.name}/{member.guild.id}")
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(member.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == member.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=member.guild.name,icon_url=member.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)
    """if member.guild.id == 611445741902364672:
        c = bot.get_channel(613629308166209549)
        await c.send(embed=e)"""

@bot.event
async def on_webhooks_update(channel):
    e=discord.Embed(title="Webhooksã®æ›´æ–°",color=ec)
    e.add_field(name="ãƒãƒ£ãƒ³ãƒãƒ«",value=channel.mention)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(channel.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == channel.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=channel.guild.name,icon_url=channel.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_guild_role_create(role):
    e=discord.Embed(title="å½¹è·ã®ä½œæˆ",color=ec)
    e.add_field(name="å½¹è·å",value=role.name)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(role.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == role.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=role.guild.name,icon_url=role.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_guild_role_delete(role):
    e=discord.Embed(title="å½¹è·ã®å‰Šé™¤",color=ec)
    e.add_field(name="å½¹è·å",value=role.name)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(role.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == role.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=role.guild.name,icon_url=role.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_message_edit(before, after):
    if not after.author.bot:
        if before.content != after.content:
            e=discord.Embed(title="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç·¨é›†",color=ec)
            e.add_field(name="ç·¨é›†å‰",value=before.content)
            e.add_field(name="ç·¨é›†å¾Œ",value=after.content)
            e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡è€…",value=after.author.mention)
            e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ£ãƒ³ãƒãƒ«",value=after.channel.mention)
            e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®URL",value=after.jump_url)
            e.timestamp = datetime.datetime.now() - rdelta(hours=9)
            cursor.execute("select * from guilds where id=?",(after.guild.id,))
            gpf = cursor.fetchone()
            if gpf["sendlog"]:
                ch = bot.get_channel(gpf["sendlog"])
                if ch.guild.id == after.guild.id:
                    await ch.send(embed=e) 
            e.set_footer(text=after.guild.name,icon_url=after.guild.icon_url_as(static_format="png"))
            e.timestamp = datetime.datetime.now() - rdelta(hours=9)
            await aglch.send(embed=e)

@bot.event
async def on_guild_channel_delete(channel):
    bl=await channel.guild.audit_logs(limit=1,action=discord.AuditLogAction.channel_delete).flatten()
    e=discord.Embed(title="ãƒãƒ£ãƒ³ãƒãƒ«å‰Šé™¤",color=ec)
    e.add_field(name="ãƒãƒ£ãƒ³ãƒãƒ«å",value=channel.name)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(channel.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == channel.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=channel.guild.name,icon_url=channel.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_reaction_clear(message, reactions):
    e=discord.Embed(title="ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸€æ–‰é™¤å»",color=ec)
    e.add_field(name="ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³",value=[str(i) for i in reactions])
    e.add_field(name="é™¤å»ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",value=message.content or "(æœ¬æ–‡ãªã—)")
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(message.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == message.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=message.guild.name,icon_url=message.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_message_delete(message):
    if not message.author.bot:
        e=discord.Embed(title="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤",color=ec)
        e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",value=message.content)
        e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡è€…",value=message.author.mention)
        e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ£ãƒ³ãƒãƒ«",value=message.channel.mention)
        e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®id",value=message.id)
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        cursor.execute("select * from guilds where id=?",(message.guild.id,))
        gpf = cursor.fetchone()
        if gpf["sendlog"]:
            ch = bot.get_channel(gpf["sendlog"])
            if ch.guild.id == message.guild.id:
                await ch.send(embed=e)
        e.set_footer(text=message.guild.name,icon_url=message.guild.icon_url_as(static_format="png"))
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        await aglch.send(embed=e)


@bot.event
async def on_bulk_message_delete(messages):
    e=discord.Embed(title="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€æ‹¬å‰Šé™¤",color=ec)
    e.add_field(name="ä»¶æ•°",value=len(messages))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    for message in messages:
        if not message.author.bot:
            e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",value=message.content)
            e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡è€…",value=message.author.mention)
            e.add_field(name="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®id",value=message.id)
    cursor.execute("select * from guilds where id=?",(messages[0].guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == messages[0].guild.id:
            await ch.send(embed=e)
    e.set_footer(text=messages[0].guild.name,icon_url=messages[0].guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)


@bot.event
async def on_guild_channel_create(channel):
    e=discord.Embed(title="ãƒãƒ£ãƒ³ãƒãƒ«ä½œæˆ",color=ec)
    e.add_field(name="ãƒãƒ£ãƒ³ãƒãƒ«å",value=channel.mention)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(channel.guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == channel.guild.id:
            await ch.send(embed=e)
    e.set_footer(text=channel.guild.name,icon_url=channel.guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_guild_channel_update(b, a):
    e=discord.Embed(title="ãƒãƒ£ãƒ³ãƒãƒ«æ›´æ–°",description=a.mention,color=ec)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    if not b.name == a.name:
        if not a.guild.id == 461789442743468073:
            e.add_field(name="å¤‰æ›´å†…å®¹",value="ãƒãƒ£ãƒ³ãƒãƒ«å")
            e.add_field(name="å¤‰æ›´å‰",value=b.name)
            e.add_field(name="å¤‰æ›´å¾Œ",value=a.name)
            cursor.execute("select * from guilds where id=?",(a.guild.id,))
            gpf = cursor.fetchone()
            if gpf["sendlog"]:
                ch = bot.get_channel(gpf["sendlog"])
                if ch.guild.id == a.guild.id:
                    await ch.send(embed=e)
            e.set_footer(text=a.guild.name,icon_url=a.guild.icon_url_as(static_format="png"))
            e.timestamp = datetime.datetime.now() - rdelta(hours=9)
            await aglch.send(embed=e)
    elif not b.changed_roles == a.changed_roles:
        e.add_field(name="å¤‰æ›´å†…å®¹",value="æ¨©é™ã®ä¸Šæ›¸ã")
        e.add_field(name="ç¢ºèª:",value="ãƒãƒ£ãƒ³ãƒãƒ«è¨­å®šã‚’è¦‹ã¦ãã ã•ã„ã€‚")
        cursor.execute("select * from guilds where id=?",(a.guild.id,))
        gpf = cursor.fetchone()
        if gpf["sendlog"]:
            ch = bot.get_channel(gpf["sendlog"])
            if ch.guild.id == a.guild.id:
                await ch.send(embed=e)    
        e.set_footer(text=a.guild.name,icon_url=a.guild.icon_url_as(static_format="png"))
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        await aglch.send(embed=e)
    elif isinstance(b,discord.TextChannel):
        if not b.topic == a.topic:
            e.add_field(name="å¤‰æ›´å†…å®¹",value="ãƒãƒ£ãƒ³ãƒãƒ«ãƒˆãƒ”ãƒƒã‚¯")
            e.add_field(name="å¤‰æ›´å‰",value=b.topic)
            e.add_field(name="å¤‰æ›´å¾Œ",value=a.topic)
            cursor.execute("select * from guilds where id=?",(a.guild.id,))
            gpf = cursor.fetchone()
            if gpf["sendlog"]:
                ch = bot.get_channel(gpf["sendlog"])
                if ch.guild.id == a.guild.id:
                    await ch.send(embed=e)
            e.set_footer(text=a.guild.name,icon_url=a.guild.icon_url_as(static_format="png"))
            e.timestamp = datetime.datetime.now() - rdelta(hours=9)
            await aglch.send(embed=e)

@bot.event
async def on_guild_update(b, a):
    e=discord.Embed(title="ã‚µãƒ¼ãƒãƒ¼ã®æ›´æ–°",color=ec)
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    if b.name != a.name:
        e.add_field(name="å¤‰æ›´å†…å®¹",value="ã‚µãƒ¼ãƒãƒ¼å")
        e.add_field(name="å¤‰æ›´å‰",value=b.name)
        e.add_field(name="å¤‰æ›´å¾Œ",value=a.name)
        cursor.execute("select * from guilds where id=?",(a.id,))
        gpf = cursor.fetchone()
        if gpf["sendlog"]:
            ch = bot.get_channel(gpf["sendlog"])
            if ch.guild.id == a.id:
                await ch.send(embed=e)
        e.set_footer(text=a.name,icon_url=a.icon_url_as(static_format="png"))
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        await aglch.send(embed=e)
    elif b.icon != a.icon:
        e.add_field(name="å¤‰æ›´å†…å®¹",value="ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³")
        cursor.execute("select * from guilds where id=?",(a.id,))
        gpf = cursor.fetchone()
        if gpf["sendlog"]:
            ch = bot.get_channel(gpf["sendlog"])
            if ch.guild.id == a.id:
                await ch.send(embed=e)
        e.set_footer(text=a.name,icon_url=a.icon_url_as(static_format="png"))
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        await aglch.send(embed=e)
    elif b.owner.id != a.owner.id:
        e.add_field(name="å¤‰æ›´å†…å®¹",value="ã‚µãƒ¼ãƒãƒ¼æ‰€æœ‰è€…ã®å¤‰æ›´")
        e.add_field(name="å¤‰æ›´å‰",value=b.owner)
        e.add_field(name="å¤‰æ›´å¾Œ",value=a.owner)
        cursor.execute("select * from guilds where id=?",(a.id,))
        gpf = cursor.fetchone()
        if gpf["sendlog"]:
            ch = bot.get_channel(gpf["sendlog"])
            if ch.guild.id == a.id:
                await ch.send(embed=e)
        e.set_footer(text=a.name,icon_url=a.icon_url_as(static_format="png"))
        e.timestamp = datetime.datetime.now() - rdelta(hours=9)
        await aglch.send(embed=e)

@bot.event
async def on_member_ban(g, user):
    guild = bot.get_guild(g.id)
    bl=await guild.audit_logs(limit=1,action=discord.AuditLogAction.ban).flatten()
    e=discord.Embed(title="ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ban",color=ec)
    e.add_field(name="ãƒ¦ãƒ¼ã‚¶ãƒ¼å",value=str(user))
    e.add_field(name="(ãƒ†ã‚¹ãƒˆ)å®Ÿè¡Œè€…",value=str(bl[0].user))
    #e.set_footer(text=f"{g.name}/{g.id}")
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(g.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == g.id:
            await ch.send(embed=e)
    e.set_footer(text=g.name,icon_url=g.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)
    """if g.id == 611445741902364672:
        c = bot.get_channel(613629308166209549)
        await c.send(embed=e)"""

@bot.event
async def on_member_unban(guild, user):
    e=discord.Embed(title="ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®banè§£é™¤",color=ec)
    e.add_field(name="ãƒ¦ãƒ¼ã‚¶ãƒ¼å",value=str(user))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    cursor.execute("select * from guilds where id=?",(guild.id,))
    gpf = cursor.fetchone()
    if gpf["sendlog"]:
        ch = bot.get_channel(gpf["sendlog"])
        if ch.guild.id == guild.id:
            await ch.send(embed=e)
    e.set_footer(text=guild.name,icon_url=guild.icon_url_as(static_format="png"))
    e.timestamp = datetime.datetime.now() - rdelta(hours=9)
    await aglch.send(embed=e)

@bot.event
async def on_guild_join(guild):
    dc = await opendm(bot.get_user(404243934210949120))
    await dc.send(f"`{guild.name}`(id:{guild.id})ã«å‚åŠ ã—ã¾ã—ãŸã€‚")

@bot.event
async def on_guild_remove(guild):
    dc = await opendm(bot.get_user(404243934210949120))
    await dc.send(f"`{guild.name}`(id:{guild.id})ã‹ã‚‰é€€å‡ºã—ã¾ã—ãŸã€‚")

@bot.event
async def on_guild_channel_pins_update(ch,lmtime):
    if ch.guild.id in [461153681971216384,574170788165582849]:
        await ch.send(embed=getEmbed("pin-update!","",ec))

@bot.event
async def on_ready():
    global aglch
    print('ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸã€‚')
    print(bot.user.name)
    print(bot.user.id)
    print('------------------')
    try:
        ch = bot.get_channel(595526013031546890)
        await ch.send(f"{bot.get_emoji(653161518531215390)}èµ·å‹•å®Œäº†ï¼")
    except:
        pass
    aglch = bot.get_channel(659706303521751072)
    cRPC.start()
    invite_tweet.start()
    now_sina_tweet.start()
    bot.load_extension("jishaku")
    music.setup(bot)

@bot.event
async def on_message(message):
    if isinstance(message.channel,discord.DMChannel):
        return
    if message.author.id==bot.user.id:
        return
    #db.files_download_to_file( "guildsetting.json" , "/guildsetting.json" )
    #db.files_download_to_file( "profiles.json" , "/profiles.json" )
    tks=[
        asyncio.ensure_future(domsg(message)),
        asyncio.ensure_future(globalSend(message)),
    ]
    await asyncio.gather(*tks)


async def domsg(message):
    global DoServercmd
    cursor.execute("select * from users where id=?",(message.author.id,))
    upf = cursor.fetchone()
    if not upf:
        cursor.execute("INSERT INTO users(id,prefix,gpoint,memo,levcard,onnotif,lang,accounts,sinapartner,gban,gnick,gcolor,gmod,gstar,galpha,gbanhist) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)", (message.author.id,[],0,{},"m@jiâ˜†",[],None,[],0,0,message.author.name,0,0,0,0,"ãªã—"))
        try:
            dc=await opendm(message.author)
            await dc.send(f"{bot.get_emoji(653161518153596950)}ã‚ãªãŸã®æ€æƒŸå¥ˆã¡ã‚ƒã‚“ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸï¼ã„ãã¤ã‹ã®é …ç›®ã¯ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ã—ãã¯ãƒ˜ãƒ«ãƒ—(`s-help`)ã‚’ã”è¦§ãã ã•ã„ã€‚\nä»¥å‰ã‹ã‚‰ã®åˆ©ç”¨è€…ã¸:æ§˜ã€…ãªè¨­å®šãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚å†è¨­å®šã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚ã¾ãŸã€ä¸å…·åˆãŒã‚ã‚Šã¾ã—ãŸã‚‰`mii-10#3110`ã«ãŠé¡˜ã„ã—ã¾ã™ã€‚")
        except:
            pass
    cursor.execute("select * from users where id=?",(message.author.id,))
    pf = cursor.fetchone()

    cursor.execute("select * from guilds where id=?",(message.guild.id,))
    gpf = cursor.fetchone()
    if not gpf:
        cursor.execute("INSERT INTO guilds(id,levels,commands,hash,levelupsendto,reward,jltasks,lockcom,sendlog,prefix,lang) VALUES(?,?,?,?,?,?,?,?,?,?,?)", (message.guild.id,{},{},[],None,{},{},[],None,[],None))
        try:
            await message.channel.send(f"{bot.get_emoji(653161518153596950)}ã“ã®ã‚µãƒ¼ãƒãƒ¼ã®æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸï¼ã„ãã¤ã‹ã®é …ç›®ã¯ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ã—ãã¯ãƒ˜ãƒ«ãƒ—(`s-help`)ã‚’ã”è¦§ãã ã•ã„ã€‚\nä»¥å‰ã‹ã‚‰ã®åˆ©ç”¨è€…ã¸:æ§˜ã€…ãªè¨­å®šãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚å†è¨­å®šã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚ã¾ãŸã€ä¸å…·åˆãŒã‚ã‚Šã¾ã—ãŸã‚‰`mii-10#3110`ã«ãŠé¡˜ã„ã—ã¾ã™ã€‚")
        except:
            pass
    cursor.execute("select * from guilds where id=?",(message.guild.id,))
    gs = cursor.fetchone()


    tks=[asyncio.ensure_future(dlevel(message,gs)),asyncio.ensure_future(gahash(message,gs)),asyncio.ensure_future(runsercmd(message,gs,pf))]
    await asyncio.gather(*tks)
    tpf=["s-"]+pf["prefix"]+gs["prefix"]
    bot.command_prefix = tpf 
    ctx = await bot.get_context(message)
    try:
        if ctx.command:
            if ctx.command.name in gs["lockcom"] and not ctx.author.guild_permissions.administrator:
                await ctx.send(textto("comlock-locked",ctx.author))
            else:
                await bot.process_commands(message)
    except SystemExit:
        sys.exit()
    except Exception:
        print(traceback.format_exc(0))

async def runsercmd(message,gs,pf):
    #servercmd
    if not "scom" in gs["lockcom"]:
        if not message.author.id == bot.user.id and message.webhook_id is None: 
            tpf=pf["prefix"]+gs["prefix"]
            tpf.append("s-")
            try:
                if not gs["commands"] == None:
                    cmds = gs["commands"]
                    ctts = message.content.split(" ")
                    for k,v in cmds.items():
                        for px in tpf:
                            if px+k == ctts[0]:
                                DoServercmd = True
                                if v["mode"] == "random":
                                    await message.channel.send(random.choice(v["rep"]))
                                elif v["mode"] == "one":
                                    await message.channel.send(v["rep"])
                                elif v["mode"] == "role":
                                    try:
                                        role =message.guild.get_role(v["rep"])
                                    except:
                                        await message.channel.send(textto("scmd-notfound-role",message.author))
                                    if role < message.author.top_role:
                                        if role in message.author.roles:
                                            await message.author.remove_roles(role)
                                            await message.channel.send(textto("scmd-delrole",message.author))
                                        else:
                                            await message.author.add_roles(role)
                                            await message.channel.send(textto("scmd-addrole",message.author))
                                    else:
                                        await message.channel.send(textto("scmd-notrole",message.author))
                                break
            except:
                pass

async def gahash(message,gs):
    if message.channel.id == 611117238464020490:
        if message.embeds:
            cursor.execute("select * from globalchs where name=?",("é˜²ç½æƒ…å ±",))
            chs = cursor.fetchone()
            es = message.embeds
            sed=[]
            for e in es:
                e.color = ec
                e.title = f'ğŸ’ {str(e.title).replace("Embed.Empty","é˜²ç½æƒ…å ±")}'
                sed.append(e)
            for chid in chs["ids"]:
                try:
                    ch = bot.get_channel(chid)
                    for wh in await ch.webhooks():
                        try:
                            if wh.name == "sina_global":
                                await wh.send(embeds=sed)
                                await asyncio.sleep(0.2)
                                break
                        except:
                            continue
                except:
                    pass
    #hash
    if not "hash" in gs["lockcom"]:
        ch=gs["hash"]
        if not ch is []:
            menchan = message.channel_mentions
            for sch in menchan:
                if sch.id in ch:
                    if message.channel.is_nsfw():
                        embed = discord.Embed(title="", description=f"ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°æŠ•ç¨¿\nNSFWãƒãƒ£ãƒ³ãƒãƒ«ã®æŠ•ç¨¿ã«ã¤ãã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯éš ã•ã‚Œã¦ã„ã¾ã™ã€‚", color=message.author.color)
                        embed.add_field(name="æŠ•ç¨¿å…ƒãƒãƒ£ãƒ³ãƒãƒ«", value=f"ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³:{message.channel.mention}\nåå‰:{message.channel.name}")
                        embed.add_field(name="ã“ã®æŠ•ç¨¿ã‚’è¦‹ã‚‹(see the post)", value=message.jump_url)
                        embed.set_author(name=message.author.display_name, icon_url=message.author.avatar_url_as(static_format='png'))
                    else:
                        embed = discord.Embed(title="", description=message.content, color=message.author.color)
                        embed.add_field(name="æŠ•ç¨¿å…ƒãƒãƒ£ãƒ³ãƒãƒ«", value=f"ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³:{message.channel.mention}\nåå‰:{message.channel.name}")
                        embed.add_field(name="ã“ã®æŠ•ç¨¿ã‚’è¦‹ã‚‹(see the post)", value=message.jump_url)
                        embed.set_author(name=message.author.display_name, icon_url=message.author.avatar_url_as(static_format='png'))
                        if not message.attachments == [] and (not message.attachments[0].is_spoiler()):
                            embed.set_image(url=message.attachments[0].url)
                    await sch.send(embed=embed)
    

async def dlevel(message,gs):
    if "clevel" in gs["lockcom"]:
        return
    if message.author.bot:
        return
    if gs["levels"].get(str(message.author.id),None) is None:
        gs["levels"][str(message.author.id)]={
            "level":0,
            "exp":random.randint(5,15),
            "lltime":int(time.time()),
            "dlu":True
        }
        cursor.execute("UPDATE guilds SET levels = ? WHERE id = ?", (gs["levels"],message.guild.id))
    else:
        if gs["levels"][str(message.author.id)]["dlu"]:
            if (int(time.time())-gs["levels"][str(message.author.id)]["lltime"]) >= 60:
                gs["levels"][str(message.author.id)]["lltime"]=int(time.time())
                gs["levels"][str(message.author.id)]["exp"] += random.randint(5,15)
                if gs["levels"][str(message.author.id)]["exp"] >= gs["levels"][str(message.author.id)]["level"] ** 3 + 20:
                    gs["levels"][str(message.author.id)]["exp"] -= gs["levels"][str(message.author.id)]["level"] ** 3 + 20
                    gs["levels"][str(message.author.id)]["level"] += 1
                    aut = str(message.author).replace("\\","\\\\").replace("*","\*").replace("_","\_").replace("|","\|").replace("~","\~").replace("`","\`").replace(">","\>")
                    if gs["levelupsendto"]:
                        c=bot.get_channel(gs["levelupsendto"])
                        try:
                            m = await c.send(str(bot.get_emoji(653161518212448266))+textto("levelup-notify",message.author).format(aut,gs["levels"][str(message.author.id)]["level"]))
                            await asyncio.sleep(1)
                            await m.edit(content=str(bot.get_emoji(653161518212448266))+textto("levelup-notify",message.author).format(message.author.mention,gs["levels"][str(message.author.id)]["level"]))
                        except:
                            pass
                    else:
                        try:
                            m = await message.channel.send(str(bot.get_emoji(653161518212448266))+textto("levelup-notify",message.author).format(aut,gs["levels"][str(message.author.id)]["level"]))
                            await asyncio.sleep(1)
                            await m.edit(content=str(bot.get_emoji(653161518212448266))+textto("levelup-notify",message.author).format(message.author.mention,gs["levels"][str(message.author.id)]["level"]))
                        except:
                            pass
                    if gs["reward"].get(str(gs["levels"][str(message.author.id)]["level"]),None):
                        rl = message.guild.get_role(gs["reward"][str(gs["levels"][str(message.author.id)]["level"])])
                        await message.author.add_roles(rl)
                cursor.execute("UPDATE guilds SET levels = ? WHERE id = ?", (gs["levels"],message.guild.id))

@bot.command()
async def userprefix(ctx,mode="view",ipf=""):
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    if mode=="view":
        await ctx.send(embed=getEmbed("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®prefix",f'```{",".join(upf["prefix"])}```'))
    elif mode=="set":
        spf = upf["prefix"]+[ipf]
        cursor.execute("UPDATE users SET prefix = ? WHERE id = ?", (spf,ctx.author.id))
        await ctx.send(textto("upf-add",ctx.author).format(ipf))
    elif mode=="del":
        spf = upf["prefix"]
        spf.remove(ipf)
        cursor.execute("UPDATE users SET prefix = ? WHERE id = ?", (spf,ctx.author.id))
        await ctx.send(f"prefixã‹ã‚‰{ipf}ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚")
    else:
        await ctx.send(embed=getEmbed("ä¸é©åˆ‡ãªãƒ¢ãƒ¼ãƒ‰é¸æŠ","`view`ã¾ãŸã¯`set`ã¾ãŸã¯`del`ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚"))

@bot.command()
async def ping(ctx):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    startt = time.time()
    mes = await ctx.send("please wait")
    await mes.edit(content=str(round(time.time()-startt,3)*1000)+"ms")

@bot.command()
@commands.is_owner()
async def cu(ctx):
    await ctx.send("see you...")
    await bot.close()

@bot.command(name="level",aliases=["ãƒ¬ãƒ™ãƒ«ã‚«ãƒ¼ãƒ‰", "ãƒ¬ãƒ™ãƒ«ã‚’è¦‹ã›ã¦"])
@commands.cooldown(1, 20, type=commands.BucketType.user)
async def level(ctx, tu:commands.MemberConverter=None):
    if tu:
        u = tu
    else:
        u =  ctx.author
    LEVEL_FONT = "meiryo.ttc"
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if ctx.channel.permissions_for(ctx.guild.me).attach_files == True:
        cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
        gs=cursor.fetchone()
        level=gs["levels"]
        if level.get(str(u.id),None) is None:
            await ctx.send(textto("level-notcount",ctx.author))
        else:
            async with ctx.message.channel.typing():
                nowl = level[str(u.id)]['level']
                exp = level[str(u.id)]['exp']
                nextl = nowl ** 3 + 20
                tonextexp = nextl - exp
                nextl = str(nextl)
                tonextexp = str(tonextexp)
                try:
                    r = requests.get(u.avatar_url_as(static_format="png"), stream=True)
                    if r.status_code == 200:
                        with open("usericon.png", 'wb') as f:
                            f.write(r.content)
                    dlicon = Image.open('usericon.png', 'r')
                except:
                    dlicon = Image.open('noimg.png', 'r')
                dlicon = dlicon.resize((100, 100))
                cursor.execute("select * from users where id=?",(u.id,))
                c = cursor.fetchone()
                cb=c["levcard"] or "m@jiâ˜†"
                cv = Image.open(cb+'.png','r')
                cv.paste(dlicon, (200, 10))
                dt = ImageDraw.Draw(cv)
                fonta = ImageFont.truetype(LEVEL_FONT, 30)
                fontb = ImageFont.truetype(LEVEL_FONT, 42)
                fontc = ImageFont.truetype(LEVEL_FONT, 20)
                if len(u.display_name) > 11:
                    etc = "â€¦"
                else:
                    etc = ""
                if cb=="kazuta123-a" or cb=="kazuta123-b" or cb=="kazuta123-c" or cb=="tomohiro0405":
                    dt.text((300, 60), u.display_name[0:10] +etc, font=fonta, fill='#ffffff')

                    dt.text((50, 110), textto("lc-level",u)+str(level[str(u.id)]['level']) , font=fontb, fill='#ffffff')

                    dt.text((50, 170), textto("lc-exp",u) + str(level[str(u.id)]['exp'])+"/"+nextl , font=fonta, fill='#ffffff')

                    dt.text((50, 210), textto("lc-next",u)+tonextexp , font=fontc, fill='#ffffff')

                    dt.text((50, 300), textto("lc-createdby",u).format(cb.replace("m@jiâ˜†","ãŠã‚ãš").replace("kazuta123","kazuta246").replace("-a","").replace("-b","").replace("-c","")) , font=fontc, fill='#ffffff')
                else:
                    dt.text((300, 60), u.display_name[0:10] +etc, font=fonta, fill='#000000')

                    dt.text((50, 110), textto("lc-level",u)+str(level[str(u.id)]['level']) , font=fontb, fill='#000000')

                    dt.text((50, 170), textto("lc-exp",u) + str(level[str(u.id)]['exp'])+"/"+nextl , font=fonta, fill='#000000')

                    dt.text((50, 210), textto("lc-next",u)+tonextexp , font=fontc, fill='#000000')

                    dt.text((50, 300), textto("lc-createdby",u).format(cb.replace("m@jiâ˜†","ãŠã‚ãš").replace("kazuta123","kazuta246").replace("-a","").replace("-b","").replace("-c","")) , font=fontc, fill='#000000')

                cv.save("sina'slevelcard.png", 'PNG') 
            await ctx.send(file=discord.File("sina'slevelcard.png"))
    else:
        try:
            await ctx.send(embed=discord.Embed(title=textto("dhaveper",ctx.author),description=textto("per-sendfile",ctx.author)))
        except:
             await ctx.send(f"{textto('dhaveper',ctx.author)}\n{textto('per-sendfile',ctx.author)}")           


@bot.command(name="serverinfo")
async def ginfo(ctx):
    if ctx.guild.id in [i[0] for i in partnerg]:
        ptn="ğŸ”—ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼:"
    else:
        ptn=""
    page = 0
    e =discord.Embed(title=textto("ginfo-ov-title",ctx.author),color=ec)
    e.set_author(name=f"{ptn}{ctx.guild.name}",icon_url=ctx.guild.icon_url_as(static_format='png'))
    e.add_field(name=textto("ginfo-region",ctx.author),value=ctx.guild.region)
    e.add_field(name=textto("ginfo-afkch",ctx.author),value=ctx.guild.afk_channel)
    if ctx.guild.afk_channel:
        e.add_field(name=textto("ginfo-afktout",ctx.author),value=f"{ctx.guild.afk_timeout/60}min")
    else:
        e.add_field(name=textto("ginfo-afktout",ctx.author),value=textto("ginfo-afknone",ctx.author))
    e.add_field(name=textto("ginfo-sysch",ctx.author),value=ctx.guild.system_channel)
    e.add_field(name=textto("ginfo-memjoinnotif",ctx.author),value=ctx.guild.system_channel_flags.join_notifications)
    e.add_field(name=textto("ginfo-serverboostnotif",ctx.author),value=ctx.guild.system_channel_flags.premium_subscriptions)
    if ctx.guild.default_notifications == discord.NotificationLevel.all_messages:
        e.add_field(name=textto("ginfo-defnotif",ctx.author),value=textto("ginfo-allmsg",ctx.author))
    else:
        e.add_field(name=textto("ginfo-defnotif",ctx.author),value=textto("ginfo-omention",ctx.author))
    if "INVITE_SPLASH" in ctx.guild.features:
        e.add_field(name="æ‹›å¾…ã®ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ç”»åƒ",value="ä¸‹ã«è¡¨ç¤º")
        e.set_image(url=ctx.guild.splash_url_as(format="png"))
    if "BANNER" in ctx.guild.features:
        e.add_field(name="ã‚µãƒ¼ãƒãƒ¼ãƒãƒŠãƒ¼",value="å³ä¸Šã«è¡¨ç¤º")
        e.set_thumbnail(url=ctx.guild.banner_url_as(format="png"))
    mp = await ctx.send(embed=e)
    await mp.add_reaction(bot.get_emoji(653161518195671041))
    await mp.add_reaction(bot.get_emoji(653161518170505216))
    while True:
        try:
            r, u = await bot.wait_for("reaction_add", check=lambda r,u: r.message.id==mp.id and u.id == ctx.message.author.id,timeout=30)
        except:
            break
        try:
            await mp.remove_reaction(r,u)
        except:
            pass
        if str(r) == str(bot.get_emoji(653161518170505216)):
            if page == 11:
                page = 0
            else:
                page = page + 1
        elif str(r) == str(bot.get_emoji(653161518195671041)):
            if page == 0:
                page = 11
            else:
                page = page - 1
        try:
            if page == 0:
                #æ¦‚è¦
                e =discord.Embed(title=textto("ginfo-ov-title",ctx.author),color=ec)
                e.set_author(name=f"{ptn}{ctx.guild.name}",icon_url=ctx.guild.icon_url_as(static_format='png'))
                e.add_field(name=textto("ginfo-region",ctx.author),value=ctx.guild.region)
                e.add_field(name=textto("ginfo-afkch",ctx.author),value=ctx.guild.afk_channel)
                if ctx.guild.afk_channel:
                    e.add_field(name=textto("ginfo-afktout",ctx.author),value=f"{ctx.guild.afk_timeout/60}min")
                else:
                    e.add_field(name=textto("ginfo-afktout",ctx.author),value=textto("ginfo-afknone",ctx.author))
                e.add_field(name=textto("ginfo-sysch",ctx.author),value=ctx.guild.system_channel)
                e.add_field(name=textto("ginfo-memjoinnotif",ctx.author),value=ctx.guild.system_channel_flags.join_notifications)
                e.add_field(name=textto("ginfo-serverboostnotif",ctx.author),value=ctx.guild.system_channel_flags.premium_subscriptions)
                if ctx.guild.default_notifications == discord.NotificationLevel.all_messages:
                    e.add_field(name=textto("ginfo-defnotif",ctx.author),value=textto("ginfo-allmsg",ctx.author))
                else:
                    e.add_field(name=textto("ginfo-defnotif",ctx.author),value=textto("ginfo-omention",ctx.author))
                if "INVITE_SPLASH" in ctx.guild.features:
                    e.add_field(name="æ‹›å¾…ã®ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ç”»åƒ",value="ä¸‹ã«è¡¨ç¤º")
                    e.set_image(url=ctx.guild.splash_url_as(format="png"))
                if "BANNER" in ctx.guild.features:
                    e.add_field(name="ã‚µãƒ¼ãƒãƒ¼ãƒãƒŠãƒ¼",value="å³ä¸Šã«è¡¨ç¤º")
                    e.set_thumbnail(url=ctx.guild.banner_url_as(format="png"))
                await mp.edit(embed=e)
            elif page == 1:
                #ç®¡ç†
                e = discord.Embed(title=textto("ginfo-manage",ctx.author),color=ec)
                if ctx.guild.verification_level == discord.VerificationLevel.none:
                    e.add_field(name=textto("ginfo-vlevel",ctx.author),value=textto("ginfo-vlnone",ctx.author))
                elif ctx.guild.verification_level == discord.VerificationLevel.low:
                    e.add_field(name=textto("ginfo-vlevel",ctx.author),value=textto("ginfo-vl1",ctx.author))
                elif ctx.guild.verification_level == discord.VerificationLevel.medium:
                    e.add_field(name=textto("ginfo-vlevel",ctx.author),value=textto("ginfo-vl2",ctx.author))
                elif ctx.guild.verification_level == discord.VerificationLevel.high:
                    e.add_field(name=textto("ginfo-vlevel",ctx.author),value=textto("ginfo-vl3",ctx.author))
                elif ctx.guild.verification_level == discord.VerificationLevel.extreme:
                    e.add_field(name=textto("ginfo-vlevel",ctx.author),value=textto("ginfo-vl4",ctx.author))
                if ctx.guild.explicit_content_filter == discord.ContentFilter.disabled:
                    e.add_field(name=textto("ginfo-filter",ctx.author),value=textto("ginfo-fnone",ctx.author))
                elif ctx.guild.explicit_content_filter == discord.ContentFilter.no_role:
                    e.add_field(name=textto("ginfo-filter",ctx.author),value=textto("ginfo-f1",ctx.author))
                elif ctx.guild.explicit_content_filter == discord.ContentFilter.all_members:
                    e.add_field(name=textto("ginfo-filter",ctx.author),value=textto("ginfo-f2",ctx.author))
                await mp.edit(embed=e)
            elif page == 2:
                #roles
                if ctx.author.guild_permissions.manage_roles or ctx.author.id == 404243934210949120:
                    rl = ctx.guild.roles[::-1]
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-roles",ctx.author),description="\n".join([str(i) for i in rl]),color=ec))
                else:
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-roles",ctx.author),description=textto("ginfo-cantview",ctx.author),color=ec))
            elif page == 3:
                #emoji
                ejs=""
                for i in ctx.guild.emojis:
                    if len( ejs + "," + str(i) ) >=1998:
                        ejs=ejs+"ãªã©"
                        break
                    else:
                        ejs=ejs + "," + str(i)
                await mp.edit(embed=discord.Embed(title=textto("ginfo-emoji",ctx.author),description=ejs,color=ec))
            elif page == 4:
                #webhooks
                if ctx.author.guild_permissions.manage_webhooks or ctx.author.id == 404243934210949120:
                    await mp.edit(embed=discord.Embed(title="webhooks",description="\n".join([f"{i.name},[link]({i.url}),created by {i.user}" for i in await ctx.guild.webhooks()]),color=ec))
                else:
                    await mp.edit(embed=discord.Embed(title="webhooks",description=textto("ginfo-cantview",ctx.author),color=ec))
            elif page == 5:
                #ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
                if ctx.author.guild_permissions.manage_guild or ctx.author.id == 404243934210949120:
                    try:
                        wdt = await ctx.guild.widget()
                        await mp.edit(embed=discord.Embed(title=textto("ginfo-widget",ctx.author),description=f"URL: {wdt.json_url}",color=ec))
                    except:
                        await mp.edit(embed=discord.Embed(title=textto("ginfo-widget",ctx.author),description=textto("ginfo-ctuw",ctx.author),color=ec))
                else:
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-widget",ctx.author),description=textto("ginfo-cantview",ctx.author),color=ec))
            elif page == 6:
                #Nitro server boost
                e = discord.Embed(title=str(bot.get_emoji(653161518971617281))+"Nitro Server Boost",description=f"Level:{ctx.guild.premium_tier}\n({ctx.guild.premium_subscription_count})",color=ec)
                e.add_field(name=textto("ginfo-bst-add",ctx.author),value=textto(f"ginfo-blev{ctx.guild.premium_tier}",ctx.author))
                await mp.edit(embed=e)
            elif page == 7:
                #member
                vml=textto("ginfo-strlenover",ctx.author)
                if len("\n".join([f"{str(i)}" for i in ctx.guild.members])) <= 1024:
                    vml = "\n".join([f"{str(i)}" for i in ctx.guild.members]).replace(str(ctx.guild.owner),f"ğŸ‘‘{str(ctx.guild.owner)}")
                await mp.edit(embed=discord.Embed(title="member",description=f"member count:{len(ctx.guild.members)}\n```"+vml+"```"),color=ec)
            elif page == 8:
                if ctx.author.guild_permissions.manage_guild or ctx.author.id == 404243934210949120:
                    try:
                        vi = await ctx.guild.vanity_invite()
                        vi = vi.code
                    except:
                        vi = "NF_VInvite"
                    #invites
                    vil = textto("ginfo-strlenover",ctx.author)
                    if len("\n".join([f"{i.code},åˆ©ç”¨æ•°:{i.uses}/{i.max_uses},ä½œæˆè€…:{i.inviter}" for i in await ctx.guild.invites()])) <= 1023:
                        vil = "\n".join([f"{i.code},åˆ©ç”¨æ•°:{i.uses}/{i.max_uses},ä½œæˆè€…:{i.inviter}" for i in await ctx.guild.invites()]).replace(vi,f"{bot.get_emoji(653161518103265291)}{vi}")
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-invites",ctx.author),description=vil),color=ec)
                else:
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-invites",ctx.author),description=textto("ginfo-cantview",ctx.author),color=ec))
            elif page == 9:
                if ctx.author.guild_permissions.ban_members or ctx.author.id == 404243934210949120:
                    #ban_user 
                    vbl=textto("ginfo-strlenover",ctx.author)
                    bl = []
                    for i in await ctx.guild.bans():
                        bl.append(f"{i.user},reason:{i.reason}")
                    if len("\n".join(bl)) <= 1024:
                        vbl = "\n".join(bl)
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-banneduser",ctx.author),description=vbl),color=ec)
                else:
                    await mp.edit(embed=discord.Embed(title=textto("ginfo-banneduser",ctx.author),description=textto("ginfo-cantview",ctx.author),color=ec))
            elif page == 10:
                #ã‚µãƒ¼ãƒãƒ¼ã®ãƒãƒ£ãƒ³ãƒãƒ«
                e =discord.Embed(title="ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§",color=ec)
                for mct,mch in ctx.guild.by_category():
                    chs="\n".join([i.name for i in mch])
                    e.add_field(name=str(mct).replace("None","ã‚«ãƒ†ã‚´ãƒªãƒ¼ãªã—"),value=f"```{chs}```",inline=True)
                await mp.edit(embed=e)
            elif page == 11:
                cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
                gs = cursor.fetchone()
                e =discord.Embed(title="other",color=ec)
                e.add_field(name="owner",value=ctx.guild.owner.mention)
                e.add_field(name="features",value=f"```{','.join(ctx.guild.features)}```")
                e.add_field(name=textto("ginfo-sinagprofile",ctx.author),value=textto("ginfo-gprodesc",ctx.author).format(gs["reward"],gs["sendlog"],gs["prefix"],gs["lang"],))
                await mp.edit(embed=e)
        except:
            await mp.edit(embed=discord.Embed(title=textto("ginfo-anyerror-title",ctx.author),description=textto("ginfo-anyerror-desc",ctx.author).format(traceback.format_exc(0)),color=ec))


@bot.command(aliases=["ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã®è‰²ã‚’å¤‰ãˆã‚‹"])
async def globalcolor(ctx,color='0x000000'):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("UPDATE users SET gcolor = ? WHERE id = ?", (int(color,16),ctx.author.id))
    await ctx.send(textto("global-color-changed",ctx.message.author))

@bot.command(aliases=["ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å¤‰ãˆã‚‹"])
async def globalnick(ctx,nick):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if 1<len(nick)<29:
        cursor.execute("UPDATE users SET gnick = ? WHERE id = ?", (nick,ctx.author.id))
        await ctx.send(textto("global-nick-changed",ctx.message.author))
    else:
        await ctx.send("åå‰ã®é•·ã•ã¯2æ–‡å­—ä»¥ä¸Š28æ–‡å­—ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„ã€‚")


@bot.command(aliases=["ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹","ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¦‹ã›ã¦"])
async def gprofile(ctx,uid:int=None):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if uid==None:
        cid = ctx.author.id
    else:
        cid = uid
    cursor.execute("select * from users where id=?",(cid,))
    upf = cursor.fetchone()
    embed = discord.Embed(title=textto("global-status-title",ctx.message.author).format(cid), description="", color=upf["gcolor"])
    embed.add_field(name="banned", value=upf["gban"])
    embed.add_field(name="nick", value=upf["gnick"])
    embed.add_field(name="color", value=str(upf["gcolor"]))
    embed.add_field(name="gmod", value=upf["gmod"])
    embed.add_field(name="tester", value=upf["galpha"])
    embed.add_field(name="star", value=upf["gstar"])
    embed.add_field(name="partner", value=upf["sinapartner"])
    await ctx.send(embed=embed)

@bot.command()
async def globalban(ctx,uid:int,ban:bool=True,rea="ãªã—"):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    if upf["gmod"] == True:
        cursor.execute("UPDATE users SET gban = ? WHERE id = ?", (int(ban),uid))
        await ctx.send(f"bançŠ¶æ…‹ã‚’{str(ban)}ã«ã—ã¾ã—ãŸã€‚")

@bot.command()
async def globaltester(ctx,uid,bl:bool=True):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    if upf["gmod"] == True:
        cursor.execute("UPDATE users SET galpha = ? WHERE id = ?", (int(bl),uid))
        await ctx.send(f"ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®ä½¿ç”¨ã‚’{str(bl)}ã«ã—ã¾ã—ãŸã€‚")

@bot.command()
@commands.is_owner()
async def globalmod(ctx,uid,bl:bool=True):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("UPDATE users SET gmod = ? WHERE id = ?", (int(bl),uid))
    await ctx.send(f"ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’{str(bl)}ã«ã—ã¾ã—ãŸã€‚")

@bot.command()
@commands.is_owner()
async def globalpartner(ctx,uid,bl:bool=True):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("UPDATE users SET sinapartner = ? WHERE id = ?", (int(bl),uid))
    await ctx.send(f"ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’{str(bl)}ã«ã—ã¾ã—ãŸã€‚")


@bot.command()
@commands.is_owner()
async def globalstar(ctx,uid,bl:bool=True):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("UPDATE users SET gstar = ? WHERE id = ?", (int(bl),uid))
    await ctx.send(f"ã‚¹ã‚¿ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’{str(bl)}ã«ã—ã¾ã—ãŸã€‚")

@bot.command()
async def globalguide(ctx):

    embed = discord.Embed(description=gguide, color=ec)
    await ctx.send(embed=embed)

def ondevicon(mem):
    tmp = ""
    if not str(mem.desktop_status)=="offline":
        tmp = tmp+"ğŸ’»"
    if not str(mem.mobile_status)=="offline":
        tmp = tmp+"ğŸ“±"
    if not str(mem.web_status)=="offline":
        tmp = tmp+"ğŸŒ"
    return tmp

@bot.command()
@commands.cooldown(1, 20, type=commands.BucketType.guild)
async def gdconnect(ctx):
    if ctx.author.permissions_in(ctx.channel).administrator == True or ctx.author.id == 404243934210949120:
        if ctx.channel.permissions_for(ctx.guild.me).manage_webhooks:
            cursor.execute("select * from globalchs")
            chs = cursor.fetchall()
            if chs !=None:
                for ch in chs:
                    if ctx.channel.id in ch["ids"]:
                        ch["ids"].remove(ctx.channel.id)
                        for wh in await ctx.guild.webhooks():
                            if wh.name == "sina_global":
                                wh.delete()
                        db.execute("UPDATE globalchs SET ids = ? WHERE name = ?", (ch["ids"],ch["name"]))
                        await ctx.send(textto("global-disconnect",ctx.message.author))
                        embed = discord.Embed(title="ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆåˆ‡æ–­é€šçŸ¥", description=f'{ctx.guild.name}ã®{ctx.channel.name}ãŒ`{ch["name"]}`ã‹ã‚‰åˆ‡æ–­ã—ã¾ã—ãŸã€‚')
                        for cid in ch["ids"]:
                            channel=bot.get_channel(cid)
                            try:
                                await channel.send(embed=embed)
                            except:
                                pass
                        return
            await ctx.send("ã“ã“ã¯ã©ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆã«ã‚‚æ¥ç¶šã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼")
        else:
            await ctx.send("webhooksã®ç®¡ç†æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ï¼")
    else:
        await ctx.send("ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ã“ã®ã‚µãƒ¼ãƒãƒ¼ã§ç®¡ç†è€…æ¨©é™ã‚’æŒã¤å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚")

@bot.command()
@commands.cooldown(1, 20, type=commands.BucketType.guild)
async def gconnect(ctx,name:str="main",dnf:bool=True):
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    if upf["gban"] == 1:
        await ctx.send("ã‚ãªãŸã¯ä½¿ç”¨ç¦æ­¢ãªã®ã§ã‚³ãƒã‚¯ãƒˆã¯ä½¿ãˆã¾ã›ã‚“ã€‚")
        return
    if ctx.author.permissions_in(ctx.channel).administrator == True or ctx.author.id == 404243934210949120:
        if ctx.channel.permissions_for(ctx.guild.me).manage_webhooks:
            cursor.execute("select * from globalchs")
            chs = cursor.fetchall()
            if chs !=None:
                for ch in chs:
                    if ctx.channel.id in ch["ids"]:
                        await ctx.send(f"ã“ã®ãƒãƒ£ãƒ³ãƒãƒ«ã¯æ—¢ã«`{ch['name']}`ã«æ¥ç¶šã•ã‚Œã¦ã„ã¾ã™ï¼")
                        return
            cursor.execute("select * from globalchs where name=?",(name,))
            chs=cursor.fetchone()
            if chs is None:
                try:
                    ctg = bot.get_guild(560434525277126656).get_channel(582489567840436231)
                    cch = await ctg.create_text_channel(f'gch-{name}')
                    await cch.create_webhook(name="sina_global",avatar=None)
                    cursor.execute("INSERT INTO globalchs(name,ids) VALUES(?,?)",(name,[ctx.channel.id,cch.id]))
                except:
                    cursor.execute("INSERT INTO globalchs(name,ids) VALUES(?,?)",(name,[ctx.channel.id]))
            else:
                db.execute("UPDATE globalchs SET ids = ? WHERE name = ?", (chs["ids"]+[ctx.channel.id],name))
            await ctx.channel.create_webhook(name="sina_global",avatar=None)
            if dnf:
                embed = discord.Embed(title=f"{bot.get_emoji(653161518174699541)}ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆæ¥ç¶šé€šçŸ¥", description=f'{ctx.guild.name}ã®{ctx.channel.name}ãŒ`{name}`ã«æ¥ç¶šã—ã¾ã—ãŸã€‚')
            else:
                embed = discord.Embed(title="ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒƒãƒˆæ¥ç¶šé€šçŸ¥", description=f'{bot.get_emoji(653161518174699541)}ã©ã“ã‹ãŒ`{name}`ã«æ¥ç¶šã—ã¾ã—ãŸã€‚')
            cursor.execute("select * from globalchs where name=?",(name,))
            ch = cursor.fetchone()
            for cid in ch["ids"]:
                channel=bot.get_channel(cid)
                try:
                    await channel.send(embed=embed)
                except:
                    pass
        else:
            await ctx.send("webhooksã®ç®¡ç†æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ï¼")
    else:
        await ctx.send("ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ã“ã®ã‚µãƒ¼ãƒãƒ¼ã§ç®¡ç†è€…æ¨©é™ã‚’æŒã¤å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚")

@bot.command()
@commands.cooldown(1, 30, type=commands.BucketType.user)
async def globaldel(ctx,gmid:int,gchn:str):
    cursor.execute("select * from globalchs where name = ?",(gchn,))
    ch = cursor.fetchone()
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    post=None
    cursor.execute("select * from globaldates")
    dats = cursor.fetchall()
    if upf["gmod"]:
        for i in dats:
            if gmid in i["allid"]:
                post = i
        if post:
            for cid in ch["ids"]:
                ch = bot.get_channel(cid)
                for mid in post["allid"]:
                    try:
                        m = await ch.fetch_message(mid)
                        await m.delete()
                    except:
                        pass
        await ctx.send("å‰Šé™¤ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")

@bot.command()
async def viewgban(ctx):
    cursor.execute("select * from users")
    upf = cursor.fetchall()
    if upf["gmod"]:
        async with ctx.message.channel.typing():
            blist = []
            for i in upf:
                if i["gban"] == True:
                    bu = await bot.fetch_user(i["id"])
                    blist.append(f"ãƒ¦ãƒ¼ã‚¶ãƒ¼å:{bu},è¡¨ç¤ºå:{i['gnick']},id:{i['id']}")
            embed=discord.Embed(title=f"banã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸€è¦§({len(blist)}å)",description="```\n{0}```".format('\n'.join(blist)),color=ec)
        await ctx.send(embed=embed)

@bot.command(aliases=["ä¸€å®šæ™‚é–“å‰Šé™¤"])
async def timemsg(ctx,sec:float):
    await asyncio.sleep(sec)
    await ctx.message.delete()

@bot.command()
async def rg(ctx,cou:int,role:commands.RoleConverter=None):

    if role is None:
        role = ctx.guild.default_role
    if cou >= 1:
        ml = [m.mention for m in role.members if not m.bot]
        ogl = []
        gl = []
        tmp = "hoge"
        while len(ml) >= cou:
            for i in range(cou):
                tmp = random.choice(ml)
                ogl.append(tmp)
                ml.remove(tmp)
            gl.append(ogl)
            ogl=[]
            tmp = "hoge"
        gtxt = "\n".join([f"{'ã¨'.join(m)}" for m in gl])
        ng = ",".join(ml)
        await ctx.send(embed=discord.Embed(title=textto("rg-title",ctx.author),description=textto("rg-desc",ctx.author).format(gtxt,ng), color=ec))
    else:
        await ctx.send(textto("rg-block",ctx.author))

@bot.command()
async def anyuserinfo(ctx,*,uid:int=None):
    if uid:
        try:
            u=await bot.fetch_user(uid)
        except discord.NotFound:
            await ctx.send(textto("aui-nf",ctx.author))
        except discord.HTTPException:
            await ctx.send(textto("aui-he",ctx.author))
        except:
            await ctx.send(textto("aui-othere",ctx.author).format(traceback.format_exc()))
        else:
            if u.id in [i[1] for i in partnerg]:
                ptn=":ğŸ”—ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚ªãƒ¼ãƒŠãƒ¼"
            else:
                ptn=""
            e = discord.Embed(title=f"{textto('aui-uinfo',ctx.author)}{ptn}",color=ec)
            e.add_field(name=textto("aui-name",ctx.author),value=u.name)
            e.add_field(name=textto("aui-id",ctx.author),value=u.id)
            e.add_field(name=textto("aui-dr",ctx.author),value=u.discriminator)
            e.add_field(name=textto("aui-isbot",ctx.author),value=u.bot)
            e.set_thumbnail(url=u.avatar_url)
            e.set_footer(text=textto("aui-created",ctx.author).format(u.created_at))
            e.timestamp = u.created_at
        await ctx.send(embed=e)
    else:
        await ctx.send(textto("aui-nid",ctx.author))

@bot.command()
@commands.cooldown(2, 10, type=commands.BucketType.user)
async def wid(ctx,inid):
    if not textto("language",ctx.author) == "ja":
        await ctx.send(textto("cannot-run",ctx.author))
        return

    async with ctx.message.channel.typing():
        st = time.time()
        try:
            id = int(inid)
        except:
            id = None
        idis = bot.get_channel(id)
        if idis:
            if isinstance(idis,discord.DMChannel):
                await ctx.send(embed=getEmbed("DMãƒãƒ£ãƒ³ãƒãƒ«",f"ç›¸æ‰‹:{idis.recipient}"))
            elif isinstance(idis,discord.GroupChannel):
                await ctx.send(embed=getEmbed("ã‚°ãƒ«ãƒ¼ãƒ—DMãƒãƒ£ãƒ³ãƒãƒ«",f"ãƒ¡ãƒ³ãƒãƒ¼:{','.join(idis.recipients)},\nåå‰:{idis.name},"))
            elif isinstance(idis,discord.abc.GuildChannel):
                await ctx.send(embed=getEmbed("ã‚µãƒ¼ãƒãƒ¼ãƒãƒ£ãƒ³ãƒãƒ«",f"åå‰:{idis.name}\nã‚µãƒ¼ãƒãƒ¼:{idis.guild}"))
            else:
                await ctx.send(embed=getEmbed("ãã®ä»–ãƒãƒ£ãƒ³ãƒãƒ«"))
            return
        idis = bot.get_guild(id)
        if idis:
            if idis.id in [i[0] for i in partnerg]:
                ptn="ğŸ”—ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼"
            else:
                ptn=""
            await ctx.send(embed=getEmbed("ã‚µãƒ¼ãƒãƒ¼",f"{ptn}\nåå‰:{idis.name}\nid:{idis.id}"))
            return
        try:
            idis = await bot.fetch_user(id)
            u=idis
            e = discord.Embed(title="ãƒ¦ãƒ¼ã‚¶ãƒ¼",color=ec)
            e.add_field(name="åå‰",value=u.name)
            e.add_field(name="id",value=u.id)
            e.add_field(name="ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒŸãƒãƒ¼ã‚¿",value=u.discriminator)
            e.add_field(name="botã‹ã©ã†ã‹",value=u.bot)
            e.set_thumbnail(url=u.avatar_url)
            e.set_footer(text=f"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ—¥æ™‚(ãã®ã¾ã¾ã®å€¤:{u.created_at},ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—åŒ–:")
            e.timestamp = u.created_at
            await ctx.send(embed=e)
            return
        except:
            pass
        idis = bot.get_emoji(id)
        if idis:
            await ctx.send(embed=getEmbed("çµµæ–‡å­—",f"åå‰:{str(idis)}\nid:{idis.id}"))
            return
        try:
            idis = await bot.fetch_invite(inid)
            await ctx.send(embed=getEmbed("ã‚µãƒ¼ãƒãƒ¼æ‹›å¾…",f"åå‰:{str(idis.guild.name)}\nãƒãƒ£ãƒ³ãƒãƒ«:{idis.channel.name}\nmember_count:{idis.approximate_member_count}\npresence_count:{idis.approximate_presence_count}\n[å‚åŠ ]({idis.url})"))
            return
        except:
            pass
        try:
            idis = await bot.fetch_webhook(id)
            await ctx.send(embed=getEmbed("webhook",f"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒ :{idis.name}\nã‚µãƒ¼ãƒãƒ¼id:{idis.guild_id}"))
            return
        except:
            pass
        try:
            idis = await bot.fetch_widget(inid)
            await ctx.send(embed=getEmbed("ã‚µãƒ¼ãƒãƒ¼ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ",f"åå‰:{idis.name}\næ‹›å¾…:{idis.invite_url}"))
            return
        except:
            pass
        try:
            for g in bot.guilds:
                for ch in g.text_channels:
                    try:
                        idis = await ch.fetch_message(id)
                        await ctx.send(embed=getEmbed("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",f"é€ä¿¡è€…:{idis.author}\nå†…å®¹:{idis.content}"))
                        return
                    except:
                        pass
                    finally:
                        await asyncio.sleep(0.5)
        except:
            pass
        await ctx.send(embed=getEmbed("ãã®idã§ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚",""))

async def wait_message_return(ctx,stext,sto,tout=60):
    await sto.send(stext)
    return await bot.wait_for('message', check=lambda m: m.author==ctx.author and m.channel==sto,timeout=tout)

@bot.command(name="textlocker")
async def textlocker(ctx):
    if not textto("language",ctx.author) == "ja":
        await ctx.send(textto("cannot-run",ctx.author))
        return

    dc = await opendm(ctx.author)
    askmd=await dc.send(embed=getEmbed("ãƒ†ã‚­ã‚¹ãƒˆæš—å·ãƒ»è¤‡åˆ","æš—å·åŒ–ã™ã‚‹å ´åˆã¯ğŸ”’ã‚’ã€å¾©å·ã™ã‚‹å ´åˆã¯ğŸ”“ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚"))
    await askmd.add_reaction('ğŸ”’')
    await askmd.add_reaction('ğŸ”“')
    try:
        r,u= await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) in ["ğŸ”’","ğŸ”“"] and r.message.id==askmd.id and u.bot==False,timeout=60)
    except asyncio.TimeoutError:
        await ctx.send("ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚åˆã‚ã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚")
        return
    if str(r.emoji) == "ğŸ”’":
        setting={}
        rtxt = await wait_message_return(ctx,"æš—å·åŒ–ã™ã‚‹æ–‡ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["text"] = rtxt.content.lower()
        rtxt = await wait_message_return(ctx,"å§‹ã‚ã®ãšã‚‰ã—ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["zs"] = int(rtxt.content)
        rtxt = await wait_message_return(ctx,"ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å¤‰ãˆã‚‹ã¾ã§ã®æ•°ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["cp"] = int(rtxt.content)
        rtxt = await wait_message_return(ctx,"å¤‰ãˆã‚‹ã¨ãã®ãšã‚‰ã™æ•°ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["cpt"] = int(rtxt.content)
        rtext = ""
        tcount = 0
        zcount = 0
        uzs = setting["zs"]
        while tcount <= len(setting["text"])-1:
            zcount = zcount + 1
            ztmp = tl.find(setting["text"][tcount])
            if not ztmp == -1:
                if ztmp+uzs >= len(tl):
                    rtext = f"{rtext}{tl[ztmp+uzs-len(tl)]}"
                else:
                    rtext = f"{rtext}{tl[ztmp+uzs]}"
                if zcount == setting["cp"]:
                    uzs = uzs + setting["cpt"]
                    zcount = 0
            else:
                rtext = f"{rtext}â˜’"
            tcount = tcount + 1
        await dc.send(f"`{rtext}`ã«ãªã‚Šã¾ã—ãŸã€‚")
    elif str(r.emoji) == "ğŸ”“":
        setting={}
        rtxt = await wait_message_return(ctx,"å¾©å·ã™ã‚‹æ–‡ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["text"] = rtxt.content
        rtxt = await wait_message_return(ctx,"å§‹ã‚ã®ãšã‚‰ã—ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["zs"] = int(rtxt.content)
        rtxt = await wait_message_return(ctx,"ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å¤‰ãˆã‚‹ã¾ã§ã®æ•°ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["cp"] = int(rtxt.content)
        rtxt = await wait_message_return(ctx,"å¤‰ãˆã‚‹ã¨ãã®ãšã‚‰ã™æ•°ã‚’é€ã£ã¦ãã ã•ã„ã€‚",dc)
        setting["cpt"] = int(rtxt.content)
        rtext = ""
        tcount = 0
        zcount = 0
        uzs = setting["zs"]
        while tcount <= len(setting["text"])-1:
            zcount = zcount + 1
            ztmp = tl.find(setting["text"][tcount])
            if not ztmp == -1:
                if ztmp+uzs < 0:
                    rtext = f"{rtext}{tl[ztmp-uzs+len(tl)]}"
                else:
                    rtext = f"{rtext}{tl[ztmp-uzs]}"
                if zcount == setting["cp"]:
                    uzs = uzs + setting["cpt"]
                    zcount = 0
            else:
                rtext = f"{rtext}â˜’"
            tcount = tcount + 1
        await dc.send(f"`{rtext}`ã«ãªã‚Šã¾ã—ãŸã€‚")
    else:
        await ctx.send("çµµæ–‡å­—ãŒé•ã„ã¾ã™ã€‚")

@bot.command()
async def roletrans(ctx,gid:int):
    try:
        g = bot.get_guild(gid)
        if ctx.author.permissions_in(ctx.channel).administrator == True or ctx.author.id == 404243934210949120:
            async with ctx.channel.typing():
                for r in g.roles[1:][::-1]:
                    await ctx.guild.create_role(name=r.name,permissions=r.permissions,colour=r.colour,hoist=r.hoist,mentionable=r.mentionable,reason=f"{g.name}ã‚ˆã‚Šã€‚å½¹è·è»¢é€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã«ã‚ˆã‚‹ã€‚")
                    await asyncio.sleep(2)
            await ctx.send("å®Œäº†ã—ã¾ã—ãŸã€‚")
        else:
            await ctx.send("ã“ã®ã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚")
    except:
        await ctx.send(embed=getEmbed("ã‚¨ãƒ©ãƒ¼",f"è©³ç´°:```{traceback.format_exc(0)}```"))

@bot.command()
async def chtrans(ctx,gid:int):
    try:
        g = bot.get_guild(gid)
        if ctx.author.permissions_in(ctx.channel).administrator == True or ctx.author.id == 404243934210949120:
            async with ctx.channel.typing():
                #ã™ã‚‹ã“ã¨
                for mct,mch in g.by_category():
                    await asyncio.sleep(2)
                    try:
                        ct = await ctx.guild.create_category_channel(name=mct.name)
                    except AttributeError:
                        ct = None
                    for c in mch:
                        await asyncio.sleep(2)
                        if isinstance(c,discord.TextChannel):
                            await ctx.guild.create_text_channel(name=c.name,category=ct,topic=c.topic,slowmode_delay=c.slowmode_delay,nsfw=c.is_nsfw())
                        elif isinstance(c,discord.VoiceChannel):
                            await ctx.guild.create_voice_channel(name=c.name,category=ct,bitrate=c.bitrate,user_limit=c.user_limit)
                        else:
                            pass            
            await ctx.send("å®Œäº†ã—ã¾ã—ãŸã€‚")
        else:
            await ctx.send(textto("need-admin",ctx.author))
    except:
        await ctx.send(embed=getEmbed(textto("ginfo-anyerror-title",ctx.author),textto("ginfo-anyerror-title",ctx.author).format(traceback.format_exc(0))))

@bot.command()
async def levelupsendto(ctx,to):
    if to == "here":
        cursor.execute("UPDATE guilds SET levelupsendto = ? WHERE id = ?", ("here",ctx.guild.id))
    else:
        cursor.execute("UPDATE guilds SET levelupsendto = ? WHERE id = ?", (int(to),ctx.guild.id))
    await ctx.send(textto("changed",ctx.author))

@bot.command()
async def levelreward(ctx,lv:int,rl:commands.RoleConverter=None):
    rid = rl.id
    if not(ctx.author.permissions_in(ctx.channel).manage_guild == True and ctx.author.permissions_in(ctx.channel).manage_roles == True or ctx.author.id == 404243934210949120):
        await ctx.send(textto("need-admin",ctx.author))
        return
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    gs = cursor.fetchone()
    if rid is None:
        del gs["reward"][str(lv)]
    else:
        gs["reward"][str(lv)] = rid
    cursor.execute("UPDATE guilds SET reward = ? WHERE id = ?", (gs["reward"],ctx.guild.id))
    await ctx.send(textto("changed",ctx.author))

@bot.command()
async def memo(ctx,mode="a",mn="def",ctt=None):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    mmj = cursor.fetchone()
    if mode == "r":
        if not mmj["memo"] == None:
            if mmj["memo"].get(mn) == None:
                await ctx.send(textto("memo-r-notfound1",ctx.message.author))
            else:
                await ctx.send(mmj["memo"][mn])
        else:
            await ctx.send(textto("memo-r-notfound2",ctx.message.author))
    elif mode == "w":
        if ctt == None:
            mmj["memo"][mn] = None
        else:
            mmj["memo"][mn] = ctx.message.content.replace(f's-memo {mode} {mn} ',"")
        cursor.execute("UPDATE users SET memo = ? WHERE id = ?", (mmj["memo"],ctx.author.id))

        await ctx.send(textto("memo-w-write",ctx.message.author).format(str(mn)))
    elif mode == "a":
        if mmj["memo"] == {}:
            await ctx.send(textto("memo-a-notfound",ctx.message.author))
        else:
            await ctx.send(str(mmj["memo"].keys()).replace("dict_keys(",textto("memo-a-list",ctx.message.author)).replace(")",""))
    else:
        await ctx.send(textto("memo-except",ctx.message.author))

@bot.command(name="fish")
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def fishany(ctx):

    lt=["ğŸ¦‘","ğŸ¦","ğŸ™","ğŸ¦€","ğŸ¡","ğŸ ","ğŸŸ"] + [i.id for i in ctx.guild.emojis]
    fs = random.choice(lt)
    if str(type(fs)) == "<class 'int'>":
        fs = str(bot.get_emoji(fs))
    gp = random.randint(1,3)
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    cursor.execute("UPDATE users SET gpoint = ? WHERE id = ?", (gp,ctx.author.id))
    await ctx.send(embed=getEmbed("fish",textto("fish-get",ctx.author).format(fs,gp)))

@bot.command(aliases=["ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é€šçŸ¥"])
async def onlinenotif(ctx,mode,uid:int):
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    if mode=='add':
        upf["onnotif"].append(uid)
        db.execute("UPDATE users SET onnotif = ? WHERE id = ?", (upf["onnotif"],ctx.author.id))
        await ctx.send(textto("onnotif-set",ctx.message.author))
    elif mode =='del':
        upf["onnotif"].remove(uid)
        db.execute("UPDATE users SET onnotif = ? WHERE id = ?", (upf["onnotif"],ctx.author.id))
        await ctx.send(textto("onnotif-stop",ctx.message.author))
    else:
        await ctx.send(textto("onnotif-error",ctx.message.author))
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    await ctx.send(f"upf:{upf['onnotif']}")

@bot.command()
async def hash(ctx):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    d = cursor.fetchone()
    hc = d["hash"]
    if hc == None:
        d["hash"]=[ctx.channel.id]
        await ctx.send(textto("hash-connect",ctx.message.author))
    elif ctx.channel.id in hc:
        d["hash"].remove(ctx.channel.id)
        await ctx.send(textto("hash-disconnect",ctx.message.author))
    else:
        d["hash"].append(ctx.channel.id)
        await ctx.send(textto("hash-connect",ctx.message.author))
    cursor.execute("UPDATE guilds SET hash = ? WHERE id = ?", (d["hash"],ctx.guild.id))

@bot.command(aliases=["ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒãƒ³ãƒ‰","æ¬¡ã®æ¡ä»¶ã§ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒãƒ³ãƒ‰ã‚’é–‹ã"])
async def servercmd(ctx,mode="all",name=None):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    mmj = cursor.fetchone()
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if mode == "add":
            if not mmj["commands"].get(name,None) is None:
                 if not(ctx.author.permissions_in(ctx.channel).manage_guild == True and ctx.author.permissions_in(ctx.channel).manage_roles == True or ctx.author.id == 404243934210949120):
                     await ctx.send(textto("need-manage",ctx.author))
                     return
            dc = ctx.author.dm_channel
            if dc == None:
                await ctx.author.create_dm()
                dc = ctx.author.dm_channel
            
            emojis = ctx.guild.emojis

            se = [] 
            for e in emojis:
                se = se + [str(e)]
            
            await dc.send(textto("scmd-add-guide1",ctx.message.author))
            
            def check(m):
                return m.channel == dc and m.author == ctx.author

            msg = await bot.wait_for('message', check=check)
            if msg.content =="one":
                await dc.send(textto("scmd-add-guide2",ctx.message.author))
                mes = await bot.wait_for('message', check=check)
                guide=mes.content
                try:
                    await dc.send(textto("scmd-add-guide3-a",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),str(se)))
                except:
                    await dc.send(textto("scmd-add-guide3-a",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),"(çµµæ–‡å­—ãŒå¤šã™ãã¦è¡¨ç¤ºã§ãã¾ã›ã‚“ï¼)"))
                mg=await bot.wait_for('message', check=check)
                rep = mg.clean_content.format(se)
                mmj["commands"][name]={}
                mmj["commands"][name]["mode"]="one"
                mmj["commands"][name]["rep"]=rep
                mmj["commands"][name]["createdBy"]=ctx.author.name
                mmj["commands"][name]["guide"]=guide
            elif msg.content == "random":
                await dc.send(textto("scmd-add-guide2",ctx.message.author))
                mes = await bot.wait_for('message', check=check)
                guide=mes.content
                try:
                    await dc.send(textto("scmd-add-guide3-a",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),str(se)))
                except:
                    await dc.send(textto("scmd-add-guide3-a",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),"(çµµæ–‡å­—ãŒå¤šã™ãã¦è¡¨ç¤ºã§ãã¾ã›ã‚“ï¼)"))
                rep = []
                while True:
                    mg=await bot.wait_for('message', check=check)
                    if mg.content=="stop":
                        break
                    else:
                        rep = rep + [mg.clean_content.format(se)]
                        try:
                            await dc.send(textto("scmd-add-guide3-b",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),str(se)))
                        except:
                            await dc.send(textto("scmd-add-guide3-b",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),"(çµµæ–‡å­—ãŒå¤šã™ãã¦è¡¨ç¤ºã§ãã¾ã›ã‚“ï¼)"))
                mmj["commands"][name]={}
                mmj["commands"][name]["mode"]="random"
                mmj["commands"][name]["rep"]=rep
                mmj["commands"][name]["createdBy"]=ctx.author.name
                mmj["commands"][name]["guide"]=guide
            elif msg.content == "role":
                if ctx.author.permissions_in(ctx.channel).manage_guild == True and ctx.author.permissions_in(ctx.channel).manage_roles == True or ctx.author.id == 404243934210949120:
                    await dc.send(textto("scmd-add-guide2",ctx.message.author))
                    mes = await bot.wait_for('message', check=check)
                    guide=mes.content
                    await dc.send(textto("scmd-add-guide3-c",ctx.message.author).format(textto("scmd-guide-emoji",ctx.message.author),str(se)))
                    mg=await bot.wait_for('message', check=check)
                    rep = int(mg.clean_content)
                    mmj["commands"][name]={}
                    mmj["commands"][name]["mode"]="role"
                    mmj["commands"][name]["rep"]=rep
                    mmj["commands"][name]["createdBy"]=ctx.author.name
                    mmj["commands"][name]["guide"]=guide
                else:
                    await ctx.send(textto("need-manage",ctx.author))
                    return
            else:
                await dc.send(textto("scmd-add-not",ctx.message.author))
                return
            cursor.execute("UPDATE guilds SET commands = ? WHERE id = ?", (mmj["commands"],ctx.guild.id))
            await ctx.send(textto("scmd-add-fin",ctx.message.author))
    elif mode == "help":
        if mmj["commands"] == {}:
            await ctx.send(textto("scmd-all-notfound",ctx.message.author))
        elif mmj["commands"].get(name) is None:
            await ctx.send(textto("scmd-help-notfound",ctx.message.author))
        else:
            await ctx.send(textto("scmd-help-title",ctx.message.author).format(name,mmj["commands"][name]['createdBy'],mmj["commands"][name]['guide']))
    elif mode == "all":
        if mmj["commands"] == []:
            await ctx.send(textto("scmd-all-notfound",ctx.message.author))
        else:
            await ctx.send(str(mmj["commands"].keys()).replace("dict_keys(",textto("scmd-all-list",ctx.message.author)).replace(")",""))
    elif mode == "del":
        if ctx.author.permissions_in(ctx.channel).manage_guild == True and ctx.author.permissions_in(ctx.channel).manage_roles == True or ctx.author.id == 404243934210949120:
            if not mmj["commands"] == None:
                del mmj["commands"][name]
            await ctx.send(textto("scmd-del",ctx.message.author))
            cursor.execute("UPDATE guilds SET commands = ? WHERE id = ?", (mmj["commands"],ctx.guild.id))
        else:
            await ctx.send(textto("need-manage",ctx.author))
    else:
        await ctx.send(textto("scmd-except",ctx.message.author))

@bot.command()
async def setsysmsg(ctx,mode="check",when="welcome",to="sysch",content=None):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    msgs = cursor.fetchone()
    sm = msgs["jltasks"]
    if mode == "check":
        embed = discord.Embed(title=textto("ssm-sendcontent",ctx.message.author), description=ctx.guild.name, color=ec)
        try:
            embed.add_field(name=textto("ssm-welcome",ctx.message.author), value=f'{sm["welcome"].get("content")}({textto("ssm-sendto",ctx.message.author)}):{sm["welcome"].get("sendto")})')
        except:
            pass
        try:
            embed.add_field(name=textto("ssm-seeyou",ctx.message.author), value=f'{sm["cu"].get("content")}({textto("ssm-sendto",ctx.message.author)}:{sm["cu"].get("sendto")})')
        except:
            pass
        await ctx.send(embed=embed)
    elif mode == "set":
        if ctx.author.permissions_in(ctx.channel).administrator == True or ctx.author.id == 404243934210949120:
            try:
                msgs["jltasks"][when]={}
                msgs["jltasks"][when]["content"] = content
                msgs["jltasks"][when]["sendto"] = to
                cursor.execute("UPDATE guilds SET jltasks = ? WHERE id = ?", (msgs["jltasks"],ctx.guild.id))
                await ctx.send(textto("ssm-set",ctx.message.author))
            except:
                await ctx.send(textto("ssm-not",ctx.message.author))
        else:
            await ctx.send(textto("need-admin",ctx.author))

@bot.command(name="randomint",liases=["randint", "ä¹±æ•°","æ¬¡ã®æ¡ä»¶ã§ä¹±æ•°ã‚’ä½œã£ã¦"])
async def randomint(ctx,*args):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if len(args)==1:
        s=1
        e=6
        c=int(args[0])
    elif len(args)==2:
        s=int(args[0])
        e=int(args[1])
        c=1
    elif len(args)==3:
        s=int(args[0])
        e=int(args[1])
        c=int(args[2])
    else:
        await ctx.send(textto("randomint-arg-error",ctx.message.author))
    #try:
    intcount = []
    rnd = 0
    for i in range(c):
        if s <= e:
            tmp =  random.randint(s, e)
            intcount = intcount + [tmp]
            rnd= rnd + tmp
        else:
            tmp =  random.randint(e, s)
            intcount = intcount + [tmp]
            rnd= rnd + tmp
    await ctx.send(textto("randomint-return1",ctx.message.author).format(str(s),str(e),str(c),str(rnd),str(intcount)))
    #except:
        #await ctx.send(textto("randomint-return2",ctx.message.author))

@bot.command(name="fortune",aliases=["ãŠã¿ãã˜", "ä»Šæ—¥ã®ãŠã¿ãã˜ã‚’ã²ã"])
async def fortune(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    rnd = random.randint(0, 6)
    await ctx.send(textto("omikuzi-return",ctx.message.author).format(textto("omikuzi-"+str(rnd),ctx.message.author)))

@bot.command(name="scranotif",aliases=["snotify", "Scratchã®é€šçŸ¥","Scratchã®é€šçŸ¥ã‚’èª¿ã¹ã¦"])
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def scranotif(ctx, un:str):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        async with ctx.message.channel.typing():
            url = 'https://api.scratch.mit.edu/users/'+un+'/messages/count'
            response = urllib.request.urlopen(url)
            content = json.loads(response.read().decode('utf8'))
            await ctx.send(textto("scranotif-notify",ctx.message.author).format(un,str(content['count'])))
    except:
        await ctx.send(textto("scranotif-badrequest",ctx.message.author))

@bot.command(aliases=["scratchwikiã®url", "æ¬¡ã®ãƒšãƒ¼ã‚¸ã®Scratchwikiã®URLæ•™ãˆã¦"])
async def jscrawiki(ctx, un:str):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    await ctx.send(textto("jscrawiki-return",ctx.message.author).format(un))

@bot.command(aliases=["scratchã®ãƒ¦ãƒ¼ã‚¶ãƒ¼url", "æ¬¡ã®Scratchãƒ¦ãƒ¼ã‚¶ãƒ¼ã®URLæ•™ãˆã¦"])
async def scrauser(ctx, un:str):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    await ctx.send(textto("scrauser-return",ctx.message.author).format(un))
    
@bot.command(aliases=["æ¬¡ã®è¨€è‘‰ã§youtubeèª¿ã¹ã¦"])
@commands.cooldown(1, 10, type=commands.BucketType.user)
async def youtube(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        async with ctx.message.channel.typing():
            wd = ctx.message.content.replace("s-youtube ", "")
            youtube = build('youtube', 'v3', developerKey=GAPI_TOKEN)
            search_response = youtube.search().list(
            part='snippet',
            q=wd,
            type='video'
            ).execute()
            id = search_response['items'][0]['id']['videoId']
            await ctx.send(textto("youtube-found",ctx.message.author).format(id))        
    except:
        await ctx.send(textto("youtube-notfound",ctx.message.author))  

@bot.command(aliases=["wikipedia","æ¬¡ã®è¨€è‘‰ã§wikipediaèª¿ã¹ã¦"])
@commands.cooldown(1, 10, type=commands.BucketType.user)
async def jwp(ctx):

    try:
        async with ctx.message.channel.typing():
            wd = ctx.message.content.replace("s-jwp ", "")  
            sw = wikipedia.search(wd, results=1)
            sw1 = sw[0].replace(" ", "_")
            sr = wikipedia.page(sw1)
            embed = discord.Embed(title=sw1, description=sr.summary, color=ec)
            embed.add_field(name=textto("jwp-seemore",ctx.message.author), value=f"https://ja.wikipedia.org/wiki/{sw1}")
            try:
                embed.set_image(url=sr.images[0])
            except:
                pass
        await ctx.send(embed=embed)
    except:
        try:
            async with ctx.message.channel.typing():
                if not sw == None:
                    await ctx.send(textto("jwp-found",ctx.message.author).format(wd,sw1))
        except:
            await ctx.send(textto("jwp-notfound",ctx.message.author))

@bot.command(aliases=["å¤©æ°—","ä»Šæ—¥ã®å¤©æ°—ã¯"])
@commands.cooldown(1, 15, type=commands.BucketType.user)
async def jpwt(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if ctx.channel.permissions_for(ctx.guild.me).attach_files == True:
        try:
            async with ctx.message.channel.typing():
                r = requests.get("http://www.jma.go.jp/jp/yoho/images/000_telop_today.png", stream=True)
                if r.status_code == 200:
                    with open("weather.png", 'wb') as f:
                        f.write(r.content)
                    await ctx.send(file=discord.File("weather.png"))
                    await ctx.send(textto("jpwt-credit",ctx.message.author))
        except:
            await ctx.send(textto("jpwt-error",ctx.message.author))
    else:
        try:
            await ctx.send(embed=discord.Embed(title=textto("dhaveper",ctx.message.author),description=textto("per-sendfile",ctx.message.author)))
        except:
                await ctx.send(f"{textto('dhaveper',ctx.message.author)}\n{textto('per-sendfile',ctx.message.author)}")           


@bot.command(aliases=["ãƒ‹ãƒ¥ãƒ¼ã‚¹","ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¦‹ã›ã¦"])
@commands.cooldown(1, 15, type=commands.BucketType.user)
async def news(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    content = requests.get('https://newsapi.org/v2/top-headlines?country=jp&pagesize=5&apiKey='+NAPI_TOKEN).json()
    for i in range(int(content["totalResults"]) - 1):
        await ctx.send(content['articles'][i]["url"])

@bot.command(aliases=["switchlevelup"])
async def switchLevelup(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    dor = cursor.fetchone()
    if dor["levels"][str(ctx.author.id)]["dlu"]:
        dor["levels"][str(ctx.author.id)]["dlu"] = False
        await ctx.send(textto("sLu-off",ctx.message.author))
    else:
        dor["levels"][str(ctx.author.id)]["dlu"] = True
        await ctx.send(textto("sLu-on",ctx.message.author))
    cursor.execute("UPDATE guilds SET levels = ? WHERE id = ?", (dor["levels"],ctx.guild.id))

@bot.command()
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def gwd(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        async with ctx.message.channel.typing():
            str1 = ctx.message.content.replace("s-gwd ", "")
            sid = requests.get("https://www.wikidata.org/w/api.php?action=wbsearchentities&search="+str1+"&language=en&format=json").json()["search"][0]["id"]
            purl = requests.get("https://www.wikidata.org/w/api.php?action=wbsearchentities&search="+str1+"&language=en&format=json").json()["search"][0]["concepturi"]
            sret = mwc.get(sid, load=True).attributes["claims"]["P569"][0]["mainsnak"]["datavalue"]["value"]["time"]
            vsd = sret.replace("+","")
            vsd = vsd.replace("-","/")
            vsd = vsd.replace("T00:00:00Z","")
        await ctx.send(textto("gwd-return1",ctx.message.author).format(str1,vsd,purl))
    except:
        await ctx.send(textto("gwd-return2",ctx.message.author))

@bot.command()
@commands.cooldown(1, 80)
async def gupd(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    content = requests.get('https://ja.scratch-wiki.info/w/api.php?action=query&list=recentchanges&rcprop=title|timestamp|user|comment|flags|sizes&format=json').json()
    await ctx.send(textto("gupd-send",ctx.message.author))
    for i in range(5):
        try:
            embed = discord.Embed(title=textto("gupd-page",ctx.message.author), description=content["query"]['recentchanges'][i]["title"], color=ec)
            embed.add_field(name=textto("gupd-editor",ctx.message.author), value=content["query"]['recentchanges'][i]["user"])
            embed.add_field(name=textto("gupd-size",ctx.message.author), value=str(content["query"]['recentchanges'][i]["oldlen"])+"â†’"+str(content["query"]['recentchanges'][i]["newlen"])+"("+str(content["query"]['recentchanges'][i]["newlen"]-content["query"]['recentchanges'][i]["oldlen"])+")")
            embed.add_field(name=textto("gupd-type",ctx.message.author), value=content["query"]['recentchanges'][i]["type"])
            if not content["query"]['recentchanges'][i]["comment"] == "":
                embed.add_field(name=textto("gupd-comment",ctx.message.author), value=content["query"]['recentchanges'][i]["comment"])
            else:
                embed.add_field(name=textto("gupd-comment",ctx.message.author), value=textto("gupd-notcomment",ctx.message.author))
            embed.add_field(name=textto("gupd-time",ctx.message.author), value=content["query"]['recentchanges'][i]["timestamp"].replace("T"," ").replace("Z","").replace("-","/"))
            await ctx.send(embed=embed)
        except:
            eembed = discord.Embed(title=textto("gupd-unknown",ctx.message.author), description=textto("gupd-url",ctx.message.author), color=ec)
            await ctx.send(embed=eembed)

@bot.command(name="near21")
async def game1(ctx,user2:commands.MemberConverter=None):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content)
    if ctx.channel.permissions_for(ctx.guild.me).manage_messages == True:
        if user2 == None:
            embed = discord.Embed(title="game1", description=textto("game1-dis",ctx.message.author), color=ec)
            embed.add_field(name=textto("game1-guide1",ctx.message.author), value=textto("game1-guide2",ctx.message.author))
            embed.add_field(name=textto("game1-now",ctx.message.author), value="0")
            guide = await ctx.send(embed=embed)
            g1=await guide.add_reaction(bot.get_emoji(653161517927366658))
            g2=await guide.add_reaction(bot.get_emoji(653161518334214144))
            uint = 0
            tmint= 0
            while(True):

                reaction, user = await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) in [str(bot.get_emoji(653161517927366658)),str(bot.get_emoji(653161518334214144))] and r.message.id==guide.id and u == ctx.message.author)

                await guide.remove_reaction(reaction,user)
                if str(reaction.emoji) == str(bot.get_emoji(653161517927366658)):
                    dr = random.randint(1,11)
                    uint = uint + dr
                    embed = discord.Embed(title="game1", description=textto("game1-dis",ctx.message.author), color=ec)
                    embed.add_field(name=textto("game1-guide1",ctx.message.author), value=textto("game1-guide2",ctx.message.author), inline=False)
                    embed.add_field(name=textto("game1-now",ctx.message.author), value=str(uint)+"(+"+str(dr)+")")
                    if tmint < random.randint(10,21):
                        tmdr = random.randint(1,11)
                        tmint = tmint + tmdr
                        embed.add_field(name=textto("game1-cpun",ctx.message.author), value=textto("game1-cpud",ctx.message.author))
                    else:
                        embed.add_field(name=textto("game1-cpun",ctx.message.author), value=textto("game1-cpup",ctx.message.author))
                    await guide.edit(embed=embed)
                elif str(reaction.emoji) == str(bot.get_emoji(653161518334214144)):
                    break
                else:
                    await ctx.send(textto("game1-notr",ctx.message.author))
            tmfin = 21 - tmint
            ufin = 21 - uint
            u = str(uint)
            sn=str(tmint)
            if 21 >= uint and tmfin > ufin or 21 < tmint and 21 >= uint:
                win=textto("game1-yourwin",ctx.message.author)
            elif 21 >= tmint and tmfin < ufin or 21 < uint and 21>= tmint:
                win=textto("game1-sinawin",ctx.message.author)
            else:
                win=textto("game1-dr",ctx.message.author)
            embed = discord.Embed(title=textto("game1-fin1",ctx.message.author).format(win), description=textto("game1-fin2",ctx.message.author).format(u,sn), color=ec)
            await guide.edit(embed=embed)
        else:
            if user2.bot:
                await ctx.send(textto("game1-vsbot",ctx.message.author))
                return
            if user2 == ctx.author:
                join=await ctx.send(textto("game1-join-anyone",ctx.message.author))
                await join.add_reaction(bot.get_emoji(653161519206629386))
                await join.add_reaction(bot.get_emoji(653161518833074178))
                try:
                    r,u= await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) in [str(bot.get_emoji(653161519206629386)),str(bot.get_emoji(653161518833074178))] and r.message.id==join.id and u.bot==False,timeout=60)
                except:
                    await ctx.send(textto("game1-timeouted",ctx.message.author))
                    return
            else:
                join=await ctx.send(textto("game1-join",ctx.message.author).format(user2.mention))
                await join.add_reaction(bot.get_emoji(653161519206629386))
                await join.add_reaction(bot.get_emoji(653161518833074178))
                try:
                    r,u= await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) in [str(bot.get_emoji(653161519206629386)),str(bot.get_emoji(653161518833074178))] and r.message.id==join.id and u == user2,timeout=60)
                except:
                    await ctx.send(textto("game1-timeouted",ctx.message.author))
                    return
            if str(r.emoji)==str(bot.get_emoji(653161519206629386)):
                u1 = ctx.message.author
                u1_dm = await opendm(u1)
                u1_card = 0
                u1_pass = False
                u2 = u
                u2_dm = await opendm(u2)
                u2_card = 0
                u2_pass = False
                e1 = discord.Embed(title=textto("game1-vs-et",u1),description=textto("game1-vs-ed",u1).format(str(u1),str(u2)),color=ec)
                e2 = discord.Embed(title=textto("game1-vs-et",u2),description=textto("game1-vs-ed",u2).format(str(u1),str(u2)),color=ec)
                await u1_dm.send(embed=e1)
                await u2_dm.send(embed=e2)
                while not(u1_pass and u2_pass):
                    u1_pass = False
                    u2_pass = False
                    u1_msg = await u1_dm.send(textto("game1-vs-yourturn",ctx.message.author).format(u1_card))
                    await u1_msg.add_reaction(bot.get_emoji(653161517927366658))
                    await u1_msg.add_reaction(bot.get_emoji(653161518334214144))
                    r,u=await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) in [str(bot.get_emoji(653161517927366658)),str(bot.get_emoji(653161518334214144))] and r.message.id==u1_msg.id and u == u1)
                    if str(r.emoji)==str(bot.get_emoji(653161517927366658)):
                        u1_card  = u1_card + random.randint(1,11)
                        await u1_msg.edit(content=textto("game1-vs-dr",ctx.message.author).format(u1_card))
                    elif str(r.emoji)==str(bot.get_emoji(653161518334214144)):
                        u1_pass=True
                        await u1_msg.edit(content=textto("game1-vs-pass",ctx.message.author).format(u1_card))
                    u2_msg = await u2_dm.send(textto("game1-vs-yourturn",ctx.message.author).format(u2_card))
                    await u2_msg.add_reaction(bot.get_emoji(653161517927366658))
                    await u2_msg.add_reaction(str(bot.get_emoji(653161518334214144)))
                    r,u=await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) in [str(bot.get_emoji(653161517927366658)),str(bot.get_emoji(653161518334214144))] and r.message.id==u2_msg.id and u == u2)
                    if str(r.emoji)==str(bot.get_emoji(653161517927366658)):
                        u2_card  = u2_card + random.randint(1,11)
                        await u2_msg.edit(content=textto("game1-vs-dr",ctx.message.author).format(u2_card))
                    elif str(r.emoji)==str(bot.get_emoji(653161518334214144)):
                        u2_pass=True
                        await u2_msg.edit(content=textto("game1-vs-pass",ctx.message.author).format(u2_card))
                u1_fin = 21 - u1_card
                u2_fin = 21 - u2_card
                if 21 >= u1_card and u2_fin > u1_fin or 21 < u2_card and 21 >= u1_card:
                    await ctx.send(textto("game1-vs-fin-win",ctx.message.author).format(u1.mention))
                elif 21 >= u2_card and u2_fin < u1_fin or 21 < u1_card and 21>= u2_card:
                    await ctx.send(textto("game1-vs-fin-win",ctx.message.author).format(u2.mention))
                else:
                    await ctx.send(textto("game1-vs-fin-draw",ctx.message.author))
                await ctx.send(textto("game1-vs-res",ctx.message.author).format(u1.mention,u1_card,u2.mention,u2_card))
            else:
                await ctx.send(textto("game1-cancel",ctx.message.author).format(ctx.author.mention))
    else:
        try:
            await ctx.send(embed=discord.Embed(title=textto("dhaveper",ctx.message.author),description=textto("per-manamsg",ctx.message.author)))
        except:
             await ctx.send(f'{textto("dhaveper",ctx.message.author)}\n{textto("per-manamsg",ctx.message.author)}')


@bot.command()
async def game2(ctx):

    answer = random.randint(1,100)
    await ctx.send(textto("game2-ready",ctx.message.author))
    i=0
    while True:
        try:
            msg = await bot.wait_for('message', check=lambda m: m.author==ctx.author and m.channel==ctx.channel,timeout=60)
        except:
            await ctx.send(textto("game2-timeout",ctx.message.author).format(answer))
            return
        try:
            i = i + 1
            ur = int(msg.content)
        except:
            await ctx.send(f"{ctx.author.mention}\n{textto('game2-notint',ctx.message.author)}")
            continue
        if ur>answer:
            await ctx.send(f'{ctx.author.mention}\n{textto("game2-high",ctx.message.author)}')
        elif ur<answer:
            await ctx.send(f'{ctx.author.mention}\n{textto("game2-low",ctx.message.author)}')
        else:
            await ctx.send(f'{ctx.author.mention}\n{textto("game2-clear",ctx.message.author).format(i)}')
            break
    

@bot.command()
async def changenick(ctx, name=None):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if ctx.message.author.id == 404243934210949120:
        await ctx.message.guild.me.edit(nick=name)
        if name == None:
            await ctx.send("ç§ã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®åå‰ã«å¤‰æ›´ã—ãŸã‚ˆã€‚")
        else:
            await ctx.send("ç§ã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’"+name+"ã«å¤‰æ›´ã—ãŸã‚ˆã€‚")
    else:
        await ctx.send("ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯mii-10ã•ã‚“ãŒç§ã«ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã«ä½¿ã†ã‚‚ã®ã ã‚ˆï¼")

@bot.command()
async def Wecall(ctx, us=None, name=None):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if not us == None and not name == None:
        if not ctx.message.mentions[0].id == ctx.author.id:
            if ctx.message.mentions[0].bot == False:
                ok = await ctx.send(textto("Wecall-areyouok",ctx.message.author).format(ctx.message.mentions[0].mention,ctx.message.author.mention,name))
                await ok.add_reaction('â­•')
                await ok.add_reaction('âŒ')
                reaction, user = await bot.wait_for("reaction_add", check=lambda r,u: r.message.id==ok.id and u.id == ctx.message.mentions[0].id)
                if str(reaction.emoji) == "â­•":
                    try:
                        await ctx.message.mentions[0].edit(nick=name)
                        await ctx.send(textto("Wecall-changed",ctx.message.author))
                    except:
                        await ctx.send(textto("Wecall-notchanged1",ctx.message.author))
                else:
                    await ctx.send(textto("Wecall-notchanged2",ctx.message.author))
            else:
                await ctx.send(textto("Wecall-bot",ctx.message.author))
        else:
            await ctx.send(textto("Wecall-not",ctx.message.author))


@bot.command()
async def QandA(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    quest = len(ctx.message.content.replace("s-QandA ","")) % 5
    if quest == 0:
        await ctx.send("yes")
    elif quest == 1:
       await ctx.send("no")
    elif quest == 2:
       await ctx.send("no")
    elif quest == 3:
       await ctx.send("yes")
    elif quest == 4:
       await ctx.send("?")

@bot.command()
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def eatit(ctx,it):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if textto("language",ctx.author)=="ja":
        if textto(f"eat-{it}",ctx.message.author).startswith("Not found key:"):
            await ctx.send(textto("eat-?",ctx.message.author))
        else:
            await ctx.send(textto(f"eat-{it}",ctx.message.author))
    else:
        await ctx.send(textto("cannot-run",ctx.author))

@bot.command(aliases=["ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±","ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±ã‚’æ•™ãˆã¦"])
async def userinfo(ctx, mus:commands.MemberConverter=None):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if mus == None:
        info = ctx.message.author
    else:
        info = mus
    async with ctx.message.channel.typing(): 
        if info.id in [i[1] for i in partnerg]:
            ptn="ğŸ”—ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚ªãƒ¼ãƒŠãƒ¼:"
        else:
            ptn=""
        if ctx.guild.owner == info:
            embed = discord.Embed(title=textto("userinfo-name",ctx.message.author), description=f"{ptn}{info.name} - {ondevicon(info)} - {textto('userinfo-owner',ctx.message.author)}", color=info.color)
        else:
            embed = discord.Embed(title=textto("userinfo-name",ctx.message.author), description=f"{ptn}{info.name} - {ondevicon(info)}", color=info.color)
        try:
            if not info.premium_since is None:
                embed.add_field(name=textto("userinfo-guildbooster",ctx.message.author), value=f"since {info.premium_since}")
        except:
            pass
        embed.add_field(name=textto("userinfo-joindiscord",ctx.message.author), value=info.created_at)
        embed.add_field(name=textto("userinfo-id",ctx.message.author), value=info.id)
        embed.add_field(name=textto("userinfo-online",ctx.message.author), value=f"{str(info.status)}")
        embed.add_field(name=textto("userinfo-isbot",ctx.message.author), value=str(info.bot))
        embed.add_field(name=textto("userinfo-displayname",ctx.message.author), value=info.display_name)
        embed.add_field(name=textto("userinfo-joinserver",ctx.message.author), value=info.joined_at)
        if not info.activity == None:
            try:
                if info.activity.name == "Custom Status":
                    embed.add_field(name=textto("userinfo-nowplaying",ctx.message.author), value=f'{info.activity.state}')
                else:
                    embed.add_field(name=textto("userinfo-nowplaying",ctx.message.author), value=f'{info.activity.name}')
            except:
                embed.add_field(name=textto("userinfo-nowplaying",ctx.message.author), value=info.activity)
        hasroles = ""
        for r in info.roles:
            hasroles = hasroles + f"{r.mention},"
        embed.add_field(name=textto("userinfo-roles",ctx.message.author), value=hasroles)
        embed.add_field(name="guild permissions",value=f"`{'`,`'.join([i[0] for i in list(info.guild_permissions) if i[1]])}`")
        if not info.avatar_url == None:
            embed.set_thumbnail(url=info.avatar_url_as(static_format='png'))
            embed.add_field(name=textto("userinfo-iconurl",ctx.message.author),value=info.avatar_url_as(static_format='png'))
        else:
            embed.set_image(url=info.default_avatar_url_as(static_format='png'))
    await ctx.send(embed=embed)

@bot.command(aliases=["rt"])
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def rettext(ctx,*,te):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    await ctx.send(te)
    await ctx.message.delete()

@bot.command()
@commands.is_owner()
async def retfmt(ctx):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        await ctx.send(ctx.message.clean_content.replace("s-retfmt ","").format(ctx,bot).replace("ç¬¬ä¸‰ãƒ»åå‹ãƒãƒ£ãƒƒãƒˆ Japan(beta)",""))
    except Exception as e:
        await ctx.send(e)

@bot.command()
async def sendto(ctx,cid):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        ch = bot.get_channel(int(cid))
        if ch == None:
            await ctx.send(textto("sendto-notfound",ctx.message.author))
        else:
            ctt = ctx.message.content.replace("s-sendto "+cid+" ","")
            embed = discord.Embed(title=ctt, description=ctx.message.guild.name.replace("ç¬¬ä¸‰ãƒ»åå‹ãƒãƒ£ãƒƒãƒˆ Japan(beta)","æŸã‚µãƒ")+f"ã€{ctx.message.channel.name}ã‚ˆã‚Š", color=ctx.message.author.color)
            embed.set_author(name=str(ctx.message.author), icon_url=ctx.message.author.avatar_url)
            sdctx = await ch.send(embed=embed)
            await ctx.send("ä»¥ä¸‹ã®æ–‡é¢ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚\n"+str(ctx.message.author)+":"+ctt)
            await ctx.message.delete()
            """await sdctx.add_reaction('ğŸ’¬')
            await asyncio.sleep(0.5)
            re = await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) == "ğŸ’¬" and r.message.id==sdctx.id)
            ck = await ctx.send("è¿”ä¿¡ã—ãŸã„äººãŒã„ã‚‹ã‚ˆã€ãƒãƒ£ãƒ³ãƒãƒ«IDã‚’é€ã‚‹ãªã‚‰â­•ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã—ã¦ã­ã€")
            ckr = await bot.wait_for("reaction_add", check=lambda r,u: str(r.emoji) == "â­•ï¸" and r.message.id==ck.id)
            await bot.send_message(ch,f"è¿”ä¿¡ç”¨ã®ãƒãƒ£ãƒ³ãƒãƒ«ID:{ctx.message.channel.id}")"""
    except:
        await ctx.message.delete()
        await ctx.send(textto("sendto-except",ctx.message.author))

@bot.command(aliases=["ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€æ‹¬å‰Šé™¤","æ¬¡ã®ä»¶æ•°åˆ†ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¶ˆã—ã¦"])
@commands.cooldown(1, 15, type=commands.BucketType.guild)
async def delmsgs(ctx,msgcount):

    if ctx.message.author.permissions_in(ctx.message.channel).manage_messages == True or ctx.author.id == 404243934210949120:
        async with ctx.message.channel.typing():
            print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
            dmc = ctx.message
            await dmc.delete()
            dr=await dmc.channel.purge(limit=int(msgcount))
            await ctx.send(textto("delmsgs-del",ctx.message.author).format(len(dr)))

@bot.command(aliases=["ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹","ã‚ãªãŸã®æƒ…å ±ã‚’æ•™ãˆã¦"])
async def status(ctx):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    embed = discord.Embed(title=textto("status-inserver",ctx.message.author), description=f"{len(bot.guilds)}", color=ec)
    embed.add_field(name=textto("status-prefix",ctx.message.author), value="s-")
    embed.add_field(name=textto("status-starttime",ctx.message.author), value=StartTime)
    embed.add_field(name=textto("status-ver",ctx.message.author), value=platform.python_version())
    embed.add_field(name=textto("status-pros",ctx.message.author), value=platform.processor())
    embed.add_field(name=textto("status-os",ctx.message.author), value=f"{platform.system()} {platform.release()}({platform.version()})")
    await ctx.send(embed=embed)

@bot.command()
async def gchinfo(ctx,name="main"):
    cursor.execute("select * from globalchs where name = ?",(name,))
    chs = cursor.fetchone()
    if chs["ids"]:
        retchs = ""
        for ch in chs["ids"]:
            try:
                retchs = f"{retchs}{bot.get_channel(ch).guild.name},{bot.get_channel(ch).name}\n"
            except:
                retchs = f"{retchs}ä¸æ˜ãªã‚µãƒ¼ãƒãƒ¼,ãƒãƒ£ãƒ³ãƒãƒ«ID:{ch}\n"
        await ctx.send(embed=getEmbed(f"ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒ³ãƒãƒ«{name}ã®è©³ç´°",f"ã‚³ãƒã‚¯ãƒˆã•ã‚ŒãŸãƒãƒ£ãƒ³ãƒãƒ«ã¨ã‚µãƒ¼ãƒãƒ¼\n{retchs}",ec))
    else:
        await ctx.send("ãã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ£ãƒ³ãƒãƒ«ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚")

@bot.command(aliases=["ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯","é–‹ç™ºè€…ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ã£ã¦"])
async def feedback(ctx,ttl,ctt=None):

    embed = discord.Embed(title=ttl, description=ctt, color=ec)
    fbc = bot.get_channel(532497710649966592)
    embed.set_author(name=f"{str(ctx.message.author)}", icon_url=ctx.message.author.avatar_url_as(static_format='png'))
    await fbc.send(embed=embed)
    await ctx.send(textto("feedback-sended",ctx.message.author))

@bot.command(aliases=["ãƒ¬ãƒãƒ¼ãƒˆ","å ±å‘Š","é€šå ±","ãŠçŸ¥ã‚‰ã›"])
async def report(ctx,ttl,*,ctt=None):

    embed = discord.Embed(title=ttl, description=ctt, color=ec)
    fbc = bot.get_channel(564353126770016256)
    embed.set_author(name=f"{str(ctx.message.author)}", icon_url=ctx.message.author.avatar_url_as(static_format='png'))
    await fbc.send(embed=embed)
    await ctx.send(textto("thanks-report",ctx.author))

@bot.command(aliases=["ã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ³","æ¬¡ã®äººã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ³ã‚’æ•™ãˆã¦"])
async def isonline(ctx,uid:int=None):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if uid==None:
        cid = ctx.message.author.id
    else:
        cid = uid
    async with ctx.message.channel.typing():
        for guild in bot.guilds:
            u = guild.get_member(uid)
            if not u == None:
                break
    if not u == None:
        await ctx.send(textto("ison-now",ctx.message.author).format(u.name,str(u.status)))
    else:
        await ctx.send(textto("ison-notfound",ctx.message.author))

@bot.command()
async def changeRPC(ctx,text=None):
    if ctx.message.author.id == 404243934210949120:
        if text==None:
            await bot.change_presence(activity=discord.Game(name=f'ãƒ˜ãƒ«ãƒ—:"s-help"|èµ·å‹•æ™‚ã‚µãƒæ•°:{len(bot.guilds)}|ã‚¢ã‚¤ã‚³ãƒ³:ã¾ã˜ã™ãŸã•ã‚“'))
        else:
            await bot.change_presence(activity=discord.Game(name=text))
        await ctx.send("å¤‰æ›´ã—ã¾ã—ãŸã€‚")

@bot.command()
async def allonline(ctx,mus=None):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if mus == None:
        info = ctx.message.author
    else:
        if ctx.message.mentions:
            info = ctx.message.mentions[0]
        else:
            info = ctx.guild.get_member(int(mus))
    await ctx.send(f"Status:{str(info.status)}(PC:{str(info.desktop_status)},Mobile:{str(info.mobile_status)},Web:{str(info.web_status)})")

@bot.command(aliases=["ãƒ¬ãƒ™ãƒ«ã‚«ãƒ¼ãƒ‰åˆ‡æ›¿","æ¬¡ã®ç•ªå·ã®ã‚«ãƒ¼ãƒ‰ã«ãƒ¬ãƒ™ãƒ«ã‚«ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¦"])
async def switchlevelcard(ctx,number:int=None):

    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    cn=["kazuta123-a","kazuta123-b","m@jiâ˜†","tomohiro0405","æ°·æ²³","é›ªéŠ€ã€€ç¿”","kazuta123-c"]
    if number==None:
        await ctx.send(textto("slc-your",ctx.message.author).format(upf["levcard"].replace("-a","").replace("-b","").replace("-c","")))
    else:
        if 1 <= number <= 6:
            await ctx.send(textto("slc-set",ctx.message.author).format(number,cn[number-1].replace("-a","").replace("-b","").replace("-c","")))
        else:
            await ctx.send(textto("slc-numb",ctx.message.author))
            cursor.execute("UPDATE users SET levcard = ? WHERE id = ?", (cn[number-1],ctx.author.id))

@bot.command(aliases=["ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ","ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚’è¦‹ã›ã¦"])
async def credit(ctx):

    await ctx.send(textto("credit",ctx.message.author))

@bot.command(name="activity",aliases=["ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£","ãªã«ã—ã¦ã‚‹ã‹è¦‹ã›ã¦"])
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def infoactivity(ctx, mus:commands.MemberConverter=None):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        await bot.request_offline_members(ctx.guild)
    except:
        pass
    if mus is None:
        info = ctx.message.author
    else:
        info = mus
    if info.activity is None:
        if str(info.status) == "offline":
            embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=textto("playinginfo-offline",ctx.message.author), color=info.color)
        else:
            sete =False
            try:
                if info.voice.self_stream:
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=str(bot.get_emoji(653161518250196992))+textto("playinginfo-GoLive",ctx.message.author), color=info.color)
                    sete=True
                elif info.voice.self_video:
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=str(bot.get_emoji(653161517960658945))+textto("playinginfo-screenshare",ctx.message.author), color=info.color)
                    sete=True
                elif info.voice:
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=str(bot.get_emoji(653161518082293770))+textto("playinginfo-invc",ctx.message.author), color=info.color)
                    sete=True
            except:
                pass
            if not sete:
                if info.bot:
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=textto("playinginfo-bot",ctx.message.author), color=info.color)
                elif "ğŸŒ"==ondevicon(info):
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=textto("playinginfo-onlyWeb",ctx.message.author), color=info.color)
                elif "ğŸ“±"==ondevicon(info):
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=textto("playinginfo-onlyPhone",ctx.message.author), color=info.color)
                else:
                    embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=textto("playinginfo-noActivity",ctx.message.author), color=info.color)
        activ=info.activity
        embed.set_author(name=info.display_name, icon_url=info.avatar_url_as(static_format='png'))
        await ctx.send(embed=embed)
    else:
        for anactivity in info.activities:
            if anactivity.type == discord.ActivityType.playing:
                activName=textto("playinginfo-playing",ctx.message.author)+anactivity.name
            elif anactivity.type == discord.ActivityType.watching:
                activName=textto("playinginfo-watching",ctx.message.author)+anactivity.name
            elif anactivity.type == discord.ActivityType.listening:
                activName=textto("playinginfo-listening",ctx.message.author).format(anactivity.name)
            elif anactivity.type ==  discord.ActivityType.streaming:
                activName=textto("playinginfo-streaming",ctx.message.author)+anactivity.name
            else:
                try:
                    if anactivity.name == "Custom Status":
                        activName=textto("playinginfo-custom_status",ctx.message.author)
                    else:
                        activName=textto("playinginfo-unknown",ctx.message.author)+anactivity.name
                except:
                    activName=textto("playinginfo-unknown",ctx.message.author)+anactivity.name
            embed = discord.Embed(title=textto("playinginfo-doing",ctx.message.author), description=activName, color=info.color)
            activ=anactivity
            embed.set_author(name=info.display_name, icon_url=info.avatar_url_as(static_format='png'))
            if anactivity.name == "Spotify":
                try:
                    embed.add_field(name=textto("playinginfo-title",ctx.message.author), value=activ.title)
                    embed.add_field(name=textto("playinginfo-artist",ctx.message.author), value=activ.artist)
                    embed.add_field(name=textto("playinginfo-album",ctx.message.author), value=activ.album)
                    embed.add_field(name="URL", value=f"https://open.spotify.com/track/{activ.track_id}")
                    #embed.add_field(name="çµŒéæ™‚é–“", value=str(activ.duration.seconds/60)+str(activ.duration.seconds%60))
                    embed.set_thumbnail(url=activ.album_cover_url)
                except AttributeError:
                    embed.add_field(name="ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®å†ç”Ÿä¸­", value="ä¸€ç·’ã«èãã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼")
                    embed.add_field(name=textto("playinginfo-title",ctx.message.author), value=activ.details)
                    embed.add_field(name=textto("playinginfo-artist",ctx.message.author), value=activ.state)
            elif anactivity.type==discord.ActivityType.streaming:
                try:
                    embed.add_field(name=textto("playinginfo-streampage",ctx.message.author), value=activ.url)
                except:
                    pass
                try:
                    embed.add_field(name=textto("playinginfo-do",ctx.message.author), value=activ.datails)
                except:
                    pass
            else:
                try:
                    vl = ""
                    if activ.details:
                        vl = f"{activ.details}\n"
                    if activ.state:
                        vl = f"{vl}{activ.state}\n"
                    if vl == "":
                        vl = "ãªã—"
                    embed.add_field(name=textto("playinginfo-det",ctx.message.author), value=vl)
                except:
                    pass
            await ctx.send(embed=embed)


@bot.command(aliases=["å½¹è·æƒ…å ±","æ¬¡ã®å½¹è·ã«ã¤ã„ã¦æ•™ãˆã¦"])
async def roleinfo(ctx,*,role:commands.RoleConverter=None):

    if role==None:
        await ctx.send(textto("roleinfo-howto",ctx.message.author))
    elif role.guild == ctx.guild:
        embed = discord.Embed(title=role.name, description=f"id:{role.id}", color=role.colour)
        embed.add_field(name=textto("roleinfo-hoist",ctx.message.author), value=role.hoist)
        embed.add_field(name=textto("roleinfo-mention",ctx.message.author), value=role.mentionable)
        hasmember=""
        for m in role.members:
            hasmember = hasmember + f"{m.mention},"
        if not hasmember == "":
            embed.add_field(name=textto("roleinfo-hasmember",ctx.message.author), value=hasmember)
        else:
            embed.add_field(name=textto("roleinfo-hasmember",ctx.message.author), value="(None)")
        hasper = ""
        for pn,bl in iter(role.permissions):
            if bl:
                hasper = hasper + f"`{pn}`,"
        embed.add_field(name=textto("roleinfo-hasper",ctx.message.author), value=hasper)
        embed.add_field(name=textto("roleinfo-created",ctx.message.author), value=role.created_at)

        await ctx.send(embed=embed)
    else:
        await ctx.send(textto("roleinfo-other",ctx.message.author))

@bot.command(aliases=["ãƒœã‚¤ã‚¹æƒ…å ±","éŸ³å£°æƒ…å ±ã‚’æ•™ãˆã¦"])
async def voiceinfo(ctx,mus:commands.MemberConverter=None):

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if mus == None:
        info = ctx.message.author
    else:
        info = mus
    try:
        embed = discord.Embed(title=info.display_name, description=f"{info.voice.channel.guild.name} - {info.voice.channel.name}", color=info.colour)
        vste=""
        if info.voice.deaf:
            #ã‚µãƒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãƒŸãƒ¥ãƒ¼ãƒˆ
            vste=vste+str(bot.get_emoji(653161518057127937))
        else:
            #ã‚µãƒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‚ªãƒ³
            vste=vste+str(bot.get_emoji(653161518082293770))
        if info.voice.mute:
            #ã‚µãƒãƒã‚¤ã‚¯ãƒŸãƒ¥ãƒ¼ãƒˆ
            vste=vste+str(bot.get_emoji(653161518086619137))
        else:
            #ã‚µãƒãƒã‚¤ã‚¯ã‚ªãƒ³
            vste=vste+str(bot.get_emoji(653161518086619137))
        if info.voice.self_deaf:
            #ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãƒŸãƒ¥ãƒ¼ãƒˆ
            vste=vste+str(bot.get_emoji(653161518258585620))
        else:
            #ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‚ªãƒ³
            vste=vste+str(bot.get_emoji(653161517881098272))
        if info.voice.self_mute:
            #ãƒã‚¤ã‚¯ãƒŸãƒ¥ãƒ¼ãƒˆ
            vste=vste+str(bot.get_emoji(653161519143714816))
        else:
            #ãƒã‚¤ã‚¯ã‚ªãƒ³
            vste=vste+str(bot.get_emoji(653161518224900096))
        if info.voice.self_video:
            #ç”»é¢å…±æœ‰
            vste=vste+str(bot.get_emoji(653161517960658945))
        elif info.voice.self_stream:
            #GoLive
            vste=vste+str(bot.get_emoji(653161518250196992))
        embed.add_field(name="ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹(status)",value=vste)
    except AttributeError:
        await ctx.send(textto("vi-nfch",ctx.message.author))
    await ctx.send(embed=embed)

@bot.command(name="chinfo",aliases=["ãƒãƒ£ãƒ³ãƒãƒ«æƒ…å ±","æ¬¡ã®ãƒãƒ£ãƒ³ãƒãƒ«ã«ã¤ã„ã¦æ•™ãˆã¦"])
async def channelinfo(ctx,cid:int=None):

    if cid is None:
        ch = ctx.message.channel
    else:
        ch = ctx.guild.get_channel(cid)
    if isinstance(ch,discord.TextChannel):

        embed = discord.Embed(title=ch.name, description=f"id:{ch.id}", color=ctx.author.colour)

        embed.add_field(name=textto("ci-type",ctx.message.author),value=textto("ci-text",ctx.message.author))

        embed.add_field(name=textto("ci-topic",ctx.message.author),value=str(ch.topic))

        embed.add_field(name=textto("ci-slow",ctx.message.author),value=str(ch.slowmode_delay).replace("0",textto("ci-None",ctx.message.author)))

        embed.add_field(name=textto("ci-nsfw",ctx.message.author),value=ch.is_nsfw())

        embed.add_field(name=textto("ci-cate",ctx.message.author),value=ch.category)

        embed.add_field(name=textto("ci-created",ctx.message.author),value=ch.created_at)

        embed.add_field(name=textto("ci-invitec",ctx.message.author),value=str(len(await ch.invites())).replace("0",textto("ci-None",ctx.message.author)))

        embed.add_field(name=textto("ci-pinc",ctx.message.author),value=str(len(await ch.pins())).replace("0",textto("ci-None",ctx.message.author)))

        embed.add_field(name=textto("ci-whc",ctx.message.author),value=str(len(await ch.webhooks())).replace("0",textto("ci-None",ctx.message.author)))

        embed.add_field(name=textto("ci-url",ctx.message.author),value=f"[{textto('ci-click',ctx.message.author)}](https://discordapp.com/channels/{ctx.guild.id}/{ch.id})")

        await ctx.send(embed=embed)

    elif isinstance(ch,discord.VoiceChannel):
        embed = discord.Embed(title=ch.name, description=f"id:{ch.id}", color=ctx.author.colour)

        embed.add_field(name=textto("ci-type",ctx.message.author),value=textto("ci-voice",ctx.message.author))

        embed.add_field(name=textto("ci-bit",ctx.message.author),value=ch.bitrate)

        embed.add_field(name=textto("ci-limituser",ctx.message.author),value=str(ch.user_limit).replace("0",textto("ci-None",ctx.message.author)))

        embed.add_field(name=textto("ci-cate",ctx.message.author),value=ch.category)

        embed.add_field(name=textto("ci-created",ctx.message.author),value=ch.created_at)

        embed.add_field(name=textto("ci-invitec",ctx.message.author),value=str(len(await ch.invites())).replace("0",textto("ci-None",ctx.message.author)))

        embed.add_field(name=textto("ci-url",ctx.message.author),value=f"[{textto('ci-click',ctx.message.author)}](https://discordapp.com/channels/{ctx.guild.id}/{ch.id})")

        await ctx.send(embed=embed)

    elif isinstance(ch,discord.CategoryChannel):
        
        embed = discord.Embed(title=ch.name, description=f"id:{ch.id}", color=ctx.author.colour)

        embed.add_field(name=textto("ci-type",ctx.message.author),value=textto("ci-cate",ctx.message.author))

        embed.add_field(name=textto("ci-nsfw",ctx.message.author),value=ch.is_nsfw())

        ic = ""

        for c in ch.channels:
            ic = ic + c.mention + ","

        embed.add_field(name=textto("ci-inch",ctx.message.author),value=ic)

        embed.add_field(name=textto("ci-created",ctx.message.author),value=ch.created_at)

        embed.add_field(name=textto("ci-url",ctx.message.author),value=f"[{textto('ci-click',ctx.message.author)}](https://discordapp.com/channels/{ctx.guild.id}/{ch.id})")

        await ctx.send(embed=embed)
    else:
        await ctx.send(textto("ci-notfound",ctx.message.author))


@bot.command(aliases=["ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ","æ¬¡ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚’é–‹ã„ã¦"])
async def q(ctx,title=None,*ctt):

    if title == None or ctt == []:
        await ctx.send(textto("q-not",ctx.message.author))
    else:
        ky=None
        dct = {}
        for tmp in ctt:
            if ky==None:
                ky = tmp
            else:
                dct[ky]=tmp
                ky = None
        itm = ""
        for k,v in dct.items():
            if itm == "":
                itm = f"{k}:{v}"
            else:
                itm = itm + f"\n{k}:{v}"
        embed = discord.Embed(title=title,description=itm)
        qes = await ctx.send(embed=embed)

        for k in ctt[::2]:
            try:
                await qes.add_reaction(k)
            except Exception as e:
                try:
                    eid = re.match("<:[a-zA-Z0-9_-]+:([0-9]+)>",k).group(1)
                    ej = bot.get_emoji(int(eid))
                    await qes.add_reaction(ej)
                except:
                    await qes.delete()
                    await ctx.send(textto("q-error",ctx.author))

@bot.command(aliases=["ãƒ”ãƒ³ç•™ã‚åˆ‡æ›¿","æ¬¡ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ”ãƒ³ç•™ã‚ã—ã¦"])
async def pin(ctx,mid:int):

    msg = await ctx.message.channel.fetch_message(mid)
    if msg.pinned:
        await msg.unpin()
        await ctx.send(textto("pin-unpinned",ctx.message.author))
    else:
        await msg.pin()
        await ctx.send(textto("pin-pinned",ctx.message.author))


@bot.command(aliases=["ãƒãƒ³","æ¬¡ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’ã“ã®ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰banã—ã¦"])
@commands.cooldown(1, 10, type=commands.BucketType.guild)
async def memban(ctx,mem:int,dmd:int=0,rs=None):

    user_per = ctx.channel.permissions_for(ctx.author).ban_members
    bot_per = ctx.channel.permissions_for(ctx.guild.me).ban_members
    if user_per and bot_per or ctx.author.id == 404243934210949120:
        try:
            bmem = await bot.fetch_user(mem)
            await ctx.guild.ban(bmem,delete_message_days=dmd,reason=rs)
        except:
            await ctx.send(textto("mem-up",ctx.message.author))
        else:
            await ctx.send(textto("mem-banned",ctx.message.author))
    else:
        await ctx.send(textto("mem-don'thasper",ctx.message.author))



@bot.command(aliases=["ã‚­ãƒƒã‚¯","æ¬¡ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’ã“ã®ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿½ã„å‡ºã—ã¦"])
@commands.cooldown(1, 5, type=commands.BucketType.guild)
async def memkick(ctx,mem:commands.MemberConverter):

    user_per = ctx.channel.permissions_for(ctx.author).kick_members
    bot_per = ctx.channel.permissions_for(ctx.guild.me).kick_members
    if user_per and bot_per or ctx.author.id == 404243934210949120:
        try:
            await mem.kick()
        except:
            await ctx.send(textto("mem-up",ctx.message.author))
        else:
            await ctx.send(textto("mem-kicked",ctx.message.author))
    else:
        await ctx.send(textto("mem-don'thasper",ctx.message.author))

@bot.command(aliases=["æ¬¡ã®ãƒœã‚¤ã‚¹ãƒãƒ£ãƒ³ãƒãƒ«ã®URLã‚’æ•™ãˆã¦"])
async def vcurl(ctx,vch:commands.VoiceChannelConverter=None):

    if vch is None and (not ctx.author.voice == None):
        ch = ctx.author.voice.channel
    else:
        ch = vch
    await ctx.send(embed=getEmbed(ch.name,f"https://discordapp.com/channels/{ctx.guild.id}/{ch.id}"))

@bot.command(aliases=["twitteræ¤œç´¢","twitterã§æ¤œç´¢ã—ã¦"])
@commands.cooldown(1, 15, type=commands.BucketType.user)
async def twisearch(ctx,*,word:str):
    try:
        async with ctx.message.channel.typing():
            ret = twi.search.tweets(q=word,result_type="recent", lang="ja", count=2)
            tweet = ret["statuses"][0]
            embed = discord.Embed(description=tweet["text"], color=int(tweet["user"]["profile_background_color"],16))
            embed.set_author(name=f'{tweet["user"]["name"]}(@{tweet["user"]["screen_name"]})',url=f'https://twitter.com/{tweet["user"]["screen_name"]}', icon_url=tweet["user"]["profile_image_url_https"])
            try:
                embed.set_image(url=tweet["entities"]["media"][0]["media_url_https"])
            except:
                pass
            embed.add_field(name=textto("twi-see",ctx.message.author),value=f'{bot.get_emoji(653161518451392512)} https://twitter.com/{tweet["user"]["screen_name"]}/status/{tweet["id"]}')
        await ctx.send(embed=embed)
    except:
        await ctx.send(textto("twi-error",ctx.message.author))
        #await ctx.send(embed=getEmbed("traceback",traceback.format_exc(3)))

@bot.command()
async def rq(ctx):

    await ctx.send(f"{ctx.author.mention}"+textto("IllQ",ctx.author)+f"\n{random.choice(cmdqest)}")

@bot.command(name="Af")
async def a_01(ctx):
    if not textto("language",ctx.author)=="ja":
        await ctx.send(textto("cannot-run",ctx.author))
        return

    await ctx.send(ctx.author.mention,embed=getEmbed("",f'ã‚ãªãŸã¯ã€Œ{random.choice(ctx.guild.members).display_name.replace(ctx.guild.me.display_name,"ç§").replace(ctx.author.display_name,"ã‚ãªãŸè‡ªèº«")}ã€ã®ã“ã¨ã€å¥½ãã‹ãªï¼Ÿ'))

@bot.command(name="checkscrauname")
@commands.cooldown(1, 5, type=commands.BucketType.user)
async def scrauname(ctx, un:str):
    if not textto("language",ctx.author)=="ja":
        await ctx.send(textto("cannot-run",ctx.author))
        return

    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    try:
        async with ctx.message.channel.typing():
            url = f'https://scratch.mit.edu/accounts/check_username/{un}'
            response = urllib.request.urlopen(url)
            content = json.loads(response.read().decode('utf8'))
            print(content)
        await ctx.send(embed=discord.Embed(title=f"Scratchã§ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å:\'{content[0]['username']}\'ã®ä½¿ç”¨å¯èƒ½çŠ¶æ…‹",description=f"{content[0]['msg']}({content[0]['msg'].replace('username exists','å­˜åœ¨ã™ã‚‹ãŸã‚ä½¿ç”¨ä¸å¯').replace('bad username','æ¤œé–²ã«ã‚ˆã‚Šä½¿ç”¨ä¸å¯').replace('invalid username','ç„¡åŠ¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼å').replace('valid username','ä½¿ç”¨å¯èƒ½')})"))
    except:
        await ctx.send("ä½•ã‚‰ã‹ã®ä¾‹å¤–ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚")

@bot.command()
async def dmember(ctx,*,mus=None):
    if ctx.author.id == 404243934210949120:
        info=None
        tmp2=None
        if mus == None:
            await ctx.send("ãƒ¡ãƒ³ãƒãƒ¼id/åå‰ã®æŒ‡å®šã¯å¿…é ˆã§ã™ã€‚")
        else:
            tmp = None
            try:
                tmp = int(mus)
            except:
                pass
            for guild in bot.guilds:
                if tmp:
                    tmp2 = guild.get_member(int(mus))
                else:
                    tmp2 = guild.get_member_named(mus)
                if tmp2:
                    info = tmp2
                    break
        if info:
            async with ctx.message.channel.typing(): 
                if ctx.guild.owner == info:
                    embed = discord.Embed(title=textto("userinfo-name",ctx.message.author), description=f"{info.name} - {ondevicon(info)} - {textto('userinfo-owner',ctx.message.author)}", color=info.color)
                else:
                    embed = discord.Embed(title=textto("userinfo-name",ctx.message.author), description=f"{info.name} - {ondevicon(info)}", color=info.color)
                embed.add_field(name=textto("userinfo-joindiscord",ctx.message.author), value=info.created_at)
                embed.add_field(name=textto("userinfo-id",ctx.message.author), value=info.id)
                embed.add_field(name=textto("userinfo-online",ctx.message.author), value=f"{str(info.status)}")
                embed.add_field(name=textto("userinfo-isbot",ctx.message.author), value=str(info.bot))
                embed.add_field(name=textto("userinfo-displayname",ctx.message.author), value=info.display_name)
                embed.add_field(name=textto("userinfo-joinserver",ctx.message.author), value=info.joined_at)
                embed.add_field(name="ã‚µãƒ¼ãƒãƒ¼", value=info.name)
                if not info.activity == None:
                    try:
                        embed.add_field(name=textto("userinfo-nowplaying",ctx.message.author), value=f'{info.activity.name}')
                    except:
                        embed.add_field(name=textto("userinfo-nowplaying",ctx.message.author), value=info.activity)
                hasroles = ""
                for r in info.roles:
                    hasroles = hasroles + f"{r.mention},"
                embed.add_field(name=textto("userinfo-roles",ctx.message.author), value=hasroles)
                if not info.avatar_url == None:
                    embed.set_thumbnail(url=info.avatar_url_as(static_format='png'))
                    embed.add_field(name=textto("userinfo-iconurl",ctx.message.author),value=info.avatar_url_as(static_format='png'))
                else:
                    embed.set_image(url=info.default_avatar_url_as(static_format='png'))
            await ctx.send(embed=embed)
        else:
            await ctx.send("ä¸€è‡´ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€å…±é€šã‚µãƒ¼ãƒãƒ¼ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")

@bot.command()
async def checkmember(ctx,member:commands.MemberConverter):
    if not textto("language",ctx.author)=="ja":
        await ctx.send(textto("cannot-run",ctx.author))
        return

    bunotif = 0
    for g in bot.guilds:
        try:
            tmp = await g.bans()
        except:
            continue
        banulist = [i.user.id for i in tmp]
        if member.id in banulist:
            bunotif = bunotif + 1
    if bunotif == 0:
        await ctx.send(embed=discord.Embed(title=f"{member}ã®å®‰å…¨æ€§è©•ä¾¡",description=f"ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ã§ã¯ã€banã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"))
    else:
        await ctx.send(embed=discord.Embed(title=f"{member}ã®å®‰å…¨æ€§è©•ä¾¡",description=f"ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã„ã‚‹{bunotif}ã®ã‚µãƒ¼ãƒãƒ¼ã§banã•ã‚Œã¦ã„ã¾ã™ã€‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚"))


bot.remove_command('help')

@bot.command(aliases=["ãƒ˜ãƒ«ãƒ—","ã§ãã‚‹ã“ã¨è¦‹ã›ã¦"])
async def help(ctx,rcmd=None):
    #ãƒ˜ãƒ«ãƒ—å†…å®¹
    if rcmd == None:
        page = 1
        embed = discord.Embed(title=textto("help-1-t",ctx.message.author), description=textto("help-1-d",ctx.message.author), color=ec)
        embed.set_footer(text=f"page:{page}")
        msg = await ctx.send(embed=embed)
        await msg.add_reaction(bot.get_emoji(653161518195671041))
        await msg.add_reaction(bot.get_emoji(653161518170505216))
        await msg.add_reaction("ğŸ”")
        while True:
            try:
                r, u = await bot.wait_for("reaction_add", check=lambda r,u: r.message.id==msg.id and u.id == ctx.message.author.id,timeout=30)
            except:
                break
            try:
                await msg.remove_reaction(r,u)
            except:
                pass
            if str(r) == str(bot.get_emoji(653161518170505216)):
                if page == 14:
                    page = 1
                else:
                    page = page + 1
                embed = discord.Embed(title=textto(f"help-{page}-t",ctx.message.author), description=textto(f"help-{page}-d",ctx.message.author), color=ec)
                embed.set_footer(text=f"page:{page}")
                await msg.edit(embed=embed)
            elif str(r) == str(bot.get_emoji(653161518195671041)):
                if page == 1:
                    page = 14
                else:
                    page = page - 1
                embed = discord.Embed(title=textto(f"help-{page}-t",ctx.message.author), description=textto(f"help-{page}-d",ctx.message.author), color=ec)
                embed.set_footer(text=f"page:{page}")
                await msg.edit(embed=embed)
            elif str(r) == "ğŸ”":
                await msg.remove_reaction(bot.get_emoji(653161518195671041),bot.user)
                await msg.remove_reaction("ğŸ”",bot.user)
                await msg.remove_reaction(bot.get_emoji(653161518170505216),bot.user)
                qm = await ctx.send(textto("help-s-send",ctx.author))
                try:
                    msg = await bot.wait_for('message', check=lambda m: m.author==ctx.author and m.channel==ctx.channel,timeout=60)
                    sewd = msg.content
                except asyncio.TimeoutError:
                    pass
                else:
                    try:
                        await msg.delete()
                        await qm.delete()
                    except:
                        pass
                    async with ctx.message.channel.typing():
                        lang = textto("language",ctx.author)
                        with open(f"lang/{lang}.json","r",encoding="utf-8") as j:
                            f = json.load(j)
                        sre = discord.Embed(title=textto("help-s-ret-title",ctx.author),description=textto("help-s-ret-desc",ctx.author).format(sewd),color=ec)
                        for k,v in f.items():
                            if k.startswith("h-"):
                                if sewd in k.replace("h-","")  or sewd in v:
                                    sre.add_field(name=k.replace("h-",""),value=v.replace(sewd,f"**{sewd}**"))
                    await ctx.send(embed=sre)
        await msg.remove_reaction(bot.get_emoji(653161518195671041),bot.user)
        await msg.remove_reaction("ğŸ”",bot.user)
        await msg.remove_reaction(bot.get_emoji(653161518170505216),bot.user)
    else:
        embed = discord.Embed(title=str(rcmd), description=textto(f"h-{str(rcmd)}",ctx.message.author), color=ec)
        if embed.description.startswith("Not found key:") or embed.description.startswith("Not found language:"):
            await ctx.send(textto("h-notfound",ctx.message.author))
        else:
            await ctx.send(embed=embed)

@bot.command(aliases=["r","è¿”ä¿¡","å¼•ç”¨"])
async def reply(ctx,id:int,*,text):

    m = await ctx.channel.fetch_message(id)
    e = discord.Embed(description=text,color=ec)
    e.add_field(name=f"å¼•ç”¨æŠ•ç¨¿(å¼•ç”¨ã•ã‚ŒãŸæŠ•ç¨¿ã®é€ä¿¡è€…:{m.author.display_name})",value=f"{m.content}\n[{bot.get_emoji(653161518451392512)} ã“ã®æŠ•ç¨¿ã«é£›ã¶]({m.jump_url})")
    e.set_author(name=ctx.author.display_name, icon_url=ctx.author.avatar_url_as(static_format='png'))
    await ctx.send(embed=e)
    await ctx.message.delete()

@bot.command()
async def comlock(ctx,do="view",comname=""):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    gs = cursor.fetchone()
    if do =="add":
        if not (ctx.author.guild_permissions.administrator or ctx.author.id == 404243934210949120):
            await ctx.send(textto("need-admin",ctx.author))
            return
        if not comname in gs["lockcom"]:
            gs["lockcom"].append(comname)
            cursor.execute("UPDATE guilds SET lockcom = ? WHERE id = ?", (gs["lockcom"],ctx.guild.id))
        await ctx.send(textto("upf-add",ctx.author).format(comname))
    elif do =="del":
        if not (ctx.author.guild_permissions.administrator or ctx.author.id == 404243934210949120):
            await ctx.send(textto("need-admin",ctx.author))
            return
        if comname in gs["lockcom"]:
            gs["lockcom"].remove(comname)
            cursor.execute("UPDATE guilds SET lockcom = ? WHERE id = ?", (gs["lockcom"],ctx.guild.id))
        await ctx.send(textto("deleted-text",ctx.author))
    elif do =="view":
        await ctx.send(textto("comlock-view",ctx.author).format(str(gs["lockcom"])))
    else:
        await ctx.send(textto("comlock-unknown",ctx.author))

@bot.command()
async def cprofile(ctx,usid=None):
    uid = usid or ctx.author.id
    cursor.execute("select * from users where id=?",(uid,))
    pf = cursor.fetchone()
    e = discord.Embed(title=textto("cpro-title",ctx.author),description=f"id:{uid}")
    e.add_field(name="prefix",value=pf["prefix"])
    e.add_field(name=textto("cpro-gpoint",ctx.author),value=pf["gpoint"])
    e.add_field(name=textto("cpro-levelcard",ctx.author),value=pf["levcard"])
    e.add_field(name=textto("cpro-renotif",ctx.author),value=pf["onnotif"])
    e.add_field(name=textto("cpro-lang",ctx.author),value=pf["lang"])
    await ctx.send(embed=e)

@bot.command()
@commands.is_owner()
async def aev(ctx,*,cmd):
    try:
        await eval(cmd)
    except:
        await ctx.send(embed=discord.Embed(title="awaitEvalã‚¨ãƒ©ãƒ¼",description=traceback.format_exc(0)))

@bot.command(name="dguild")
async def serverinfo(ctx,sid=None):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if not sid == None:
        sevinfo = bot.get_guild(int(str(sid)))
    else:
        sevinfo = ctx.message.guild
    if sevinfo.id in [i[0] for i in partnerg]:
        ptn="ğŸ”—ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼:"
    else:
        ptn=""
    try:
        embed = discord.Embed(title=textto("serverinfo-name",ctx.message.author), description=sevinfo.name, color=ec)
        if not sevinfo.icon_url == None:
            embed.set_thumbnail(url=sevinfo.icon_url_as(static_format='png'))
        embed.add_field(name=textto("serverinfo-role",ctx.message.author), value=len(sevinfo.roles))
        embed.add_field(name=textto("serverinfo-emoji",ctx.message.author), value=len(sevinfo.emojis))
        embed.add_field(name=textto("serverinfo-country",ctx.message.author), value=str(sevinfo.region))
        bm = 0
        ubm = 0
        for m in sevinfo.members:
            if m.bot:
                bm = bm + 1
            else:
                ubm = ubm + 1
        embed.add_field(name=textto("serverinfo-member",ctx.message.author), value=f"{len(sevinfo.members)}(bot:{bm}/user:{ubm})")
        embed.add_field(name=textto("serverinfo-channel",ctx.message.author), value=f'{textto("serverinfo-text",ctx.message.author)}:{len(sevinfo.text_channels)}\n{textto("serverinfo-voice",ctx.message.author)}:{len(sevinfo.voice_channels)}')
        embed.add_field(name=textto("serverinfo-id",ctx.message.author), value=sevinfo.id)
        embed.add_field(name=textto("serverinfo-owner",ctx.message.author), value=sevinfo.owner.name)
        embed.add_field(name=textto("serverinfo-create",ctx.message.author), value=sevinfo.created_at)
        rlist = ",".join([i.name for i in sevinfo.roles])
        if len(rlist) <= 1000:
            embed.add_field(name=textto("serverinfo-roles",ctx.message.author),value=rlist)
        try:
            embed.add_field(name=textto("serverinfo-nitroboost",ctx.message.author),value=textto("serverinfo-nitroboost-val",ctx.message.author).format(sevinfo.premium_tier))
            embed.add_field(name=textto("serverinfo-nitroboost-can-title",ctx.message.author),value=textto(f"serverinfo-nitroboost-can-{sevinfo.premium_tier}",ctx.message.author).format(sevinfo.premium_tier,sevinfo.premium_subscription_count))
        except:
            pass
        
        if sevinfo.system_channel:
            embed.add_field(name=textto("serverinfo-sysch",ctx.message.author),value=sevinfo.system_channel)
            try:
                embed.add_field(name=textto("serverinfo-sysch-welcome",ctx.message.author),value=sevinfo.system_channel_flags.join_notifications)
                embed.add_field(name=textto("serverinfo-sysch-boost",ctx.message.author),value=sevinfo.system_channel_flags.premium_subscriptions)
            except:
                pass
        if sevinfo.afk_channel:
            embed.add_field(name=textto("serverinfo-afkch",ctx.message.author),value=sevinfo.afk_channel.name)
            embed.add_field(name=textto("serverinfo-afktimeout",ctx.message.author),value=str(sevinfo.afk_timeout/60))
        await ctx.send(embed=embed)
    except Exception as e:
        await ctx.send(e)
        #await ctx.send(textto("serverinfo-except",ctx.message.author))


@bot.command(aliases=["è¨€èªè¨­å®š","è¨€èªã‚’æ¬¡ã®è¨€èªã«å¤‰ãˆã¦"])
@commands.cooldown(1, 10, type=commands.BucketType.user)
async def userlang(ctx,lang):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if textto("language",lang).startswith("Not found language:"):
        await ctx.send(textto("setl-cantuse",ctx.author))
    else:
        cursor.execute("UPDATE users SET lang = ? WHERE id = ?", (lang,ctx.author.id))
        await ctx.send(textto("setl-set",ctx.message.author))


@bot.event
async def on_command_error(ctx, error):
    global DoServercmd
    """if isinstance(error, commands.CommandNotFound):
        if not DoServercmd:
            embed = discord.Embed(title=textto("cmd-error-t",ctx.message.author), description=textto("cmd-notfound-d",ctx.message.author), color=ec)
            DoServercmd = False
            await ctx.send(embed=embed)
    el"""
    if isinstance(error,commands.CommandOnCooldown):
        #ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³
        embed = discord.Embed(title=textto("cmd-error-t",ctx.message.author), description=textto("cmd-cooldown-d",ctx.message.author).format(str(error.retry_after)[:4]), color=ec)
        await ctx.send(embed=embed)
    elif isinstance(error,commands.NotOwner):
        #ã‚ªãƒ¼ãƒŠãƒ¼å°‚ç”¨ã‚³ãƒãƒ³ãƒ‰
        embed = discord.Embed(title=textto("cmd-error-t",ctx.message.author), description="ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã‚ªãƒ¼ãƒŠãƒ¼å°‚ç”¨ã ã£ã¦ã‚ˆ", color=ec)
        await ctx.send(embed=embed)
        ch=bot.get_channel(652127085598474242)
        await ch.send(embed=getEmbed("ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°",f"ã‚³ãƒãƒ³ãƒ‰:`{ctx.command.name}`\n```{str(error)}```",ec,f"ã‚µãƒ¼ãƒãƒ¼",ctx.guild.name,"å®Ÿè¡Œãƒ¡ãƒ³ãƒãƒ¼",ctx.author.name,"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹",ctx.message.content))
    elif isinstance(error,commands.MissingRequiredArgument):
        #å¼•æ•°ãŒãªã„ã‚ˆã£â˜†
        embed = discord.Embed(title=textto("cmd-error-t",ctx.message.author), description=f"å€¤ãŒæ¸¡ã•ã‚Œã¦ã„ãªã„å¼•æ•°ãŒã‚ã‚Šã¾ã™ï¼\nå¼•æ•°ã‚’è¦‹ç›´ã—ã¦ãã ã•ã„ï¼", color=ec)
        await ctx.send(embed=embed)
    else:
        #ãã®ä»–ä¾‹å¤–
        ch=bot.get_channel(652127085598474242)
        await ch.send(embed=getEmbed("ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°",f"ã‚³ãƒãƒ³ãƒ‰:`{ctx.command.name}`\n```{str(error)}```",ec,f"ã‚µãƒ¼ãƒãƒ¼",ctx.guild.name,"å®Ÿè¡Œãƒ¡ãƒ³ãƒãƒ¼",ctx.author.name,"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹",ctx.message.content))


@bot.command()
async def globalpost(ctx,gmid:int):
    post=None
    cursor.execute("select * from globaldates")
    dats = cursor.fetchall()
    for i in dats:
        if gmid in i["allid"]:
            post = i
    cursor.execute("select * from users where id=?",(ctx.author.id,))
    upf = cursor.fetchone()
    if upf["gmod"]:
        cursor.execute("select * from users where id=?",(i["aid"],))
        u = cursor.fetchone()
        g = bot.get_guild(post["gid"])
        await ctx.send(embed=getEmbed("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹",post['content'],ec,"é€ä¿¡è€…id:",post['aid'],"é€ä¿¡å…ˆ",post["allid"],"é€ä¿¡è€…ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ",upf['gnick'],"ã‚µãƒ¼ãƒãƒ¼id",g.id,"ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒ ",g.name))
    else:
        cursor.execute("select * from users where id=?",(i["aid"],))
        u = cursor.fetchone()
        g = bot.get_guild(post["gid"])
        await ctx.send(embed=getEmbed("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹",post['content'],ec,"é€ä¿¡è€…id:",post['aid'],"é€ä¿¡è€…ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ",upf['gnick']))

@bot.command()
async def emojiinfo(ctx,*,emj:commands.EmojiConverter=None):

    if emj==None:
        await ctx.send(textto("einfo-needarg",ctx.author))
    elif emj.guild == ctx.guild:
        embed = discord.Embed(title=emj.name, description=f"id:{emj.id}",color=ec)
        embed.add_field(name=textto("einfo-animated",ctx.author), value=emj.animated)
        embed.add_field(name=textto("einfo-manageout",ctx.author), value=emj.managed)
        if emj.user:
            embed.add_field(name=textto("einfo-adduser",ctx.author), value=str(emj.user))
        embed.add_field(name="url", value=emj.url)
        embed.set_footer(text=textto("einfo-addday",ctx.author))
        embed.timestamp = emj.created_at
        await ctx.send(embed=embed)
    else:
        await ctx.send(textto("roleinfo-other",ctx.message.author))

@bot.command()
async def delm(ctx, ctxid):

    if ctx.message.author.permissions_in(ctx.message.channel).manage_messages == True or ctx.author.id == 404243934210949120:
        print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
        dctx = await ctx.message.channel.fetch_message(ctxid)
        print(f'{ctx.message.author.name}ã•ã‚“ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã§ã€{ctx.message.guild.name}ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"{dctx.content}"ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚')
        await dctx.delete()
        await ctx.message.delete()

@bot.command()
async def dcomrun(ctx,cname,*,ags):
    if ctx.message.author.id == 404243934210949120:
        c = ctx
        c.args = list(ags)
        try:
            await c.invoke(bot.get_command(cname))
        except:
            await ctx.send(embed=discord.Embed(title="dcomrunã‚¨ãƒ©ãƒ¼",description=traceback.format_exc(0)))


@bot.command()
async def mas(ctx,*,text):
    st=""
    for i in text:
        st = st+f"\|\|{i}\|\|"
    await ctx.send(st)

@bot.command()
async def sendlogto(ctx,to=None):
    if ctx.author.guild_permissions.administrator or ctx.author.id == 404243934210949120:
        cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
        gpf = cursor.fetchone()
        if to:
            db.execute("UPDATE guilds SET sendlog = ? WHERE id = ?", (int(to),ctx.guild.id))
            n=ctx.guild.me.nick
            await ctx.guild.me.edit(nick="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ å¤‰æ›´ãƒ†ã‚¹ãƒˆ")
            await asyncio.sleep(1)
            await ctx.guild.me.edit(nick=n)
            await asyncio.sleep(1)
            await ctx.send("å¤‰æ›´ã—ã¾ã—ãŸã€‚ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ å¤‰æ›´é€šçŸ¥ãŒé€ã‚‰ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚")
        else:
            db.execute("UPDATE guilds SET sendlog = ? WHERE id = ?", (None,ctx.guild.id))
            await ctx.send("è§£é™¤ã—ã¾ã—ãŸã€‚")
    else:
        await ctx.send("ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®ä½¿ç”¨ã«ã¯ã€ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚")

@bot.command()
async def ranklev(ctx):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    gs = cursor.fetchone()
    async with ctx.channel.typing():
        le = gs["levels"]
        lrs = [(int(k),v["level"],v["exp"]) for k,v in le.items() if v["dlu"]]
        text=""
        for ind,i in enumerate(sorted(lrs, key=itemgetter(1,2), reverse=True)):
            un = ctx.guild.get_member(i[0])
            if un is None:
                un = await bot.fetch_user(i[0])
                if un is None:
                    un=f"id:`{i[0]}`"
                else:
                    un = str(un)+f"({textto('ranklev-outsideg',ctx.author)})"
            else:
                un = un.mention
            if len(text+f"> {ind+1}.{un}\nã€€level:{i[1]},exp:{i[2]}\n") <= 2036:
                text = text + f"> {ind+1}.{un}\nã€€level:{i[1]},exp:{i[2]}\n"
            else:
                text = text+f"({textto('ranklev-lenover',ctx.author)})"
                break
        e = discord.Embed(title=textto("ranklev-title",ctx.author),description=text,color=ec)
    await ctx.send(embed=e)

@bot.command()
async def cemojiorole(ctx,name,*rlis):
    ig = await ctx.message.attachments[0].read()
    await ctx.guild.create_custom_emoji(name=name,image=ig,roles=[ctx.guild.get_role(int(i)) for i in rlis])
    await ctx.send(textto("created-text",ctx.author))

@commands.cooldown(1, 10, type=commands.BucketType.guild)
@bot.command()
async def guildlang(ctx,lang):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    gs = cursor.fetchone()
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    if textto("language",lang).startswith("Not found language:"):
        await ctx.send(textto("setl-cantuse",ctx.author))
    else:
        cursor.execute("UPDATE guilds SET lang = ? WHERE id = ?", (lang,ctx.guild.id))
        await ctx.send(textto("setl-set",ctx.message.author))

@bot.command()
async def guildprefix(ctx,mode="view",ipf=""):
    cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
    gs = cursor.fetchone()
    if mode=="view":
        await ctx.send(embed=getEmbed("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®prefix",f'```{",".join(gs["prefix"])}```'))
    elif mode=="set":
        spf = gs["prefix"]+[ipf]
        cursor.execute("UPDATE guilds SET prefix = ? WHERE id = ?", (spf,ctx.guild.id))
        await ctx.send(textto("upf-add",ctx.author).format(ipf))
    elif mode=="del":
        spf = gs["prefix"]
        spf.remove(ipf)
        cursor.execute("UPDATE guilds SET prefix = ? WHERE id = ?", (spf,ctx.guild.id))
        await ctx.send(f"{ipf}ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚")
    else:
        await ctx.send(embed=getEmbed("ä¸é©åˆ‡ãªãƒ¢ãƒ¼ãƒ‰é¸æŠ","`view`ã¾ãŸã¯`set`ã¾ãŸã¯`del`ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚"))
    
@bot.command()
async def cuglobal(ctx,*cids):
    if ctx.message.author.id == 404243934210949120:
        cursor.execute("select * from globalchs")
        chs = cursor.fetchall()
        async with ctx.channel.typing():
            for cid in [int(i) for i in cids]:
                await asyncio.sleep(0.5)
                try:
                    for ch in chs:
                        if cid in ch["ids"]:
                            clt=ch["ids"]
                            clt.remove(cid)
                            db.execute("UPDATE globalchs SET ids = ? WHERE name = ?", (clt,ch["name"]))
                            break
                except:
                    pass
        await ctx.send("å¼·åˆ¶åˆ‡æ–­ã§ãã¦ã‚‹ã‹ç¢ºèªã—ã¦ã­ãƒ¼")

@bot.command(name="sina-guild",aliases=["æ€æƒŸå¥ˆã¡ã‚ƒã‚“å…¬å¼ã‚µãƒ¼ãƒãƒ¼","æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã‚µãƒ¼ãƒãƒ¼ã«è¡ŒããŸã„"])
async def sinaguild(ctx):
    print(f'{ctx.message.author.name}({ctx.message.guild.name})_'+ ctx.message.content )
    await ctx.send("https://discord.gg/udA3qgZ")

@bot.command()
async def test_of_twipost(ctx,text):
    try:
        twi.statuses.update(status=text)
    except:
        await ctx.send(f"```{traceback.format_exc(2)}```")


@tasks.loop(time=datetime.time(hour=23,minute=0,second=0))
async def invite_tweet():
    try:
        twi.statuses.update(status=f"[å®šæœŸæŠ•ç¨¿]\nã¿ãƒã¦ã‚“â˜†ã®å…¬é–‹Discordã‚µãƒ¼ãƒãƒ¼:https://discord.gg/GbHq7fz\nã¿ãƒã¦ã‚“â˜†åˆ¶ä½œã€å¤šæ©Ÿèƒ½Discordbotæ€æƒŸå¥ˆã¡ã‚ƒã‚“:https://discordapp.com/oauth2/authorize?client_id=462885760043843584&permissions=8&scope=bot\n<ã“ã®æŠ•ç¨¿ã¯æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã‚ˆã‚Šè¡Œã‚ã‚Œã¾ã—ãŸã€‚>")
    except:
        dc=bot.get_user(404243934210949120)
        await dc.send(f"have error:```{traceback.format_exc(1)}```")

@tasks.loop(time=datetime.time(hour=8,minute=0,second=0))
async def now_sina_tweet():
    try:
        twi.statuses.update(status=f"[å®šæœŸæŠ•ç¨¿]\næ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼æ•°:{len(bot.guilds)}\næ€æƒŸå¥ˆã¡ã‚ƒã‚“ã®å…¬å¼ã‚µãƒ¼ãƒãƒ¼:https://discord.gg/udA3qgZ\n<ã“ã®æŠ•ç¨¿ã¯æ€æƒŸå¥ˆã¡ã‚ƒã‚“ã‚ˆã‚Šè¡Œã‚ã‚Œã¾ã—ãŸã€‚>")
    except:
        dc=bot.get_user(404243934210949120)
        await dc.send(f"have error:```{traceback.format_exc(1)}```")
    pr=random.choice(partnerg)
    if pr[3]!="":
        e=getEmbed("ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚µãƒ¼ãƒãƒ¼ç´¹ä»‹",f"{bot.get_guild(pr[0])}\n{pr[3]}\nå‚åŠ : {pr[2]}")
        cursor.execute("select * from globalchs where name=?",("main",))
        chs = cursor.fetchone()
        for chid in chs["ids"]:
            try:
                ch = bot.get_channel(chid)
                for wh in await ch.webhooks():
                    try:
                        if wh.name == "sina_global":
                            await wh.send(embed=e)
                            await asyncio.sleep(0.2)
                            break
                    except:
                        continue
            except:
                pass


@bot.command()
async def lrewardupd(ctx):
    async with ctx.channel.typing():
        cursor.execute("select * from guilds where id=?",(ctx.guild.id,))
        gs=cursor.fetchone()
        rslt={}
        for uk,uv in gs["levels"].items():
            u = ctx.guild.get_member(int(uk))
            for k,v in gs["reward"].items():
                if int(k)<=uv["level"]:
                    try:
                        rl = ctx.message.guild.get_role(v)
                        await u.add_roles(rl)
                        if rslt[k]:
                            rslt[k].append(u.display_name)
                        else:
                            rslt[k] = [u.display_name]
                        await asyncio.sleep(0.2)
                    except:
                        pass
    await ctx.send("å®Œäº†ã—ã¾ã—ãŸã€‚",embed=getEmbed("è¿½åŠ è€…ä¸€è¦§",f"```{','.join([f'ãƒ¬ãƒ™ãƒ«{k}:{v}'] for k,v in rslt.items())}```"))

@bot.command()
async def testA(ctx):
    e=discord.Embed(title="ãƒ†ã‚¹ãƒˆ",description="ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã—ã¦ã©ã†ã",color=ec)
    msg = await ctx.send(embed=e)
    await msg.add_reaction("1ï¸âƒ£")
    await msg.add_reaction("2ï¸âƒ£")
    await msg.add_reaction("3ï¸âƒ£")
    try:
        r, u = await bot.wait_for("reaction_add", check=lambda r,u: r.message.id==msg.id and u.id == ctx.message.author.id,timeout=30)
        if str(r)=="1ï¸âƒ£":
            e=discord.Embed(title="é …ç›®1",description="ãƒ–ãƒ¼ã‚¹ãƒˆã™ã‚‹ã¨ã„ã„ã“ã¨ã‚ã‚‹ã‚ˆ",color=ec)
        elif str(r)=="2ï¸âƒ£":
            e=discord.Embed(title="é …ç›®2",description="ãˆãƒ¼ã£ã¨ã€æ›¸ãã“ã¨çŸ¥ã‚‰ãªã„ã‚“ã ã£ã¦ã‚ˆ",color=ec)
        elif str(r)=="3ï¸âƒ£":
            e=discord.Embed(title="é …ç›®3",description="ã¾ã‚ã€ã“ã‚Œã€ã‚ãã¾ã§ä¾‹ç¤ºã ã—ã„ã„ã‚ˆã­ï¼Ÿ",color=ec)
        else:
            e=discord.Embed(title="é …ç›®?",description="ã“ã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ã€ä½•ã‚‚ãªã„ã‚ˆï¼",color=ec)
        await msg.edit(embed=e)
    except asyncio.TimeoutError:
        await msg.edit(embed=discord.Embed(title="ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼",description="ã‚‚ã†ä¸€åº¦ã¯ã˜ã‚ã‹ã‚‰è©¦ã—ã¦ãã ã•ã„ã€‚"))

"""@bot.command()
async def cNitro(ctx):
    return 0
    cli=[
        449867036558884866,
        641956259758735360,
        367132890032635904,
        398412979067944961,
        415526420115095554,
        607403193034473491,
        586157827400400907,
        657214718410489869,
        594058726902595596,
        539787492711464960,
        462765491325501445,
        431805523969441803
    ]
    uid=random.choice(cli)
    u=ctx.guild.get_member(uid)
    await ctx.send(f"å½“é¸è€…ã¯||{u.display_name}||ã•ã‚“ã«æ±ºã¾ã‚Šã¾ã—ãŸï¼")"""


@bot.command()
async def backup(ctx,gid:int):
    if not ctx.guild.me.guild_permissions.administrator:
        await ctx.send("ã“ã®ã‚µãƒ¼ãƒãƒ¼ã§ã€ã‚ãŸã—ãŒç®¡ç†è€…æ¨©é™ã‚’æŒã£ã¦ãªã„ã®ã§ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚")
        return
    try:
        g = bot.get_guild(gid)
        if ctx.author.permissions_in(ctx.channel).administrator == True or ctx.author.id == 404243934210949120:
            pgs=await ctx.send(f"å½¹è·\né€²è¡Œåº¦:0/{len(g.roles)}")
            tk=0
            rlid={}
            async with ctx.channel.typing():
                #å½¹è·ã€‚rlid(dict)ã«æ—§id(str)ã§å‚ç…§ã™ã‚Œã°æ–°idãŒè¿”ã£ã¦ãã‚‹
                for r in g.roles[1:][::-1]:
                    rl=await ctx.guild.create_role(name=r.name,permissions=r.permissions,colour=r.colour,hoist=r.hoist,mentionable=r.mentionable,reason=f"{g.name}ã‚ˆã‚Šã€‚å½¹è·è»¢é€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã«ã‚ˆã‚‹ã€‚")
                    await asyncio.sleep(2)
                    rlid[str(r.id)]=rl.id
                    tk=tk+1
                    await pgs.edit(content=f"å½¹è·\né€²è¡Œåº¦:{tk}/{len(g.roles)}")
                await ctx.guild.default_role.edit(permissions=g.default_role.permissions)
                rlid[str(g.default_role.id)]=ctx.guild.default_role.id
                await pgs.edit(content=f"ãƒãƒ£ãƒ³ãƒãƒ«\né€²è¡Œåº¦:0/{len(g.channels)}")
                tk=0
                #ãƒãƒ£ãƒ³ãƒãƒ«ã€‚
                chlt={}
                for mct,mch in g.by_category():
                    await asyncio.sleep(2)
                    try:
                        ovwt={}
                        await asyncio.sleep(2)
                        for k,v in mct.overwrites.items():
                            try:
                                rl=ctx.guild.get_role(rlid[str(k.id)])
                                ovwt[rl]=v
                            except:
                                pass
                        ct = await ctx.guild.create_category_channel(name=mct.name,overwrites=ovwt)
                        chlt[str(mct.id)]=ct.id
                        tk=tk+1
                        await pgs.edit(content=f"ãƒãƒ£ãƒ³ãƒãƒ«\né€²è¡Œåº¦:{tk}/{len(g.channels)}")
                    except AttributeError:
                        ct = None
                    for c in mch:
                        ovwt={}
                        await asyncio.sleep(2)
                        for k,v in c.overwrites.items():
                            try:
                                rl=ctx.guild.get_role(rlid[k])
                                ovwt[rl]=v
                            except:
                                pass
                        if isinstance(c,discord.TextChannel):
                            cch=await ctx.guild.create_text_channel(name=c.name,category=ct,topic=c.topic,slowmode_delay=c.slowmode_delay,nsfw=c.is_nsfw(),overwrites=ovwt)
                        elif isinstance(c,discord.VoiceChannel):
                            if ctx.guild.bitrate_limit >= c.bitrate:
                                cch=await ctx.guild.create_voice_channel(name=c.name,category=ct,bitrate=c.bitrate,user_limit=c.user_limit,overwrites=ovwt)
                            else:
                                cch=await ctx.guild.create_voice_channel(name=c.name,category=ct,bitrate=ctx.guild.bitrate_limit,user_limit=c.user_limit,overwrites=ovwt)
                        else:
                            pass
                        try:
                            chlt[str(c.id)]=cch.id
                            tk=tk+1
                            await pgs.edit(content=f"ãƒãƒ£ãƒ³ãƒãƒ«\né€²è¡Œåº¦:{tk}/{len(g.channels)}")
                        except:
                            pass
                await pgs.edit(content="ãƒãƒ£ãƒ³ãƒãƒ«å®Œäº†\nnext:çµµæ–‡å­—")
                #çµµæ–‡å­—
                tk=0
                for e in g.emojis:
                    if len(ctx.guild.emojis)>=ctx.guild.emoji_limit:
                        break
                    print("looping")
                    try:
                        ei = await e.url.read()
                        await ctx.guild.create_custom_emoji(name=e.name,image=ei)
                        await asyncio.sleep(5)
                        print("done")
                    except:
                        await ctx.send(f"```{traceback.format_exc(3)}```")
                await pgs.edit(content="çµµæ–‡å­—å®Œäº†\nnext:ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®bançŠ¶æ³")
                #ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ban
                bm = await g.bans()
                tk=0
                for i in bm:
                    await g.ban(user=i.user,reason=i.reason)
                    await asyncio.sleep(2)
                    tk=tk+1
                    await pgs.edit(content=f"bançŠ¶æ³ç¢ºèª\né€²è¡Œåº¦:{tk}/{len(bm)}")

                await pgs.edit(content="bançŠ¶æ³å®Œäº†\nnext:ã‚µãƒ¼ãƒãƒ¼è¨­å®š")
                #ã‚µãƒ¼ãƒãƒ¼è¨­å®š
                icn = await g.icon_url_as(static_format="png").read()
                await ctx.guild.edit(name=g.name,icon=icn,region=g.region,verification_level=g.verification_level,default_notifications=g.default_notifications,explicit_content_filter=g.explicit_content_filter)
                #afk
                if g.afk_channel:
                    await ctx.guild.edit(afk_channel=ctx.guild.get_channel(chlt[str(g.afk_channel.id)]),afk_timeout=g.afk_timeout)
                #ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ£ãƒ³ãƒãƒ«
                if g.system_channel:
                    await ctx.guild.edit(system_channel=ctx.guild.get_channel(chlt[str(g.system_channel.id)]),system_channel_flags=g.system_channel_flags)
                #ã‚µãƒ¼ãƒãƒ¼æ‹›å¾…ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥
                if str(g.splash_url) and ("INVITE_SPLASH" in ctx.guild.features):
                    sp = await g.splash_url.read()
                    await ctx.guild.edit(splash=sp)
                #ã‚µãƒ¼ãƒãƒ¼ãƒãƒŠãƒ¼
                if str(g.banner_url) and ("BANNER" in ctx.guild.features):
                    bn = await g.banner_url.read()
                    await ctx.guild.edit(banner=bn)
                await ctx.send("å®Œäº†ã—ã¾ã—ãŸã€‚")
        else:
            await ctx.send("ã“ã®ã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚")
    except:
        await ctx.send(embed=getEmbed("ã‚¨ãƒ©ãƒ¼",f"è©³ç´°:```{traceback.format_exc(0)}```"))

@bot.command()
async def getby(ctx,k:str):
    await ctx.send(embed=getEmbed("",textto(k,ctx.author)))


@bot.command()
@commands.is_owner()
async def get_ch_id(ctx,cnm:str):
    await ctx.send(embed=getEmbed("ä¸€è‡´ãƒãƒ£ãƒ³ãƒãƒ«",str([f"{i.name}({i.id})" for i in ctx.guild.channels if i.name==cnm])))

@bot.command()
@commands.is_owner()
async def chlogs(ctx,cid:int,count:int):
    ch = bot.get_channel(cid)
    async for m in ch.history(limit=count):
        await ctx.author.send(embed=getEmbed("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",m.clean_content,ec,"é€ä¿¡è€…",str(m.author)))
        await asyncio.sleep(2)

@bot.command()
async def cinvite(ctx,ivt:str):
    i = await bot.fetch_invite(ivt)
    e=discord.Embed(title="ã‚µãƒ¼ãƒãƒ¼æ‹›å¾…ã®åˆ†æ",desctiption=f"{str(i.inviter)}ã«ã‚ˆã‚‹æ‹›å¾…",color=ec)
    e.set_author(name=f"{i.guild.name}({i.guild.id})",icon_url=i.guild.icon_url_as(format="png"))
    e.add_field(name="ãƒ¡ãƒ³ãƒãƒ¼æ•°",value=f"å…¨{i.approximate_member_count}å\nã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒãƒ¼{i.approximate_presence_count}å")
    e.add_field(name="æ‹›å¾…ãƒãƒ£ãƒ³ãƒãƒ«",value=f"{i.channel.name}({i.channel.type})")
    e.add_field(name="ä¸€æ™‚ãƒªãƒ³ã‚¯?",value=str(i.temporary))
    e.add_field(name="å–ã‚Šæ¶ˆã•ã‚ŒãŸæ‹›å¾…?",value=str(i.revoked))
    e.add_field(name="ãƒªãƒ³ã‚¯",value=i.url,inline=False)
    e.set_footer(text="æ‹›å¾…ã®ä½œæˆæ—¥æ™‚")
    e.timestamp = i.created_at or discord.Embed.Empty
    await ctx.send(embed=e)

#é€šå¸¸ãƒˆãƒ¼ã‚¯ãƒ³
bot.run(BOT_TOKEN)

#ãƒ†ã‚¹ãƒˆãƒˆãƒ¼ã‚¯ãƒ³
#bot.run(BOT_TEST_TOKEN)